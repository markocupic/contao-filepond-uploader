export class FilepondImageResolutionValidator{static tags=[{event:"contao_filepond:process_start",priority:90}];async handle(e){const t=e.file,i=e.filepondOptions,a=Number(e.jsConfig.minImageWidth)||0,o=Number(e.jsConfig.minImageHeight)||0,r=Number(e.jsConfig.maxImageWidth)||0,n=Number(e.jsConfig.maxImageHeight)||0;if(!(t instanceof Blob))throw new Error(i.labelImageValidateSizeLabelFormatError);const{width:l,height:d}=await this.loadImage(t);if(l<a||d<o){const e={width:l,height:d,minWidth:a,minHeight:o},t=i.validateMinImageResolutionError.replace(/\{(\w+)\}/g,(t,i)=>e[i]);throw new Error(t)}if(l>r||d>n){const e={width:l,height:d,maxWidth:r,maxHeight:n},t=i.labelMaxImageResolutionValidationError.replace(/\{(\w+)\}/g,(t,i)=>e[i]);throw new Error(t)}}loadImage(e){return new Promise((t,i)=>{const a=new FileReader,o=new Image;a.onload=e=>{o.onload=()=>t({width:o.width,height:o.height}),o.onerror=()=>i("Invalid image selected, can't extract resolution data from it."),o.src=e.target.result},a.onerror=()=>i("FileReader failed to read the selected image file."),a.readAsDataURL(e)})}}