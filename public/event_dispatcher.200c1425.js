export class EventDispatcher{constructor(t){this.provider=t}async dispatch(t,e){return new Promise(async(o,r)=>{e.stopPropagation=!1;const s=e.resolve,n=e.reject;e.resolve=(...t)=>{s&&s(...t)},e.reject=(...t)=>{e.stopPropagation=!0,n&&n(...t),r(...t)};const c=this.provider.getListeners(t);for(const t of c){try{const o=t.handle(e);o&&"function"==typeof o.then&&await o}catch(t){return void e.reject(t)}if(e.stopPropagation)return}o()})}}