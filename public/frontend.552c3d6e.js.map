{"version":3,"file":"frontend.552c3d6e.js","mappings":"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","sources":["webpack://contao-filepond-uploader/./node_modules/filepond-plugin-image-edit/dist/filepond-plugin-image-edit.js","webpack://contao-filepond-uploader/./node_modules/filepond-plugin-image-transform/dist/filepond-plugin-image-transform.js","webpack://contao-filepond-uploader/./assets/utils/filesize.js","webpack://contao-filepond-uploader/./assets/custom_validators/filepond_file_size_validator.js","webpack://contao-filepond-uploader/./node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js","webpack://contao-filepond-uploader/./node_modules/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js","webpack://contao-filepond-uploader/./assets/custom_validators/filepond_image_resolution_validator.js","webpack://contao-filepond-uploader/./assets/custom_validators/ sync nonrecursive \\.js$","webpack://contao-filepond-uploader/./node_modules/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.js","webpack://contao-filepond-uploader/./node_modules/filepond-plugin-image-resize/dist/filepond-plugin-image-resize.js","webpack://contao-filepond-uploader/webpack/bootstrap","webpack://contao-filepond-uploader/webpack/runtime/compat get default export","webpack://contao-filepond-uploader/webpack/runtime/define property getters","webpack://contao-filepond-uploader/webpack/runtime/hasOwnProperty shorthand","webpack://contao-filepond-uploader/webpack/runtime/make namespace object","webpack://contao-filepond-uploader/./node_modules/filepond/dist/filepond.esm.js","webpack://contao-filepond-uploader/./assets/contao_filepond.js","webpack://contao-filepond-uploader/./assets/listener_provider.js","webpack://contao-filepond-uploader/./assets/event_dispatcher.js","webpack://contao-filepond-uploader/./assets/filepond.js"],"sourcesContent":["/*!\n * FilePondPluginImageEdit 1.6.3\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? (module.exports = factory())\n    : typeof define === 'function' && define.amd\n    ? define(factory)\n    : ((global = global || self), (global.FilePondPluginImageEdit = factory()));\n})(this, function() {\n  'use strict';\n\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n\n  /**\n   * Image Edit Proxy Plugin\n   */\n  var plugin = function plugin(_) {\n    var addFilter = _.addFilter,\n      utils = _.utils,\n      views = _.views;\n    var Type = utils.Type,\n      createRoute = utils.createRoute,\n      _utils$createItemAPI = utils.createItemAPI,\n      createItemAPI =\n        _utils$createItemAPI === void 0\n          ? function(item) {\n              return item;\n            }\n          : _utils$createItemAPI;\n    var fileActionButton = views.fileActionButton;\n\n    addFilter('SHOULD_REMOVE_ON_REVERT', function(shouldRemove, _ref) {\n      var item = _ref.item,\n        query = _ref.query;\n      return new Promise(function(resolve) {\n        var file = item.file;\n\n        // if this file is editable it shouldn't be removed immidiately even when instant uploading\n        var canEdit =\n          query('GET_ALLOW_IMAGE_EDIT') &&\n          query('GET_IMAGE_EDIT_ALLOW_EDIT') &&\n          isPreviewableImage(file);\n\n        // if the file cannot be edited it should be removed on revert\n        resolve(!canEdit);\n      });\n    });\n\n    // open editor when loading a new item\n    addFilter('DID_LOAD_ITEM', function(item, _ref2) {\n      var query = _ref2.query,\n        dispatch = _ref2.dispatch;\n      return new Promise(function(resolve, reject) {\n        // if is temp or local file\n        if (item.origin > 1) {\n          resolve(item);\n          return;\n        }\n\n        // get file reference\n        var file = item.file;\n        if (\n          !query('GET_ALLOW_IMAGE_EDIT') ||\n          !query('GET_IMAGE_EDIT_INSTANT_EDIT')\n        ) {\n          resolve(item);\n          return;\n        }\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) {\n          resolve(item);\n          return;\n        }\n\n        var createEditorResponseHandler = function createEditorResponseHandler(\n          item,\n          resolve,\n          reject\n        ) {\n          return function(userDidConfirm) {\n            // remove item\n            editRequestQueue.shift();\n\n            // handle item\n            if (userDidConfirm) {\n              resolve(item);\n            } else {\n              reject(item);\n            }\n\n            // TODO: Fix, should not be needed to kick the internal loop in case no processes are running\n            dispatch('KICK');\n\n            // handle next item!\n            requestEdit();\n          };\n        };\n\n        var requestEdit = function requestEdit() {\n          if (!editRequestQueue.length) return;\n          var _editRequestQueue$ = editRequestQueue[0],\n            item = _editRequestQueue$.item,\n            resolve = _editRequestQueue$.resolve,\n            reject = _editRequestQueue$.reject;\n\n          dispatch('EDIT_ITEM', {\n            id: item.id,\n            handleEditorResponse: createEditorResponseHandler(\n              item,\n              resolve,\n              reject\n            )\n          });\n        };\n\n        queueEditRequest({ item: item, resolve: resolve, reject: reject });\n\n        if (editRequestQueue.length === 1) {\n          requestEdit();\n        }\n      });\n    });\n\n    // extend item methods\n    addFilter('DID_CREATE_ITEM', function(item, _ref3) {\n      var query = _ref3.query,\n        dispatch = _ref3.dispatch;\n      item.extend('edit', function() {\n        dispatch('EDIT_ITEM', { id: item.id });\n      });\n    });\n\n    var editRequestQueue = [];\n    var queueEditRequest = function queueEditRequest(editRequest) {\n      editRequestQueue.push(editRequest);\n      return editRequest;\n    };\n\n    // called for each view that is created right after the 'create' method\n    addFilter('CREATE_VIEW', function(viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n        view = viewAPI.view,\n        query = viewAPI.query;\n\n      if (!query('GET_ALLOW_IMAGE_EDIT')) return;\n\n      var canShowImagePreview = query('GET_ALLOW_IMAGE_PREVIEW');\n\n      // only run for either the file or the file info panel\n      var shouldExtendView =\n        (is('file-info') && !canShowImagePreview) ||\n        (is('file') && canShowImagePreview);\n\n      if (!shouldExtendView) return;\n\n      // no editor defined, then exit\n      var editor = query('GET_IMAGE_EDIT_EDITOR');\n      if (!editor) return;\n\n      // set default FilePond options and add bridge once\n      if (!editor.filepondCallbackBridge) {\n        editor.outputData = true;\n        editor.outputFile = false;\n        editor.filepondCallbackBridge = {\n          onconfirm: editor.onconfirm || function() {},\n          oncancel: editor.oncancel || function() {}\n        };\n      }\n\n      // opens the editor, if it does not already exist, it creates the editor\n      var openEditor = function openEditor(_ref4) {\n        var root = _ref4.root,\n          props = _ref4.props,\n          action = _ref4.action;\n        var id = props.id;\n        var handleEditorResponse = action.handleEditorResponse;\n\n        // update editor props that could have changed\n        editor.cropAspectRatio =\n          root.query('GET_IMAGE_CROP_ASPECT_RATIO') || editor.cropAspectRatio;\n        editor.outputCanvasBackgroundColor =\n          root.query('GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR') ||\n          editor.outputCanvasBackgroundColor;\n\n        // get item\n        var item = root.query('GET_ITEM', id);\n        if (!item) return;\n\n        // file to open\n        var file = item.file;\n\n        // crop data to pass to editor\n        var crop = item.getMetadata('crop');\n        var cropDefault = {\n          center: {\n            x: 0.5,\n            y: 0.5\n          },\n\n          flip: {\n            horizontal: false,\n            vertical: false\n          },\n\n          zoom: 1,\n          rotation: 0,\n          aspectRatio: null\n        };\n\n        // size data to pass to editor\n        var resize = item.getMetadata('resize');\n\n        // filter and color data to pass to editor\n        var filter = item.getMetadata('filter') || null;\n        var filters = item.getMetadata('filters') || null;\n        var colors = item.getMetadata('colors') || null;\n        var markup = item.getMetadata('markup') || null;\n\n        // build parameters object\n        var imageParameters = {\n          crop: crop || cropDefault,\n          size: resize\n            ? {\n                upscale: resize.upscale,\n                mode: resize.mode,\n                width: resize.size.width,\n                height: resize.size.height\n              }\n            : null,\n          filter: filters\n            ? filters.id || filters.matrix\n            : root.query('GET_ALLOW_IMAGE_FILTER') &&\n              root.query('GET_IMAGE_FILTER_COLOR_MATRIX') &&\n              !colors\n            ? filter\n            : null,\n          color: colors,\n          markup: markup\n        };\n\n        editor.onconfirm = function(_ref5) {\n          var data = _ref5.data;\n          var crop = data.crop,\n            size = data.size,\n            filter = data.filter,\n            color = data.color,\n            colorMatrix = data.colorMatrix,\n            markup = data.markup;\n\n          // create new metadata object\n          var metadata = {};\n\n          // append crop data\n          if (crop) {\n            metadata.crop = crop;\n          }\n\n          // append size data\n          if (size) {\n            var initialSize = (item.getMetadata('resize') || {}).size;\n            var targetSize = {\n              width: size.width,\n              height: size.height\n            };\n\n            if (!(targetSize.width && targetSize.height) && initialSize) {\n              targetSize.width = initialSize.width;\n              targetSize.height = initialSize.height;\n            }\n\n            if (targetSize.width || targetSize.height) {\n              metadata.resize = {\n                upscale: size.upscale,\n                mode: size.mode,\n                size: targetSize\n              };\n            }\n          }\n\n          if (markup) {\n            metadata.markup = markup;\n          }\n\n          // set filters and colors so we can restore them when re-editing the image\n          metadata.colors = color;\n          metadata.filters = filter;\n\n          // set merged color matrix to use in preview plugin\n          metadata.filter = colorMatrix;\n\n          // update crop metadata\n          item.setMetadata(metadata);\n\n          // call\n          editor.filepondCallbackBridge.onconfirm(data, createItemAPI(item));\n\n          // used in instant edit mode\n          if (!handleEditorResponse) return;\n          editor.onclose = function() {\n            handleEditorResponse(true);\n            editor.onclose = null;\n          };\n        };\n\n        editor.oncancel = function() {\n          // call\n          editor.filepondCallbackBridge.oncancel(createItemAPI(item));\n\n          // used in instant edit mode\n          if (!handleEditorResponse) return;\n          editor.onclose = function() {\n            handleEditorResponse(false);\n            editor.onclose = null;\n          };\n        };\n\n        editor.open(file, imageParameters);\n      };\n\n      /**\n       * Image Preview related\n       */\n\n      // create the image edit plugin, but only do so if the item is an image\n      var didLoadItem = function didLoadItem(_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props;\n\n        if (!query('GET_IMAGE_EDIT_ALLOW_EDIT')) return;\n        var id = props.id;\n\n        // try to access item\n        var item = query('GET_ITEM', id);\n        if (!item) return;\n\n        // get the file object\n        var file = item.file;\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) return;\n\n        // handle interactions\n        root.ref.handleEdit = function(e) {\n          e.stopPropagation();\n          root.dispatch('EDIT_ITEM', { id: id });\n        };\n\n        if (canShowImagePreview) {\n          // add edit button to preview\n          var buttonView = view.createChildView(fileActionButton, {\n            label: 'edit',\n            icon: query('GET_IMAGE_EDIT_ICON_EDIT'),\n            opacity: 0\n          });\n\n          // edit item classname\n          buttonView.element.classList.add('filepond--action-edit-item');\n          buttonView.element.dataset.align = query(\n            'GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION'\n          );\n          buttonView.on('click', root.ref.handleEdit);\n\n          root.ref.buttonEditItem = view.appendChildView(buttonView);\n        } else {\n          // view is file info\n          var filenameElement = view.element.querySelector(\n            '.filepond--file-info-main'\n          );\n          var editButton = document.createElement('button');\n          editButton.className = 'filepond--action-edit-item-alt';\n          editButton.innerHTML =\n            query('GET_IMAGE_EDIT_ICON_EDIT') + '<span>edit</span>';\n          editButton.addEventListener('click', root.ref.handleEdit);\n          filenameElement.appendChild(editButton);\n\n          root.ref.editButton = editButton;\n        }\n      };\n\n      view.registerDestroyer(function(_ref7) {\n        var root = _ref7.root;\n        if (root.ref.buttonEditItem) {\n          root.ref.buttonEditItem.off('click', root.ref.handleEdit);\n        }\n        if (root.ref.editButton) {\n          root.ref.editButton.removeEventListener('click', root.ref.handleEdit);\n        }\n      });\n\n      var routes = {\n        EDIT_ITEM: openEditor,\n        DID_LOAD_ITEM: didLoadItem\n      };\n\n      if (canShowImagePreview) {\n        // view is file\n        var didPreviewUpdate = function didPreviewUpdate(_ref8) {\n          var root = _ref8.root;\n          if (!root.ref.buttonEditItem) return;\n          root.ref.buttonEditItem.opacity = 1;\n        };\n\n        routes.DID_IMAGE_PREVIEW_SHOW = didPreviewUpdate;\n      } else {\n      }\n\n      // start writing\n      view.registerWriter(createRoute(routes));\n    });\n\n    // Expose plugin options\n    return {\n      options: {\n        // enable or disable image editing\n        allowImageEdit: [true, Type.BOOLEAN],\n\n        // location of processing button\n        styleImageEditButtonEditItemPosition: ['bottom center', Type.STRING],\n\n        // open editor when image is dropped\n        imageEditInstantEdit: [false, Type.BOOLEAN],\n\n        // allow editing\n        imageEditAllowEdit: [true, Type.BOOLEAN],\n\n        // the icon to use for the edit button\n        imageEditIconEdit: [\n          '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n          Type.STRING\n        ],\n\n        // editor object\n        imageEditEditor: [null, Type.OBJECT]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser =\n    typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser) {\n    document.dispatchEvent(\n      new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n    );\n  }\n\n  return plugin;\n});\n","/*!\n * FilePondPluginImageTransform 3.8.7\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? (module.exports = factory())\n        : typeof define === 'function' && define.amd\n        ? define(factory)\n        : ((global = global || self), (global.FilePondPluginImageTransform = factory()));\n})(this, function() {\n    'use strict';\n\n    // test if file is of type image\n    var isImage = function isImage(file) {\n        return /^image/.test(file.type);\n    };\n\n    var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n        return name.substr(0, name.lastIndexOf('.')) || name;\n    };\n\n    // only handles image/jpg, image/jpeg, image/png, and image/svg+xml for now\n    var ExtensionMap = {\n        jpeg: 'jpg',\n        'svg+xml': 'svg',\n    };\n\n    var renameFileToMatchMimeType = function renameFileToMatchMimeType(filename, mimeType) {\n        var name = getFilenameWithoutExtension(filename);\n        var type = mimeType.split('/')[1];\n        var extension = ExtensionMap[type] || type;\n        return ''.concat(name, '.').concat(extension);\n    };\n\n    // returns all the valid output formats we can encode towards\n    var getValidOutputMimeType = function getValidOutputMimeType(type) {\n        return /jpeg|png|svg\\+xml/.test(type) ? type : 'image/jpeg';\n    };\n\n    // test if file is of type image\n    var isImage$1 = function isImage(file) {\n        return /^image/.test(file.type);\n    };\n\n    var MATRICES = {\n        1: function _() {\n            return [1, 0, 0, 1, 0, 0];\n        },\n        2: function _(width) {\n            return [-1, 0, 0, 1, width, 0];\n        },\n        3: function _(width, height) {\n            return [-1, 0, 0, -1, width, height];\n        },\n        4: function _(width, height) {\n            return [1, 0, 0, -1, 0, height];\n        },\n        5: function _() {\n            return [0, 1, 1, 0, 0, 0];\n        },\n        6: function _(width, height) {\n            return [0, 1, -1, 0, height, 0];\n        },\n        7: function _(width, height) {\n            return [0, -1, -1, 0, height, width];\n        },\n        8: function _(width) {\n            return [0, -1, 1, 0, 0, width];\n        },\n    };\n\n    var getImageOrientationMatrix = function getImageOrientationMatrix(width, height, orientation) {\n        if (orientation === -1) {\n            orientation = 1;\n        }\n        return MATRICES[orientation](width, height);\n    };\n\n    var createVector = function createVector(x, y) {\n        return { x: x, y: y };\n    };\n\n    var vectorDot = function vectorDot(a, b) {\n        return a.x * b.x + a.y * b.y;\n    };\n\n    var vectorSubtract = function vectorSubtract(a, b) {\n        return createVector(a.x - b.x, a.y - b.y);\n    };\n\n    var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n        return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n    };\n\n    var vectorDistance = function vectorDistance(a, b) {\n        return Math.sqrt(vectorDistanceSquared(a, b));\n    };\n\n    var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n        var a = length;\n\n        var A = 1.5707963267948966;\n        var B = rotation;\n        var C = 1.5707963267948966 - rotation;\n\n        var sinA = Math.sin(A);\n        var sinB = Math.sin(B);\n        var sinC = Math.sin(C);\n        var cosC = Math.cos(C);\n        var ratio = a / sinA;\n        var b = ratio * sinB;\n        var c = ratio * sinC;\n\n        return createVector(cosC * b, cosC * c);\n    };\n\n    var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n        var w = rect.width;\n        var h = rect.height;\n\n        var hor = getOffsetPointOnEdge(w, rotation);\n        var ver = getOffsetPointOnEdge(h, rotation);\n\n        var tl = createVector(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n        var tr = createVector(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n\n        var bl = createVector(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n\n        return {\n            width: vectorDistance(tl, tr),\n            height: vectorDistance(tl, bl),\n        };\n    };\n\n    var getImageRectZoomFactor = function getImageRectZoomFactor(imageRect, cropRect) {\n        var rotation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n        var center =\n            arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : { x: 0.5, y: 0.5 };\n\n        // calculate available space round image center position\n        var cx = center.x > 0.5 ? 1 - center.x : center.x;\n        var cy = center.y > 0.5 ? 1 - center.y : center.y;\n        var imageWidth = cx * 2 * imageRect.width;\n        var imageHeight = cy * 2 * imageRect.height;\n\n        // calculate rotated crop rectangle size\n        var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n        return Math.max(rotatedCropSize.width / imageWidth, rotatedCropSize.height / imageHeight);\n    };\n\n    var getCenteredCropRect = function getCenteredCropRect(container, aspectRatio) {\n        var width = container.width;\n        var height = width * aspectRatio;\n        if (height > container.height) {\n            height = container.height;\n            width = height / aspectRatio;\n        }\n        var x = (container.width - width) * 0.5;\n        var y = (container.height - height) * 0.5;\n\n        return {\n            x: x,\n            y: y,\n            width: width,\n            height: height,\n        };\n    };\n\n    var calculateCanvasSize = function calculateCanvasSize(image, canvasAspectRatio) {\n        var zoom = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n        var imageAspectRatio = image.height / image.width;\n\n        // determine actual pixels on x and y axis\n        var canvasWidth = 1;\n        var canvasHeight = canvasAspectRatio;\n        var imgWidth = 1;\n        var imgHeight = imageAspectRatio;\n        if (imgHeight > canvasHeight) {\n            imgHeight = canvasHeight;\n            imgWidth = imgHeight / imageAspectRatio;\n        }\n\n        var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n        var width = image.width / (zoom * scalar * imgWidth);\n        var height = width * canvasAspectRatio;\n\n        return {\n            width: width,\n            height: height,\n        };\n    };\n\n    var canvasRelease = function canvasRelease(canvas) {\n        canvas.width = 1;\n        canvas.height = 1;\n        var ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, 1, 1);\n    };\n\n    var isFlipped = function isFlipped(flip) {\n        return flip && (flip.horizontal || flip.vertical);\n    };\n\n    var getBitmap = function getBitmap(image, orientation, flip) {\n        if (orientation <= 1 && !isFlipped(flip)) {\n            image.width = image.naturalWidth;\n            image.height = image.naturalHeight;\n            return image;\n        }\n\n        var canvas = document.createElement('canvas');\n        var width = image.naturalWidth;\n        var height = image.naturalHeight;\n\n        // if is rotated incorrectly swap width and height\n        var swapped = orientation >= 5 && orientation <= 8;\n        if (swapped) {\n            canvas.width = height;\n            canvas.height = width;\n        } else {\n            canvas.width = width;\n            canvas.height = height;\n        }\n\n        // draw the image but first fix orientation and set correct flip\n        var ctx = canvas.getContext('2d');\n\n        // get base transformation matrix\n        if (orientation) {\n            ctx.transform.apply(ctx, getImageOrientationMatrix(width, height, orientation));\n        }\n\n        if (isFlipped(flip)) {\n            // flip horizontal\n            // [-1, 0, 0, 1, width, 0]\n            var matrix = [1, 0, 0, 1, 0, 0];\n            if ((!swapped && flip.horizontal) || swapped & flip.vertical) {\n                matrix[0] = -1;\n                matrix[4] = width;\n            }\n\n            // flip vertical\n            // [1, 0, 0, -1, 0, height]\n            if ((!swapped && flip.vertical) || (swapped && flip.horizontal)) {\n                matrix[3] = -1;\n                matrix[5] = height;\n            }\n\n            ctx.transform.apply(ctx, matrix);\n        }\n\n        ctx.drawImage(image, 0, 0, width, height);\n\n        return canvas;\n    };\n\n    var imageToImageData = function imageToImageData(imageElement, orientation) {\n        var crop = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n        var canvasMemoryLimit = options.canvasMemoryLimit,\n            _options$background = options.background,\n            background = _options$background === void 0 ? null : _options$background;\n\n        var zoom = crop.zoom || 1;\n\n        // fixes possible image orientation problems by drawing the image on the correct canvas\n        var bitmap = getBitmap(imageElement, orientation, crop.flip);\n        var imageSize = {\n            width: bitmap.width,\n            height: bitmap.height,\n        };\n\n        var aspectRatio = crop.aspectRatio || imageSize.height / imageSize.width;\n\n        var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n        if (canvasMemoryLimit) {\n            var requiredMemory = canvasSize.width * canvasSize.height;\n            if (requiredMemory > canvasMemoryLimit) {\n                var scalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredMemory);\n                imageSize.width = Math.floor(imageSize.width * scalar);\n                imageSize.height = Math.floor(imageSize.height * scalar);\n                canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n            }\n        }\n\n        var canvas = document.createElement('canvas');\n\n        var canvasCenter = {\n            x: canvasSize.width * 0.5,\n            y: canvasSize.height * 0.5,\n        };\n\n        var stage = {\n            x: 0,\n            y: 0,\n            width: canvasSize.width,\n            height: canvasSize.height,\n            center: canvasCenter,\n        };\n\n        var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n        var scale =\n            zoom *\n            getImageRectZoomFactor(\n                imageSize,\n                getCenteredCropRect(stage, aspectRatio),\n                crop.rotation,\n                shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n            );\n\n        // start drawing\n        canvas.width = Math.round(canvasSize.width / scale);\n        canvas.height = Math.round(canvasSize.height / scale);\n\n        canvasCenter.x /= scale;\n        canvasCenter.y /= scale;\n\n        var imageOffset = {\n            x: canvasCenter.x - imageSize.width * (crop.center ? crop.center.x : 0.5),\n            y: canvasCenter.y - imageSize.height * (crop.center ? crop.center.y : 0.5),\n        };\n\n        var ctx = canvas.getContext('2d');\n        if (background) {\n            ctx.fillStyle = background;\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n        }\n\n        // move to draw offset\n        ctx.translate(canvasCenter.x, canvasCenter.y);\n        ctx.rotate(crop.rotation || 0);\n\n        // draw the image\n        ctx.drawImage(\n            bitmap,\n            imageOffset.x - canvasCenter.x,\n            imageOffset.y - canvasCenter.y,\n            imageSize.width,\n            imageSize.height\n        );\n\n        // get data from canvas\n        var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n        // release canvas\n        canvasRelease(canvas);\n\n        // return data\n        return imageData;\n    };\n\n    /**\n     * Polyfill toBlob for Edge\n     */\n    var IS_BROWSER = (function() {\n        return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    })();\n    if (IS_BROWSER) {\n        if (!HTMLCanvasElement.prototype.toBlob) {\n            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n                value: function value(callback, type, quality) {\n                    var dataURL = this.toDataURL(type, quality).split(',')[1];\n                    setTimeout(function() {\n                        var binStr = atob(dataURL);\n                        var len = binStr.length;\n                        var arr = new Uint8Array(len);\n                        for (var i = 0; i < len; i++) {\n                            arr[i] = binStr.charCodeAt(i);\n                        }\n                        callback(new Blob([arr], { type: type || 'image/png' }));\n                    });\n                },\n            });\n        }\n    }\n\n    var canvasToBlob = function canvasToBlob(canvas, options) {\n        var beforeCreateBlob =\n            arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        return new Promise(function(resolve) {\n            var promisedImage = beforeCreateBlob ? beforeCreateBlob(canvas) : canvas;\n            Promise.resolve(promisedImage).then(function(canvas) {\n                canvas.toBlob(resolve, options.type, options.quality);\n            });\n        });\n    };\n\n    var vectorMultiply = function vectorMultiply(v, amount) {\n        return createVector$1(v.x * amount, v.y * amount);\n    };\n\n    var vectorAdd = function vectorAdd(a, b) {\n        return createVector$1(a.x + b.x, a.y + b.y);\n    };\n\n    var vectorNormalize = function vectorNormalize(v) {\n        var l = Math.sqrt(v.x * v.x + v.y * v.y);\n        if (l === 0) {\n            return {\n                x: 0,\n                y: 0,\n            };\n        }\n        return createVector$1(v.x / l, v.y / l);\n    };\n\n    var vectorRotate = function vectorRotate(v, radians, origin) {\n        var cos = Math.cos(radians);\n        var sin = Math.sin(radians);\n        var t = createVector$1(v.x - origin.x, v.y - origin.y);\n        return createVector$1(origin.x + cos * t.x - sin * t.y, origin.y + sin * t.x + cos * t.y);\n    };\n\n    var createVector$1 = function createVector() {\n        var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n        return { x: x, y: y };\n    };\n\n    var getMarkupValue = function getMarkupValue(value, size) {\n        var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n        var axis = arguments.length > 3 ? arguments[3] : undefined;\n        if (typeof value === 'string') {\n            return parseFloat(value) * scalar;\n        }\n        if (typeof value === 'number') {\n            return value * (axis ? size[axis] : Math.min(size.width, size.height));\n        }\n        return;\n    };\n\n    var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n        var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n        var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n        var stroke = markup.borderColor || markup.lineColor || 'transparent';\n        var strokeWidth = getMarkupValue(markup.borderWidth || markup.lineWidth, size, scale);\n        var lineCap = markup.lineCap || 'round';\n        var lineJoin = markup.lineJoin || 'round';\n        var dashes =\n            typeof lineStyle === 'string'\n                ? ''\n                : lineStyle\n                      .map(function(v) {\n                          return getMarkupValue(v, size, scale);\n                      })\n                      .join(',');\n        var opacity = markup.opacity || 1;\n        return {\n            'stroke-linecap': lineCap,\n            'stroke-linejoin': lineJoin,\n            'stroke-width': strokeWidth || 0,\n            'stroke-dasharray': dashes,\n            stroke: stroke,\n            fill: fill,\n            opacity: opacity,\n        };\n    };\n\n    var isDefined = function isDefined(value) {\n        return value != null;\n    };\n\n    var getMarkupRect = function getMarkupRect(rect, size) {\n        var scalar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n        var left =\n            getMarkupValue(rect.x, size, scalar, 'width') ||\n            getMarkupValue(rect.left, size, scalar, 'width');\n        var top =\n            getMarkupValue(rect.y, size, scalar, 'height') ||\n            getMarkupValue(rect.top, size, scalar, 'height');\n        var width = getMarkupValue(rect.width, size, scalar, 'width');\n        var height = getMarkupValue(rect.height, size, scalar, 'height');\n        var right = getMarkupValue(rect.right, size, scalar, 'width');\n        var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n        if (!isDefined(top)) {\n            if (isDefined(height) && isDefined(bottom)) {\n                top = size.height - height - bottom;\n            } else {\n                top = bottom;\n            }\n        }\n\n        if (!isDefined(left)) {\n            if (isDefined(width) && isDefined(right)) {\n                left = size.width - width - right;\n            } else {\n                left = right;\n            }\n        }\n\n        if (!isDefined(width)) {\n            if (isDefined(left) && isDefined(right)) {\n                width = size.width - left - right;\n            } else {\n                width = 0;\n            }\n        }\n\n        if (!isDefined(height)) {\n            if (isDefined(top) && isDefined(bottom)) {\n                height = size.height - top - bottom;\n            } else {\n                height = 0;\n            }\n        }\n\n        return {\n            x: left || 0,\n            y: top || 0,\n            width: width || 0,\n            height: height || 0,\n        };\n    };\n\n    var pointsToPathShape = function pointsToPathShape(points) {\n        return points\n            .map(function(point, index) {\n                return ''\n                    .concat(index === 0 ? 'M' : 'L', ' ')\n                    .concat(point.x, ' ')\n                    .concat(point.y);\n            })\n            .join(' ');\n    };\n\n    var setAttributes = function setAttributes(element, attr) {\n        return Object.keys(attr).forEach(function(key) {\n            return element.setAttribute(key, attr[key]);\n        });\n    };\n\n    var ns = 'http://www.w3.org/2000/svg';\n    var svg = function svg(tag, attr) {\n        var element = document.createElementNS(ns, tag);\n        if (attr) {\n            setAttributes(element, attr);\n        }\n        return element;\n    };\n\n    var updateRect = function updateRect(element) {\n        return setAttributes(element, Object.assign({}, element.rect, element.styles));\n    };\n\n    var updateEllipse = function updateEllipse(element) {\n        var cx = element.rect.x + element.rect.width * 0.5;\n        var cy = element.rect.y + element.rect.height * 0.5;\n        var rx = element.rect.width * 0.5;\n        var ry = element.rect.height * 0.5;\n        return setAttributes(\n            element,\n            Object.assign(\n                {\n                    cx: cx,\n                    cy: cy,\n                    rx: rx,\n                    ry: ry,\n                },\n                element.styles\n            )\n        );\n    };\n\n    var IMAGE_FIT_STYLE = {\n        contain: 'xMidYMid meet',\n        cover: 'xMidYMid slice',\n    };\n\n    var updateImage = function updateImage(element, markup) {\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none',\n            })\n        );\n    };\n\n    var TEXT_ANCHOR = {\n        left: 'start',\n        center: 'middle',\n        right: 'end',\n    };\n\n    var updateText = function updateText(element, markup, size, scale) {\n        var fontSize = getMarkupValue(markup.fontSize, size, scale);\n        var fontFamily = markup.fontFamily || 'sans-serif';\n        var fontWeight = markup.fontWeight || 'normal';\n        var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                'stroke-width': 0,\n                'font-weight': fontWeight,\n                'font-size': fontSize,\n                'font-family': fontFamily,\n                'text-anchor': textAlign,\n            })\n        );\n\n        // update text\n        if (element.text !== markup.text) {\n            element.text = markup.text;\n            element.textContent = markup.text.length ? markup.text : ' ';\n        }\n    };\n\n    var updateLine = function updateLine(element, markup, size, scale) {\n        setAttributes(\n            element,\n            Object.assign({}, element.rect, element.styles, {\n                fill: 'none',\n            })\n        );\n\n        var line = element.childNodes[0];\n        var begin = element.childNodes[1];\n        var end = element.childNodes[2];\n\n        var origin = element.rect;\n\n        var target = {\n            x: element.rect.x + element.rect.width,\n            y: element.rect.y + element.rect.height,\n        };\n\n        setAttributes(line, {\n            x1: origin.x,\n            y1: origin.y,\n            x2: target.x,\n            y2: target.y,\n        });\n\n        if (!markup.lineDecoration) return;\n\n        begin.style.display = 'none';\n        end.style.display = 'none';\n\n        var v = vectorNormalize({\n            x: target.x - origin.x,\n            y: target.y - origin.y,\n        });\n\n        var l = getMarkupValue(0.05, size, scale);\n\n        if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n            var arrowBeginRotationPoint = vectorMultiply(v, l);\n            var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n            var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n            var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n            setAttributes(begin, {\n                style: 'display:block;',\n                d: 'M'\n                    .concat(arrowBeginA.x, ',')\n                    .concat(arrowBeginA.y, ' L')\n                    .concat(origin.x, ',')\n                    .concat(origin.y, ' L')\n                    .concat(arrowBeginB.x, ',')\n                    .concat(arrowBeginB.y),\n            });\n        }\n\n        if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n            var arrowEndRotationPoint = vectorMultiply(v, -l);\n            var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n            var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n            var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n            setAttributes(end, {\n                style: 'display:block;',\n                d: 'M'\n                    .concat(arrowEndA.x, ',')\n                    .concat(arrowEndA.y, ' L')\n                    .concat(target.x, ',')\n                    .concat(target.y, ' L')\n                    .concat(arrowEndB.x, ',')\n                    .concat(arrowEndB.y),\n            });\n        }\n    };\n\n    var updatePath = function updatePath(element, markup, size, scale) {\n        setAttributes(\n            element,\n            Object.assign({}, element.styles, {\n                fill: 'none',\n                d: pointsToPathShape(\n                    markup.points.map(function(point) {\n                        return {\n                            x: getMarkupValue(point.x, size, scale, 'width'),\n                            y: getMarkupValue(point.y, size, scale, 'height'),\n                        };\n                    })\n                ),\n            })\n        );\n    };\n\n    var createShape = function createShape(node) {\n        return function(markup) {\n            return svg(node, { id: markup.id });\n        };\n    };\n\n    var createImage = function createImage(markup) {\n        var shape = svg('image', {\n            id: markup.id,\n            'stroke-linecap': 'round',\n            'stroke-linejoin': 'round',\n            opacity: '0',\n        });\n\n        shape.onload = function() {\n            shape.setAttribute('opacity', markup.opacity || 1);\n        };\n        shape.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', markup.src);\n        return shape;\n    };\n\n    var createLine = function createLine(markup) {\n        var shape = svg('g', {\n            id: markup.id,\n            'stroke-linecap': 'round',\n            'stroke-linejoin': 'round',\n        });\n\n        var line = svg('line');\n        shape.appendChild(line);\n\n        var begin = svg('path');\n        shape.appendChild(begin);\n\n        var end = svg('path');\n        shape.appendChild(end);\n\n        return shape;\n    };\n\n    var CREATE_TYPE_ROUTES = {\n        image: createImage,\n        rect: createShape('rect'),\n        ellipse: createShape('ellipse'),\n        text: createShape('text'),\n        path: createShape('path'),\n        line: createLine,\n    };\n\n    var UPDATE_TYPE_ROUTES = {\n        rect: updateRect,\n        ellipse: updateEllipse,\n        image: updateImage,\n        text: updateText,\n        path: updatePath,\n        line: updateLine,\n    };\n\n    var createMarkupByType = function createMarkupByType(type, markup) {\n        return CREATE_TYPE_ROUTES[type](markup);\n    };\n\n    var updateMarkupByType = function updateMarkupByType(element, type, markup, size, scale) {\n        if (type !== 'path') {\n            element.rect = getMarkupRect(markup, size, scale);\n        }\n        element.styles = getMarkupStyles(markup, size, scale);\n        UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n    };\n\n    var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n        if (a[1].zIndex > b[1].zIndex) {\n            return 1;\n        }\n        if (a[1].zIndex < b[1].zIndex) {\n            return -1;\n        }\n        return 0;\n    };\n\n    var cropSVG = function cropSVG(blob) {\n        var crop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var markup = arguments.length > 2 ? arguments[2] : undefined;\n        var options = arguments.length > 3 ? arguments[3] : undefined;\n        return new Promise(function(resolve) {\n            var _options$background = options.background,\n                background = _options$background === void 0 ? null : _options$background;\n\n            // load blob contents and wrap in crop svg\n            var fr = new FileReader();\n            fr.onloadend = function() {\n                // get svg text\n                var text = fr.result;\n\n                // create element with svg and get size\n                var original = document.createElement('div');\n                original.style.cssText =\n                    'position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;';\n                original.innerHTML = text;\n                var originalNode = original.querySelector('svg');\n                document.body.appendChild(original);\n\n                // request bounding box dimensions\n                var bBox = originalNode.getBBox();\n                original.parentNode.removeChild(original);\n\n                // get title\n                var titleNode = original.querySelector('title');\n\n                // calculate new heights and widths\n                var viewBoxAttribute = originalNode.getAttribute('viewBox') || '';\n                var widthAttribute = originalNode.getAttribute('width') || '';\n                var heightAttribute = originalNode.getAttribute('height') || '';\n                var width = parseFloat(widthAttribute) || null;\n                var height = parseFloat(heightAttribute) || null;\n                var widthUnits = (widthAttribute.match(/[a-z]+/) || [])[0] || '';\n                var heightUnits = (heightAttribute.match(/[a-z]+/) || [])[0] || '';\n\n                // create new size\n                var viewBoxList = viewBoxAttribute.split(' ').map(parseFloat);\n                var viewBox = viewBoxList.length\n                    ? {\n                          x: viewBoxList[0],\n                          y: viewBoxList[1],\n                          width: viewBoxList[2],\n                          height: viewBoxList[3],\n                      }\n                    : bBox;\n\n                var imageWidth = width != null ? width : viewBox.width;\n                var imageHeight = height != null ? height : viewBox.height;\n\n                originalNode.style.overflow = 'visible';\n                originalNode.setAttribute('width', imageWidth);\n                originalNode.setAttribute('height', imageHeight);\n\n                // markup\n                var markupSVG = '';\n                if (markup && markup.length) {\n                    var size = {\n                        width: imageWidth,\n                        height: imageHeight,\n                    };\n\n                    markupSVG = markup.sort(sortMarkupByZIndex).reduce(function(prev, shape) {\n                        var el = createMarkupByType(shape[0], shape[1]);\n                        updateMarkupByType(el, shape[0], shape[1], size);\n                        el.removeAttribute('id');\n                        if (el.getAttribute('opacity') === 1) {\n                            el.removeAttribute('opacity');\n                        }\n                        return prev + '\\n' + el.outerHTML + '\\n';\n                    }, '');\n                    markupSVG = '\\n\\n<g>'.concat(markupSVG.replace(/&nbsp;/g, ' '), '</g>\\n\\n');\n                }\n\n                var aspectRatio = crop.aspectRatio || imageHeight / imageWidth;\n\n                var canvasWidth = imageWidth;\n                var canvasHeight = canvasWidth * aspectRatio;\n\n                var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n                var cropCenterX = crop.center ? crop.center.x : 0.5;\n                var cropCenterY = crop.center ? crop.center.y : 0.5;\n\n                var canvasZoomFactor = getImageRectZoomFactor(\n                    {\n                        width: imageWidth,\n                        height: imageHeight,\n                    },\n\n                    getCenteredCropRect(\n                        {\n                            width: canvasWidth,\n                            height: canvasHeight,\n                        },\n\n                        aspectRatio\n                    ),\n\n                    crop.rotation,\n                    shouldLimit\n                        ? { x: cropCenterX, y: cropCenterY }\n                        : {\n                              x: 0.5,\n                              y: 0.5,\n                          }\n                );\n\n                var scale = crop.zoom * canvasZoomFactor;\n\n                var rotation = crop.rotation * (180 / Math.PI);\n\n                var canvasCenter = {\n                    x: canvasWidth * 0.5,\n                    y: canvasHeight * 0.5,\n                };\n\n                var imageOffset = {\n                    x: canvasCenter.x - imageWidth * cropCenterX,\n                    y: canvasCenter.y - imageHeight * cropCenterY,\n                };\n\n                var cropTransforms = [\n                    // rotate\n                    'rotate('\n                        .concat(rotation, ' ')\n                        .concat(canvasCenter.x, ' ')\n                        .concat(canvasCenter.y, ')'),\n\n                    // scale\n                    'translate('.concat(canvasCenter.x, ' ').concat(canvasCenter.y, ')'),\n                    'scale('.concat(scale, ')'),\n                    'translate('.concat(-canvasCenter.x, ' ').concat(-canvasCenter.y, ')'),\n\n                    // offset\n                    'translate('.concat(imageOffset.x, ' ').concat(imageOffset.y, ')'),\n                ];\n\n                var cropFlipHorizontal = crop.flip && crop.flip.horizontal;\n                var cropFlipVertical = crop.flip && crop.flip.vertical;\n\n                var flipTransforms = [\n                    'scale('\n                        .concat(cropFlipHorizontal ? -1 : 1, ' ')\n                        .concat(cropFlipVertical ? -1 : 1, ')'),\n                    'translate('\n                        .concat(cropFlipHorizontal ? -imageWidth : 0, ' ')\n                        .concat(cropFlipVertical ? -imageHeight : 0, ')'),\n                ];\n\n                // crop\n                var transformed = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<svg width=\"'\n                    .concat(canvasWidth)\n                    .concat(widthUnits, '\" height=\"')\n                    .concat(canvasHeight)\n                    .concat(heightUnits, '\" \\nviewBox=\"0 0 ')\n                    .concat(canvasWidth, ' ')\n                    .concat(canvasHeight, '\" ')\n                    .concat(\n                        background ? 'style=\"background:' + background + '\" ' : '',\n                        '\\npreserveAspectRatio=\"xMinYMin\"\\nxmlns:xlink=\"http://www.w3.org/1999/xlink\"\\nxmlns=\"http://www.w3.org/2000/svg\">\\n<!-- Generated by PQINA - https://pqina.nl/ -->\\n<title>'\n                    )\n                    .concat(titleNode ? titleNode.textContent : '', '</title>\\n<g transform=\"')\n                    .concat(cropTransforms.join(' '), '\">\\n<g transform=\"')\n                    .concat(flipTransforms.join(' '), '\">\\n')\n                    .concat(originalNode.outerHTML)\n                    .concat(markupSVG, '\\n</g>\\n</g>\\n</svg>');\n\n                // create new svg file\n                resolve(transformed);\n            };\n\n            fr.readAsText(blob);\n        });\n    };\n\n    var objectToImageData = function objectToImageData(obj) {\n        var imageData;\n        try {\n            imageData = new ImageData(obj.width, obj.height);\n        } catch (e) {\n            // IE + Old EDGE (tested on 12)\n            var canvas = document.createElement('canvas');\n            imageData = canvas.getContext('2d').createImageData(obj.width, obj.height);\n        }\n        imageData.data.set(obj.data);\n        return imageData;\n    };\n\n    /* javascript-obfuscator:disable */\n    var TransformWorker = function TransformWorker() {\n        // maps transform types to transform functions\n        var TRANSFORMS = { resize: resize, filter: filter };\n\n        // applies all image transforms to the image data array\n        var applyTransforms = function applyTransforms(transforms, imageData) {\n            transforms.forEach(function(transform) {\n                imageData = TRANSFORMS[transform.type](imageData, transform.data);\n            });\n            return imageData;\n        };\n\n        // transform image hub\n        var transform = function transform(data, cb) {\n            var transforms = data.transforms;\n\n            // if has filter and has resize, move filter to resize operation\n            var filterTransform = null;\n            transforms.forEach(function(transform) {\n                if (transform.type === 'filter') {\n                    filterTransform = transform;\n                }\n            });\n            if (filterTransform) {\n                // find resize\n                var resizeTransform = null;\n                transforms.forEach(function(transform) {\n                    if (transform.type === 'resize') {\n                        resizeTransform = transform;\n                    }\n                });\n\n                if (resizeTransform) {\n                    // update resize operation\n                    resizeTransform.data.matrix = filterTransform.data;\n\n                    // remove filter\n                    transforms = transforms.filter(function(transform) {\n                        return transform.type !== 'filter';\n                    });\n                }\n            }\n\n            cb(applyTransforms(transforms, data.imageData));\n        };\n\n        // eslint-disable-next-line no-restricted-globals\n        self.onmessage = function(e) {\n            transform(e.data.message, function(response) {\n                // eslint-disable-next-line no-restricted-globals\n                self.postMessage({ id: e.data.id, message: response }, [response.data.buffer]);\n            });\n        };\n\n        var br = 1.0;\n        var bg = 1.0;\n        var bb = 1.0;\n        function applyFilterMatrix(index, data, m) {\n            var ir = data[index] / 255;\n            var ig = data[index + 1] / 255;\n            var ib = data[index + 2] / 255;\n            var ia = data[index + 3] / 255;\n\n            var mr = ir * m[0] + ig * m[1] + ib * m[2] + ia * m[3] + m[4];\n            var mg = ir * m[5] + ig * m[6] + ib * m[7] + ia * m[8] + m[9];\n            var mb = ir * m[10] + ig * m[11] + ib * m[12] + ia * m[13] + m[14];\n            var ma = ir * m[15] + ig * m[16] + ib * m[17] + ia * m[18] + m[19];\n\n            var or = Math.max(0, mr * ma) + br * (1.0 - ma);\n            var og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n            var ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n\n            data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n            data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n            data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n        }\n\n        var identityMatrix = self.JSON.stringify([\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n        ]);\n        function isIdentityMatrix(filter) {\n            return self.JSON.stringify(filter || []) === identityMatrix;\n        }\n\n        function filter(imageData, matrix) {\n            if (!matrix || isIdentityMatrix(matrix)) return imageData;\n\n            var data = imageData.data;\n            var l = data.length;\n\n            var m11 = matrix[0];\n            var m12 = matrix[1];\n            var m13 = matrix[2];\n            var m14 = matrix[3];\n            var m15 = matrix[4];\n\n            var m21 = matrix[5];\n            var m22 = matrix[6];\n            var m23 = matrix[7];\n            var m24 = matrix[8];\n            var m25 = matrix[9];\n\n            var m31 = matrix[10];\n            var m32 = matrix[11];\n            var m33 = matrix[12];\n            var m34 = matrix[13];\n            var m35 = matrix[14];\n\n            var m41 = matrix[15];\n            var m42 = matrix[16];\n            var m43 = matrix[17];\n            var m44 = matrix[18];\n            var m45 = matrix[19];\n\n            var index = 0,\n                r = 0.0,\n                g = 0.0,\n                b = 0.0,\n                a = 0.0,\n                mr = 0.0,\n                mg = 0.0,\n                mb = 0.0,\n                ma = 0.0,\n                or = 0.0,\n                og = 0.0,\n                ob = 0.0;\n\n            for (; index < l; index += 4) {\n                r = data[index] / 255;\n                g = data[index + 1] / 255;\n                b = data[index + 2] / 255;\n                a = data[index + 3] / 255;\n\n                mr = r * m11 + g * m12 + b * m13 + a * m14 + m15;\n                mg = r * m21 + g * m22 + b * m23 + a * m24 + m25;\n                mb = r * m31 + g * m32 + b * m33 + a * m34 + m35;\n                ma = r * m41 + g * m42 + b * m43 + a * m44 + m45;\n\n                or = Math.max(0, mr * ma) + br * (1.0 - ma);\n                og = Math.max(0, mg * ma) + bg * (1.0 - ma);\n                ob = Math.max(0, mb * ma) + bb * (1.0 - ma);\n\n                data[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n                data[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n                data[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n                // don't update alpha value\n            }\n\n            return imageData;\n        }\n\n        function resize(imageData, data) {\n            var _data$mode = data.mode,\n                mode = _data$mode === void 0 ? 'contain' : _data$mode,\n                _data$upscale = data.upscale,\n                upscale = _data$upscale === void 0 ? false : _data$upscale,\n                width = data.width,\n                height = data.height,\n                matrix = data.matrix;\n\n            // test if is identity matrix\n            matrix = !matrix || isIdentityMatrix(matrix) ? null : matrix;\n\n            // need at least a width or a height\n            // also 0 is not a valid width or height\n            if (!width && !height) {\n                return filter(imageData, matrix);\n            }\n\n            // make sure all bounds are set\n            if (width === null) {\n                width = height;\n            } else if (height === null) {\n                height = width;\n            }\n\n            if (mode !== 'force') {\n                var scalarWidth = width / imageData.width;\n                var scalarHeight = height / imageData.height;\n                var scalar = 1;\n\n                if (mode === 'cover') {\n                    scalar = Math.max(scalarWidth, scalarHeight);\n                } else if (mode === 'contain') {\n                    scalar = Math.min(scalarWidth, scalarHeight);\n                }\n\n                // if image is too small, exit here with original image\n                if (scalar > 1 && upscale === false) {\n                    return filter(imageData, matrix);\n                }\n\n                width = imageData.width * scalar;\n                height = imageData.height * scalar;\n            }\n\n            var originWidth = imageData.width;\n            var originHeight = imageData.height;\n            var targetWidth = Math.round(width);\n            var targetHeight = Math.round(height);\n            var inputData = imageData.data;\n            var outputData = new Uint8ClampedArray(targetWidth * targetHeight * 4);\n            var ratioWidth = originWidth / targetWidth;\n            var ratioHeight = originHeight / targetHeight;\n            var ratioWidthHalf = Math.ceil(ratioWidth * 0.5);\n            var ratioHeightHalf = Math.ceil(ratioHeight * 0.5);\n\n            for (var j = 0; j < targetHeight; j++) {\n                for (var i = 0; i < targetWidth; i++) {\n                    var x2 = (i + j * targetWidth) * 4;\n                    var weight = 0;\n                    var weights = 0;\n                    var weightsAlpha = 0;\n                    var r = 0;\n                    var g = 0;\n                    var b = 0;\n                    var a = 0;\n                    var centerY = (j + 0.5) * ratioHeight;\n\n                    for (var yy = Math.floor(j * ratioHeight); yy < (j + 1) * ratioHeight; yy++) {\n                        var dy = Math.abs(centerY - (yy + 0.5)) / ratioHeightHalf;\n                        var centerX = (i + 0.5) * ratioWidth;\n                        var w0 = dy * dy;\n\n                        for (var xx = Math.floor(i * ratioWidth); xx < (i + 1) * ratioWidth; xx++) {\n                            var dx = Math.abs(centerX - (xx + 0.5)) / ratioWidthHalf;\n                            var w = Math.sqrt(w0 + dx * dx);\n\n                            if (w >= -1 && w <= 1) {\n                                weight = 2 * w * w * w - 3 * w * w + 1;\n\n                                if (weight > 0) {\n                                    dx = 4 * (xx + yy * originWidth);\n\n                                    var ref = inputData[dx + 3];\n                                    a += weight * ref;\n                                    weightsAlpha += weight;\n\n                                    if (ref < 255) {\n                                        weight = (weight * ref) / 250;\n                                    }\n\n                                    r += weight * inputData[dx];\n                                    g += weight * inputData[dx + 1];\n                                    b += weight * inputData[dx + 2];\n                                    weights += weight;\n                                }\n                            }\n                        }\n                    }\n\n                    outputData[x2] = r / weights;\n                    outputData[x2 + 1] = g / weights;\n                    outputData[x2 + 2] = b / weights;\n                    outputData[x2 + 3] = a / weightsAlpha;\n\n                    matrix && applyFilterMatrix(x2, outputData, matrix);\n                }\n            }\n\n            return {\n                data: outputData,\n                width: targetWidth,\n                height: targetHeight,\n            };\n        }\n    };\n    /* javascript-obfuscator:enable */\n\n    var correctOrientation = function correctOrientation(view, offset) {\n        // Missing 0x45786966 Marker? No Exif Header, stop here\n        if (view.getUint32(offset + 4, false) !== 0x45786966) return;\n\n        // next byte!\n        offset += 4;\n\n        // First 2bytes defines byte align of TIFF data.\n        // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n        var intelByteAligned = view.getUint16((offset += 6), false) === 0x4949;\n        offset += view.getUint32(offset + 4, intelByteAligned);\n\n        var tags = view.getUint16(offset, intelByteAligned);\n        offset += 2;\n\n        // find Orientation tag\n        for (var i = 0; i < tags; i++) {\n            if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112) {\n                view.setUint16(offset + i * 12 + 8, 1, intelByteAligned);\n                return true;\n            }\n        }\n        return false;\n    };\n\n    var readData = function readData(data) {\n        var view = new DataView(data);\n\n        // Every JPEG file starts from binary value '0xFFD8'\n        // If it's not present, exit here\n        if (view.getUint16(0) !== 0xffd8) return null;\n\n        var offset = 2; // Start at 2 as we skipped two bytes (FFD8)\n        var marker;\n        var markerLength;\n        var orientationCorrected = false;\n\n        while (offset < view.byteLength) {\n            marker = view.getUint16(offset, false);\n            markerLength = view.getUint16(offset + 2, false) + 2;\n\n            // Test if is APP and COM markers\n            var isData = (marker >= 0xffe0 && marker <= 0xffef) || marker === 0xfffe;\n            if (!isData) {\n                break;\n            }\n\n            if (!orientationCorrected) {\n                orientationCorrected = correctOrientation(view, offset, markerLength);\n            }\n\n            if (offset + markerLength > view.byteLength) {\n                break;\n            }\n\n            offset += markerLength;\n        }\n        return data.slice(0, offset);\n    };\n\n    var getImageHead = function getImageHead(file) {\n        return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function() {\n                return resolve(readData(reader.result) || null);\n            };\n            reader.readAsArrayBuffer(file.slice(0, 256 * 1024));\n        });\n    };\n\n    var getBlobBuilder = function getBlobBuilder() {\n        return (window.BlobBuilder =\n            window.BlobBuilder ||\n            window.WebKitBlobBuilder ||\n            window.MozBlobBuilder ||\n            window.MSBlobBuilder);\n    };\n\n    var createBlob = function createBlob(arrayBuffer, mimeType) {\n        var BB = getBlobBuilder();\n\n        if (BB) {\n            var bb = new BB();\n            bb.append(arrayBuffer);\n            return bb.getBlob(mimeType);\n        }\n\n        return new Blob([arrayBuffer], {\n            type: mimeType,\n        });\n    };\n\n    var getUniqueId = function getUniqueId() {\n        return Math.random()\n            .toString(36)\n            .substr(2, 9);\n    };\n\n    var createWorker = function createWorker(fn) {\n        var workerBlob = new Blob(['(', fn.toString(), ')()'], { type: 'application/javascript' });\n        var workerURL = URL.createObjectURL(workerBlob);\n        var worker = new Worker(workerURL);\n\n        var trips = [];\n\n        return {\n            transfer: function transfer() {}, // (message, cb) => {}\n            post: function post(message, cb, transferList) {\n                var id = getUniqueId();\n                trips[id] = cb;\n\n                worker.onmessage = function(e) {\n                    var cb = trips[e.data.id];\n                    if (!cb) return;\n                    cb(e.data.message);\n                    delete trips[e.data.id];\n                };\n\n                worker.postMessage(\n                    {\n                        id: id,\n                        message: message,\n                    },\n\n                    transferList\n                );\n            },\n            terminate: function terminate() {\n                worker.terminate();\n                URL.revokeObjectURL(workerURL);\n            },\n        };\n    };\n\n    var loadImage = function loadImage(url) {\n        return new Promise(function(resolve, reject) {\n            var img = new Image();\n            img.onload = function() {\n                resolve(img);\n            };\n            img.onerror = function(e) {\n                reject(e);\n            };\n            img.src = url;\n        });\n    };\n\n    var chain = function chain(funcs) {\n        return funcs.reduce(function(promise, func) {\n            return promise.then(function(result) {\n                return func().then(Array.prototype.concat.bind(result));\n            });\n        }, Promise.resolve([]));\n    };\n\n    var canvasApplyMarkup = function canvasApplyMarkup(canvas, markup) {\n        return new Promise(function(resolve) {\n            var size = {\n                width: canvas.width,\n                height: canvas.height,\n            };\n\n            var ctx = canvas.getContext('2d');\n\n            var drawers = markup.sort(sortMarkupByZIndex).map(function(item) {\n                return function() {\n                    return new Promise(function(resolve) {\n                        var result = TYPE_DRAW_ROUTES[item[0]](ctx, size, item[1], resolve);\n                        if (result) resolve();\n                    });\n                };\n            });\n\n            chain(drawers).then(function() {\n                return resolve(canvas);\n            });\n        });\n    };\n\n    var applyMarkupStyles = function applyMarkupStyles(ctx, styles) {\n        ctx.beginPath();\n        ctx.lineCap = styles['stroke-linecap'];\n        ctx.lineJoin = styles['stroke-linejoin'];\n        ctx.lineWidth = styles['stroke-width'];\n        if (styles['stroke-dasharray'].length) {\n            ctx.setLineDash(styles['stroke-dasharray'].split(','));\n        }\n        ctx.fillStyle = styles['fill'];\n        ctx.strokeStyle = styles['stroke'];\n        ctx.globalAlpha = styles.opacity || 1;\n    };\n\n    var drawMarkupStyles = function drawMarkupStyles(ctx) {\n        ctx.fill();\n        ctx.stroke();\n        ctx.globalAlpha = 1;\n    };\n\n    var drawRect = function drawRect(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n        ctx.rect(rect.x, rect.y, rect.width, rect.height);\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawEllipse = function drawEllipse(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var x = rect.x,\n            y = rect.y,\n            w = rect.width,\n            h = rect.height,\n            kappa = 0.5522848,\n            ox = (w / 2) * kappa,\n            oy = (h / 2) * kappa,\n            xe = x + w,\n            ye = y + h,\n            xm = x + w / 2,\n            ym = y + h / 2;\n\n        ctx.moveTo(x, ym);\n        ctx.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\n        ctx.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\n        ctx.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\n        ctx.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawImage = function drawImage(ctx, size, markup, done) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var image = new Image();\n\n        // if is cross origin image add cross origin attribute\n        var isCrossOriginImage =\n            new URL(markup.src, window.location.href).origin !== window.location.origin;\n        if (isCrossOriginImage) image.crossOrigin = '';\n\n        image.onload = function() {\n            if (markup.fit === 'cover') {\n                var ar = rect.width / rect.height;\n                var width = ar > 1 ? image.width : image.height * ar;\n                var height = ar > 1 ? image.width / ar : image.height;\n                var x = image.width * 0.5 - width * 0.5;\n                var y = image.height * 0.5 - height * 0.5;\n                ctx.drawImage(image, x, y, width, height, rect.x, rect.y, rect.width, rect.height);\n            } else if (markup.fit === 'contain') {\n                var scalar = Math.min(rect.width / image.width, rect.height / image.height);\n                var _width = scalar * image.width;\n                var _height = scalar * image.height;\n                var _x = rect.x + rect.width * 0.5 - _width * 0.5;\n                var _y = rect.y + rect.height * 0.5 - _height * 0.5;\n                ctx.drawImage(image, 0, 0, image.width, image.height, _x, _y, _width, _height);\n            } else {\n                ctx.drawImage(\n                    image,\n                    0,\n                    0,\n                    image.width,\n                    image.height,\n                    rect.x,\n                    rect.y,\n                    rect.width,\n                    rect.height\n                );\n            }\n\n            drawMarkupStyles(ctx, styles);\n            done();\n        };\n        image.src = markup.src;\n    };\n\n    var drawText = function drawText(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        var fontSize = getMarkupValue(markup.fontSize, size);\n        var fontFamily = markup.fontFamily || 'sans-serif';\n        var fontWeight = markup.fontWeight || 'normal';\n        var textAlign = markup.textAlign || 'left';\n\n        ctx.font = ''\n            .concat(fontWeight, ' ')\n            .concat(fontSize, 'px ')\n            .concat(fontFamily);\n        ctx.textAlign = textAlign;\n        ctx.fillText(markup.text, rect.x, rect.y);\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawPath = function drawPath(ctx, size, markup) {\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n        ctx.beginPath();\n\n        var points = markup.points.map(function(point) {\n            return {\n                x: getMarkupValue(point.x, size, 1, 'width'),\n                y: getMarkupValue(point.y, size, 1, 'height'),\n            };\n        });\n\n        ctx.moveTo(points[0].x, points[0].y);\n        var l = points.length;\n        for (var i = 1; i < l; i++) {\n            ctx.lineTo(points[i].x, points[i].y);\n        }\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var drawLine = function drawLine(ctx, size, markup) {\n        var rect = getMarkupRect(markup, size);\n        var styles = getMarkupStyles(markup, size);\n        applyMarkupStyles(ctx, styles);\n\n        ctx.beginPath();\n\n        var origin = {\n            x: rect.x,\n            y: rect.y,\n        };\n\n        var target = {\n            x: rect.x + rect.width,\n            y: rect.y + rect.height,\n        };\n\n        ctx.moveTo(origin.x, origin.y);\n        ctx.lineTo(target.x, target.y);\n\n        var v = vectorNormalize({\n            x: target.x - origin.x,\n            y: target.y - origin.y,\n        });\n\n        var l = 0.04 * Math.min(size.width, size.height);\n\n        if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n            var arrowBeginRotationPoint = vectorMultiply(v, l);\n            var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n            var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n            var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n            ctx.moveTo(arrowBeginA.x, arrowBeginA.y);\n            ctx.lineTo(origin.x, origin.y);\n            ctx.lineTo(arrowBeginB.x, arrowBeginB.y);\n        }\n        if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n            var arrowEndRotationPoint = vectorMultiply(v, -l);\n            var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n            var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n            var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n            ctx.moveTo(arrowEndA.x, arrowEndA.y);\n            ctx.lineTo(target.x, target.y);\n            ctx.lineTo(arrowEndB.x, arrowEndB.y);\n        }\n\n        drawMarkupStyles(ctx, styles);\n        return true;\n    };\n\n    var TYPE_DRAW_ROUTES = {\n        rect: drawRect,\n        ellipse: drawEllipse,\n        image: drawImage,\n        text: drawText,\n        line: drawLine,\n        path: drawPath,\n    };\n\n    var imageDataToCanvas = function imageDataToCanvas(imageData) {\n        var image = document.createElement('canvas');\n        image.width = imageData.width;\n        image.height = imageData.height;\n        var ctx = image.getContext('2d');\n        ctx.putImageData(imageData, 0, 0);\n        return image;\n    };\n\n    var transformImage = function transformImage(file, instructions) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        return new Promise(function(resolve, reject) {\n            // if the file is not an image we do not have any business transforming it\n            if (!file || !isImage$1(file))\n                return reject({ status: 'not an image file', file: file });\n\n            // get separate options for easier use\n            var stripImageHead = options.stripImageHead,\n                beforeCreateBlob = options.beforeCreateBlob,\n                afterCreateBlob = options.afterCreateBlob,\n                canvasMemoryLimit = options.canvasMemoryLimit;\n\n            // get crop\n            var crop = instructions.crop,\n                size = instructions.size,\n                filter = instructions.filter,\n                markup = instructions.markup,\n                output = instructions.output;\n\n            // get exif orientation\n            var orientation =\n                instructions.image && instructions.image.orientation\n                    ? Math.max(1, Math.min(8, instructions.image.orientation))\n                    : null;\n\n            // compression quality 0 => 100\n            var qualityAsPercentage = output && output.quality;\n            var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n\n            // output format\n            var type = (output && output.type) || null;\n\n            // background color\n            var background = (output && output.background) || null;\n\n            // get transforms\n            var transforms = [];\n\n            // add resize transforms if set\n            if (size && (typeof size.width === 'number' || typeof size.height === 'number')) {\n                transforms.push({ type: 'resize', data: size });\n            }\n\n            // add filters\n            if (filter && filter.length === 20) {\n                transforms.push({ type: 'filter', data: filter });\n            }\n\n            // resolves with supplied blob\n            var resolveWithBlob = function resolveWithBlob(blob) {\n                var promisedBlob = afterCreateBlob ? afterCreateBlob(blob) : blob;\n                Promise.resolve(promisedBlob).then(resolve);\n            };\n\n            // done\n            var toBlob = function toBlob(imageData, options) {\n                var canvas = imageDataToCanvas(imageData);\n                var promisedCanvas = markup.length ? canvasApplyMarkup(canvas, markup) : canvas;\n                Promise.resolve(promisedCanvas).then(function(canvas) {\n                    canvasToBlob(canvas, options, beforeCreateBlob)\n                        .then(function(blob) {\n                            // force release of canvas memory\n                            canvasRelease(canvas);\n\n                            // remove image head (default)\n                            if (stripImageHead) return resolveWithBlob(blob);\n\n                            // try to copy image head from original file to generated blob\n                            getImageHead(file).then(function(imageHead) {\n                                // re-inject image head in case of JPEG, as the image head is removed by canvas export\n                                if (imageHead !== null) {\n                                    blob = new Blob([imageHead, blob.slice(20)], {\n                                        type: blob.type,\n                                    });\n                                }\n\n                                // done!\n                                resolveWithBlob(blob);\n                            });\n                        })\n                        .catch(reject);\n                });\n            };\n\n            // if this is an svg and we want it to stay an svg\n            if (/svg/.test(file.type) && type === null) {\n                return cropSVG(file, crop, markup, { background: background }).then(function(text) {\n                    resolve(createBlob(text, 'image/svg+xml'));\n                });\n            }\n\n            // get file url\n            var url = URL.createObjectURL(file);\n\n            // turn the file into an image\n            loadImage(url)\n                .then(function(image) {\n                    // url is no longer needed\n                    URL.revokeObjectURL(url);\n\n                    // draw to canvas and start transform chain\n                    var imageData = imageToImageData(image, orientation, crop, {\n                        canvasMemoryLimit: canvasMemoryLimit,\n                        background: background,\n                    });\n\n                    // determine the format of the blob that we will output\n                    var outputFormat = {\n                        quality: quality,\n                        type: type || file.type,\n                    };\n\n                    // no transforms necessary, we done!\n                    if (!transforms.length) {\n                        return toBlob(imageData, outputFormat);\n                    }\n\n                    // send to the transform worker to transform the blob on a separate thread\n                    var worker = createWorker(TransformWorker);\n                    worker.post(\n                        {\n                            transforms: transforms,\n                            imageData: imageData,\n                        },\n\n                        function(response) {\n                            // finish up\n                            toBlob(objectToImageData(response), outputFormat);\n\n                            // stop worker\n                            worker.terminate();\n                        },\n                        [imageData.data.buffer]\n                    );\n                })\n                .catch(reject);\n        });\n    };\n\n    function _typeof(obj) {\n        if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n            _typeof = function(obj) {\n                return typeof obj;\n            };\n        } else {\n            _typeof = function(obj) {\n                return obj &&\n                    typeof Symbol === 'function' &&\n                    obj.constructor === Symbol &&\n                    obj !== Symbol.prototype\n                    ? 'symbol'\n                    : typeof obj;\n            };\n        }\n\n        return _typeof(obj);\n    }\n\n    var REACT_ELEMENT_TYPE;\n\n    function _jsx(type, props, key, children) {\n        if (!REACT_ELEMENT_TYPE) {\n            REACT_ELEMENT_TYPE =\n                (typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element')) ||\n                0xeac7;\n        }\n\n        var defaultProps = type && type.defaultProps;\n        var childrenLength = arguments.length - 3;\n\n        if (!props && childrenLength !== 0) {\n            props = {\n                children: void 0,\n            };\n        }\n\n        if (props && defaultProps) {\n            for (var propName in defaultProps) {\n                if (props[propName] === void 0) {\n                    props[propName] = defaultProps[propName];\n                }\n            }\n        } else if (!props) {\n            props = defaultProps || {};\n        }\n\n        if (childrenLength === 1) {\n            props.children = children;\n        } else if (childrenLength > 1) {\n            var childArray = new Array(childrenLength);\n\n            for (var i = 0; i < childrenLength; i++) {\n                childArray[i] = arguments[i + 3];\n            }\n\n            props.children = childArray;\n        }\n\n        return {\n            $$typeof: REACT_ELEMENT_TYPE,\n            type: type,\n            key: key === undefined ? null : '' + key,\n            ref: null,\n            props: props,\n            _owner: null,\n        };\n    }\n\n    function _asyncIterator(iterable) {\n        var method;\n\n        if (typeof Symbol === 'function') {\n            if (Symbol.asyncIterator) {\n                method = iterable[Symbol.asyncIterator];\n                if (method != null) return method.call(iterable);\n            }\n\n            if (Symbol.iterator) {\n                method = iterable[Symbol.iterator];\n                if (method != null) return method.call(iterable);\n            }\n        }\n\n        throw new TypeError('Object is not async iterable');\n    }\n\n    function _AwaitValue(value) {\n        this.wrapped = value;\n    }\n\n    function _AsyncGenerator(gen) {\n        var front, back;\n\n        function send(key, arg) {\n            return new Promise(function(resolve, reject) {\n                var request = {\n                    key: key,\n                    arg: arg,\n                    resolve: resolve,\n                    reject: reject,\n                    next: null,\n                };\n\n                if (back) {\n                    back = back.next = request;\n                } else {\n                    front = back = request;\n                    resume(key, arg);\n                }\n            });\n        }\n\n        function resume(key, arg) {\n            try {\n                var result = gen[key](arg);\n                var value = result.value;\n                var wrappedAwait = value instanceof _AwaitValue;\n                Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n                    function(arg) {\n                        if (wrappedAwait) {\n                            resume('next', arg);\n                            return;\n                        }\n\n                        settle(result.done ? 'return' : 'normal', arg);\n                    },\n                    function(err) {\n                        resume('throw', err);\n                    }\n                );\n            } catch (err) {\n                settle('throw', err);\n            }\n        }\n\n        function settle(type, value) {\n            switch (type) {\n                case 'return':\n                    front.resolve({\n                        value: value,\n                        done: true,\n                    });\n                    break;\n\n                case 'throw':\n                    front.reject(value);\n                    break;\n\n                default:\n                    front.resolve({\n                        value: value,\n                        done: false,\n                    });\n                    break;\n            }\n\n            front = front.next;\n\n            if (front) {\n                resume(front.key, front.arg);\n            } else {\n                back = null;\n            }\n        }\n\n        this._invoke = send;\n\n        if (typeof gen.return !== 'function') {\n            this.return = undefined;\n        }\n    }\n\n    if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n        _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n            return this;\n        };\n    }\n\n    _AsyncGenerator.prototype.next = function(arg) {\n        return this._invoke('next', arg);\n    };\n\n    _AsyncGenerator.prototype.throw = function(arg) {\n        return this._invoke('throw', arg);\n    };\n\n    _AsyncGenerator.prototype.return = function(arg) {\n        return this._invoke('return', arg);\n    };\n\n    function _wrapAsyncGenerator(fn) {\n        return function() {\n            return new _AsyncGenerator(fn.apply(this, arguments));\n        };\n    }\n\n    function _awaitAsyncGenerator(value) {\n        return new _AwaitValue(value);\n    }\n\n    function _asyncGeneratorDelegate(inner, awaitWrap) {\n        var iter = {},\n            waiting = false;\n\n        function pump(key, value) {\n            waiting = true;\n            value = new Promise(function(resolve) {\n                resolve(inner[key](value));\n            });\n            return {\n                done: false,\n                value: awaitWrap(value),\n            };\n        }\n\n        if (typeof Symbol === 'function' && Symbol.iterator) {\n            iter[Symbol.iterator] = function() {\n                return this;\n            };\n        }\n\n        iter.next = function(value) {\n            if (waiting) {\n                waiting = false;\n                return value;\n            }\n\n            return pump('next', value);\n        };\n\n        if (typeof inner.throw === 'function') {\n            iter.throw = function(value) {\n                if (waiting) {\n                    waiting = false;\n                    throw value;\n                }\n\n                return pump('throw', value);\n            };\n        }\n\n        if (typeof inner.return === 'function') {\n            iter.return = function(value) {\n                return pump('return', value);\n            };\n        }\n\n        return iter;\n    }\n\n    function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n        try {\n            var info = gen[key](arg);\n            var value = info.value;\n        } catch (error) {\n            reject(error);\n            return;\n        }\n\n        if (info.done) {\n            resolve(value);\n        } else {\n            Promise.resolve(value).then(_next, _throw);\n        }\n    }\n\n    function _asyncToGenerator(fn) {\n        return function() {\n            var self = this,\n                args = arguments;\n            return new Promise(function(resolve, reject) {\n                var gen = fn.apply(self, args);\n\n                function _next(value) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n                }\n\n                function _throw(err) {\n                    asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n                }\n\n                _next(undefined);\n            });\n        };\n    }\n\n    function _classCallCheck(instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n            throw new TypeError('Cannot call a class as a function');\n        }\n    }\n\n    function _defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if ('value' in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n        }\n    }\n\n    function _createClass(Constructor, protoProps, staticProps) {\n        if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n        if (staticProps) _defineProperties(Constructor, staticProps);\n        return Constructor;\n    }\n\n    function _defineEnumerableProperties(obj, descs) {\n        for (var key in descs) {\n            var desc = descs[key];\n            desc.configurable = desc.enumerable = true;\n            if ('value' in desc) desc.writable = true;\n            Object.defineProperty(obj, key, desc);\n        }\n\n        if (Object.getOwnPropertySymbols) {\n            var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n            for (var i = 0; i < objectSymbols.length; i++) {\n                var sym = objectSymbols[i];\n                var desc = descs[sym];\n                desc.configurable = desc.enumerable = true;\n                if ('value' in desc) desc.writable = true;\n                Object.defineProperty(obj, sym, desc);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defaults(obj, defaults) {\n        var keys = Object.getOwnPropertyNames(defaults);\n\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n            if (value && value.configurable && obj[key] === undefined) {\n                Object.defineProperty(obj, key, value);\n            }\n        }\n\n        return obj;\n    }\n\n    function _defineProperty(obj, key, value) {\n        if (key in obj) {\n            Object.defineProperty(obj, key, {\n                value: value,\n                enumerable: true,\n                configurable: true,\n                writable: true,\n            });\n        } else {\n            obj[key] = value;\n        }\n\n        return obj;\n    }\n\n    function _extends() {\n        _extends =\n            Object.assign ||\n            function(target) {\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n\n                    for (var key in source) {\n                        if (Object.prototype.hasOwnProperty.call(source, key)) {\n                            target[key] = source[key];\n                        }\n                    }\n                }\n\n                return target;\n            };\n\n        return _extends.apply(this, arguments);\n    }\n\n    function _objectSpread(target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i] != null ? arguments[i] : {};\n            var ownKeys = Object.keys(source);\n\n            if (typeof Object.getOwnPropertySymbols === 'function') {\n                ownKeys = ownKeys.concat(\n                    Object.getOwnPropertySymbols(source).filter(function(sym) {\n                        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n                    })\n                );\n            }\n\n            ownKeys.forEach(function(key) {\n                _defineProperty(target, key, source[key]);\n            });\n        }\n\n        return target;\n    }\n\n    function _inherits(subClass, superClass) {\n        if (typeof superClass !== 'function' && superClass !== null) {\n            throw new TypeError('Super expression must either be null or a function');\n        }\n\n        subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n                value: subClass,\n                writable: true,\n                configurable: true,\n            },\n        });\n        if (superClass) _setPrototypeOf(subClass, superClass);\n    }\n\n    function _inheritsLoose(subClass, superClass) {\n        subClass.prototype = Object.create(superClass.prototype);\n        subClass.prototype.constructor = subClass;\n        subClass.__proto__ = superClass;\n    }\n\n    function _getPrototypeOf(o) {\n        _getPrototypeOf = Object.setPrototypeOf\n            ? Object.getPrototypeOf\n            : function _getPrototypeOf(o) {\n                  return o.__proto__ || Object.getPrototypeOf(o);\n              };\n        return _getPrototypeOf(o);\n    }\n\n    function _setPrototypeOf(o, p) {\n        _setPrototypeOf =\n            Object.setPrototypeOf ||\n            function _setPrototypeOf(o, p) {\n                o.__proto__ = p;\n                return o;\n            };\n\n        return _setPrototypeOf(o, p);\n    }\n\n    function isNativeReflectConstruct() {\n        if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n        if (Reflect.construct.sham) return false;\n        if (typeof Proxy === 'function') return true;\n\n        try {\n            Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function _construct(Parent, args, Class) {\n        if (isNativeReflectConstruct()) {\n            _construct = Reflect.construct;\n        } else {\n            _construct = function _construct(Parent, args, Class) {\n                var a = [null];\n                a.push.apply(a, args);\n                var Constructor = Function.bind.apply(Parent, a);\n                var instance = new Constructor();\n                if (Class) _setPrototypeOf(instance, Class.prototype);\n                return instance;\n            };\n        }\n\n        return _construct.apply(null, arguments);\n    }\n\n    function _isNativeFunction(fn) {\n        return Function.toString.call(fn).indexOf('[native code]') !== -1;\n    }\n\n    function _wrapNativeSuper(Class) {\n        var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n        _wrapNativeSuper = function _wrapNativeSuper(Class) {\n            if (Class === null || !_isNativeFunction(Class)) return Class;\n\n            if (typeof Class !== 'function') {\n                throw new TypeError('Super expression must either be null or a function');\n            }\n\n            if (typeof _cache !== 'undefined') {\n                if (_cache.has(Class)) return _cache.get(Class);\n\n                _cache.set(Class, Wrapper);\n            }\n\n            function Wrapper() {\n                return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n            }\n\n            Wrapper.prototype = Object.create(Class.prototype, {\n                constructor: {\n                    value: Wrapper,\n                    enumerable: false,\n                    writable: true,\n                    configurable: true,\n                },\n            });\n            return _setPrototypeOf(Wrapper, Class);\n        };\n\n        return _wrapNativeSuper(Class);\n    }\n\n    function _instanceof(left, right) {\n        if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n            return right[Symbol.hasInstance](left);\n        } else {\n            return left instanceof right;\n        }\n    }\n\n    function _interopRequireDefault(obj) {\n        return obj && obj.__esModule\n            ? obj\n            : {\n                  default: obj,\n              };\n    }\n\n    function _interopRequireWildcard(obj) {\n        if (obj && obj.__esModule) {\n            return obj;\n        } else {\n            var newObj = {};\n\n            if (obj != null) {\n                for (var key in obj) {\n                    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                        var desc =\n                            Object.defineProperty && Object.getOwnPropertyDescriptor\n                                ? Object.getOwnPropertyDescriptor(obj, key)\n                                : {};\n\n                        if (desc.get || desc.set) {\n                            Object.defineProperty(newObj, key, desc);\n                        } else {\n                            newObj[key] = obj[key];\n                        }\n                    }\n                }\n            }\n\n            newObj.default = obj;\n            return newObj;\n        }\n    }\n\n    function _newArrowCheck(innerThis, boundThis) {\n        if (innerThis !== boundThis) {\n            throw new TypeError('Cannot instantiate an arrow function');\n        }\n    }\n\n    function _objectDestructuringEmpty(obj) {\n        if (obj == null) throw new TypeError('Cannot destructure undefined');\n    }\n\n    function _objectWithoutPropertiesLoose(source, excluded) {\n        if (source == null) return {};\n        var target = {};\n        var sourceKeys = Object.keys(source);\n        var key, i;\n\n        for (i = 0; i < sourceKeys.length; i++) {\n            key = sourceKeys[i];\n            if (excluded.indexOf(key) >= 0) continue;\n            target[key] = source[key];\n        }\n\n        return target;\n    }\n\n    function _objectWithoutProperties(source, excluded) {\n        if (source == null) return {};\n\n        var target = _objectWithoutPropertiesLoose(source, excluded);\n\n        var key, i;\n\n        if (Object.getOwnPropertySymbols) {\n            var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n            for (i = 0; i < sourceSymbolKeys.length; i++) {\n                key = sourceSymbolKeys[i];\n                if (excluded.indexOf(key) >= 0) continue;\n                if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n                target[key] = source[key];\n            }\n        }\n\n        return target;\n    }\n\n    function _assertThisInitialized(self) {\n        if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        }\n\n        return self;\n    }\n\n    function _possibleConstructorReturn(self, call) {\n        if (call && (typeof call === 'object' || typeof call === 'function')) {\n            return call;\n        }\n\n        return _assertThisInitialized(self);\n    }\n\n    function _superPropBase(object, property) {\n        while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = _getPrototypeOf(object);\n            if (object === null) break;\n        }\n\n        return object;\n    }\n\n    function _get(target, property, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.get) {\n            _get = Reflect.get;\n        } else {\n            _get = function _get(target, property, receiver) {\n                var base = _superPropBase(target, property);\n\n                if (!base) return;\n                var desc = Object.getOwnPropertyDescriptor(base, property);\n\n                if (desc.get) {\n                    return desc.get.call(receiver);\n                }\n\n                return desc.value;\n            };\n        }\n\n        return _get(target, property, receiver || target);\n    }\n\n    function set(target, property, value, receiver) {\n        if (typeof Reflect !== 'undefined' && Reflect.set) {\n            set = Reflect.set;\n        } else {\n            set = function set(target, property, value, receiver) {\n                var base = _superPropBase(target, property);\n\n                var desc;\n\n                if (base) {\n                    desc = Object.getOwnPropertyDescriptor(base, property);\n\n                    if (desc.set) {\n                        desc.set.call(receiver, value);\n                        return true;\n                    } else if (!desc.writable) {\n                        return false;\n                    }\n                }\n\n                desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n                if (desc) {\n                    if (!desc.writable) {\n                        return false;\n                    }\n\n                    desc.value = value;\n                    Object.defineProperty(receiver, property, desc);\n                } else {\n                    _defineProperty(receiver, property, value);\n                }\n\n                return true;\n            };\n        }\n\n        return set(target, property, value, receiver);\n    }\n\n    function _set(target, property, value, receiver, isStrict) {\n        var s = set(target, property, value, receiver || target);\n\n        if (!s && isStrict) {\n            throw new Error('failed to set property');\n        }\n\n        return value;\n    }\n\n    function _taggedTemplateLiteral(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        return Object.freeze(\n            Object.defineProperties(strings, {\n                raw: {\n                    value: Object.freeze(raw),\n                },\n            })\n        );\n    }\n\n    function _taggedTemplateLiteralLoose(strings, raw) {\n        if (!raw) {\n            raw = strings.slice(0);\n        }\n\n        strings.raw = raw;\n        return strings;\n    }\n\n    function _temporalRef(val, name) {\n        if (val === _temporalUndefined) {\n            throw new ReferenceError(name + ' is not defined - temporal dead zone');\n        } else {\n            return val;\n        }\n    }\n\n    function _readOnlyError(name) {\n        throw new Error('\"' + name + '\" is read-only');\n    }\n\n    function _classNameTDZError(name) {\n        throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n    }\n\n    var _temporalUndefined = {};\n\n    function _slicedToArray(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n    }\n\n    function _slicedToArrayLoose(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n    }\n\n    function _toArray(arr) {\n        return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n    }\n\n    function _toConsumableArray(arr) {\n        return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n    }\n\n    function _arrayWithoutHoles(arr) {\n        if (Array.isArray(arr)) {\n            for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n            return arr2;\n        }\n    }\n\n    function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n    }\n\n    function _iterableToArray(iter) {\n        if (\n            Symbol.iterator in Object(iter) ||\n            Object.prototype.toString.call(iter) === '[object Arguments]'\n        )\n            return Array.from(iter);\n    }\n\n    function _iterableToArrayLimit(arr, i) {\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _e = undefined;\n\n        try {\n            for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n                _arr.push(_s.value);\n\n                if (i && _arr.length === i) break;\n            }\n        } catch (err) {\n            _d = true;\n            _e = err;\n        } finally {\n            try {\n                if (!_n && _i['return'] != null) _i['return']();\n            } finally {\n                if (_d) throw _e;\n            }\n        }\n\n        return _arr;\n    }\n\n    function _iterableToArrayLimitLoose(arr, i) {\n        var _arr = [];\n\n        for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done; ) {\n            _arr.push(_step.value);\n\n            if (i && _arr.length === i) break;\n        }\n\n        return _arr;\n    }\n\n    function _nonIterableSpread() {\n        throw new TypeError('Invalid attempt to spread non-iterable instance');\n    }\n\n    function _nonIterableRest() {\n        throw new TypeError('Invalid attempt to destructure non-iterable instance');\n    }\n\n    function _skipFirstGeneratorNext(fn) {\n        return function() {\n            var it = fn.apply(this, arguments);\n            it.next();\n            return it;\n        };\n    }\n\n    function _toPrimitive(input, hint) {\n        if (typeof input !== 'object' || input === null) return input;\n        var prim = input[Symbol.toPrimitive];\n\n        if (prim !== undefined) {\n            var res = prim.call(input, hint || 'default');\n            if (typeof res !== 'object') return res;\n            throw new TypeError('@@toPrimitive must return a primitive value.');\n        }\n\n        return (hint === 'string' ? String : Number)(input);\n    }\n\n    function _toPropertyKey(arg) {\n        var key = _toPrimitive(arg, 'string');\n\n        return typeof key === 'symbol' ? key : String(key);\n    }\n\n    function _initializerWarningHelper(descriptor, context) {\n        throw new Error(\n            'Decorating class property failed. Please ensure that ' +\n                'proposal-class-properties is enabled and set to use loose mode. ' +\n                'To use proposal-class-properties in spec mode with decorators, wait for ' +\n                'the next major version of decorators in stage 2.'\n        );\n    }\n\n    function _initializerDefineProperty(target, property, descriptor, context) {\n        if (!descriptor) return;\n        Object.defineProperty(target, property, {\n            enumerable: descriptor.enumerable,\n            configurable: descriptor.configurable,\n            writable: descriptor.writable,\n            value: descriptor.initializer ? descriptor.initializer.call(context) : void 0,\n        });\n    }\n\n    function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n        var desc = {};\n        Object.keys(descriptor).forEach(function(key) {\n            desc[key] = descriptor[key];\n        });\n        desc.enumerable = !!desc.enumerable;\n        desc.configurable = !!desc.configurable;\n\n        if ('value' in desc || desc.initializer) {\n            desc.writable = true;\n        }\n\n        desc = decorators\n            .slice()\n            .reverse()\n            .reduce(function(desc, decorator) {\n                return decorator(target, property, desc) || desc;\n            }, desc);\n\n        if (context && desc.initializer !== void 0) {\n            desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n            desc.initializer = undefined;\n        }\n\n        if (desc.initializer === void 0) {\n            Object.defineProperty(target, property, desc);\n            desc = null;\n        }\n\n        return desc;\n    }\n\n    var id = 0;\n\n    function _classPrivateFieldLooseKey(name) {\n        return '__private_' + id++ + '_' + name;\n    }\n\n    function _classPrivateFieldLooseBase(receiver, privateKey) {\n        if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n            throw new TypeError('attempted to use private field on non-instance');\n        }\n\n        return receiver;\n    }\n\n    function _classPrivateFieldGet(receiver, privateMap) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        var descriptor = privateMap.get(receiver);\n\n        if (descriptor.get) {\n            return descriptor.get.call(receiver);\n        }\n\n        return descriptor.value;\n    }\n\n    function _classPrivateFieldSet(receiver, privateMap, value) {\n        if (!privateMap.has(receiver)) {\n            throw new TypeError('attempted to set private field on non-instance');\n        }\n\n        var descriptor = privateMap.get(receiver);\n\n        if (descriptor.set) {\n            descriptor.set.call(receiver, value);\n        } else {\n            if (!descriptor.writable) {\n                throw new TypeError('attempted to set read only private field');\n            }\n\n            descriptor.value = value;\n        }\n\n        return value;\n    }\n\n    function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return descriptor.value;\n    }\n\n    function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        if (!descriptor.writable) {\n            throw new TypeError('attempted to set read only private field');\n        }\n\n        descriptor.value = value;\n        return value;\n    }\n\n    function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n        if (receiver !== classConstructor) {\n            throw new TypeError('Private static access of wrong provenance');\n        }\n\n        return method;\n    }\n\n    function _classStaticPrivateMethodSet() {\n        throw new TypeError('attempted to set read only static private field');\n    }\n\n    function _decorate(decorators, factory, superClass, mixins) {\n        var api = _getDecoratorsApi();\n\n        if (mixins) {\n            for (var i = 0; i < mixins.length; i++) {\n                api = mixins[i](api);\n            }\n        }\n\n        var r = factory(function initialize(O) {\n            api.initializeInstanceElements(O, decorated.elements);\n        }, superClass);\n        var decorated = api.decorateClass(\n            _coalesceClassElements(r.d.map(_createElementDescriptor)),\n            decorators\n        );\n        api.initializeClassElements(r.F, decorated.elements);\n        return api.runClassFinishers(r.F, decorated.finishers);\n    }\n\n    function _getDecoratorsApi() {\n        _getDecoratorsApi = function() {\n            return api;\n        };\n\n        var api = {\n            elementsDefinitionOrder: [['method'], ['field']],\n            initializeInstanceElements: function(O, elements) {\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        if (element.kind === kind && element.placement === 'own') {\n                            this.defineClassElement(O, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            initializeClassElements: function(F, elements) {\n                var proto = F.prototype;\n                ['method', 'field'].forEach(function(kind) {\n                    elements.forEach(function(element) {\n                        var placement = element.placement;\n\n                        if (\n                            element.kind === kind &&\n                            (placement === 'static' || placement === 'prototype')\n                        ) {\n                            var receiver = placement === 'static' ? F : proto;\n                            this.defineClassElement(receiver, element);\n                        }\n                    }, this);\n                }, this);\n            },\n            defineClassElement: function(receiver, element) {\n                var descriptor = element.descriptor;\n\n                if (element.kind === 'field') {\n                    var initializer = element.initializer;\n                    descriptor = {\n                        enumerable: descriptor.enumerable,\n                        writable: descriptor.writable,\n                        configurable: descriptor.configurable,\n                        value: initializer === void 0 ? void 0 : initializer.call(receiver),\n                    };\n                }\n\n                Object.defineProperty(receiver, element.key, descriptor);\n            },\n            decorateClass: function(elements, decorators) {\n                var newElements = [];\n                var finishers = [];\n                var placements = {\n                    static: [],\n                    prototype: [],\n                    own: [],\n                };\n                elements.forEach(function(element) {\n                    this.addElementPlacement(element, placements);\n                }, this);\n                elements.forEach(function(element) {\n                    if (!_hasDecorators(element)) return newElements.push(element);\n                    var elementFinishersExtras = this.decorateElement(element, placements);\n                    newElements.push(elementFinishersExtras.element);\n                    newElements.push.apply(newElements, elementFinishersExtras.extras);\n                    finishers.push.apply(finishers, elementFinishersExtras.finishers);\n                }, this);\n\n                if (!decorators) {\n                    return {\n                        elements: newElements,\n                        finishers: finishers,\n                    };\n                }\n\n                var result = this.decorateConstructor(newElements, decorators);\n                finishers.push.apply(finishers, result.finishers);\n                result.finishers = finishers;\n                return result;\n            },\n            addElementPlacement: function(element, placements, silent) {\n                var keys = placements[element.placement];\n\n                if (!silent && keys.indexOf(element.key) !== -1) {\n                    throw new TypeError('Duplicated element (' + element.key + ')');\n                }\n\n                keys.push(element.key);\n            },\n            decorateElement: function(element, placements) {\n                var extras = [];\n                var finishers = [];\n\n                for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n                    var keys = placements[element.placement];\n                    keys.splice(keys.indexOf(element.key), 1);\n                    var elementObject = this.fromElementDescriptor(element);\n                    var elementFinisherExtras = this.toElementFinisherExtras(\n                        (0, decorators[i])(elementObject) || elementObject\n                    );\n                    element = elementFinisherExtras.element;\n                    this.addElementPlacement(element, placements);\n\n                    if (elementFinisherExtras.finisher) {\n                        finishers.push(elementFinisherExtras.finisher);\n                    }\n\n                    var newExtras = elementFinisherExtras.extras;\n\n                    if (newExtras) {\n                        for (var j = 0; j < newExtras.length; j++) {\n                            this.addElementPlacement(newExtras[j], placements);\n                        }\n\n                        extras.push.apply(extras, newExtras);\n                    }\n                }\n\n                return {\n                    element: element,\n                    finishers: finishers,\n                    extras: extras,\n                };\n            },\n            decorateConstructor: function(elements, decorators) {\n                var finishers = [];\n\n                for (var i = decorators.length - 1; i >= 0; i--) {\n                    var obj = this.fromClassDescriptor(elements);\n                    var elementsAndFinisher = this.toClassDescriptor(\n                        (0, decorators[i])(obj) || obj\n                    );\n\n                    if (elementsAndFinisher.finisher !== undefined) {\n                        finishers.push(elementsAndFinisher.finisher);\n                    }\n\n                    if (elementsAndFinisher.elements !== undefined) {\n                        elements = elementsAndFinisher.elements;\n\n                        for (var j = 0; j < elements.length - 1; j++) {\n                            for (var k = j + 1; k < elements.length; k++) {\n                                if (\n                                    elements[j].key === elements[k].key &&\n                                    elements[j].placement === elements[k].placement\n                                ) {\n                                    throw new TypeError(\n                                        'Duplicated element (' + elements[j].key + ')'\n                                    );\n                                }\n                            }\n                        }\n                    }\n                }\n\n                return {\n                    elements: elements,\n                    finishers: finishers,\n                };\n            },\n            fromElementDescriptor: function(element) {\n                var obj = {\n                    kind: element.kind,\n                    key: element.key,\n                    placement: element.placement,\n                    descriptor: element.descriptor,\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                if (element.kind === 'field') obj.initializer = element.initializer;\n                return obj;\n            },\n            toElementDescriptors: function(elementObjects) {\n                if (elementObjects === undefined) return;\n                return _toArray(elementObjects).map(function(elementObject) {\n                    var element = this.toElementDescriptor(elementObject);\n                    this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n                    this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n                    return element;\n                }, this);\n            },\n            toElementDescriptor: function(elementObject) {\n                var kind = String(elementObject.kind);\n\n                if (kind !== 'method' && kind !== 'field') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .kind property must be either \"method\" or' +\n                            ' \"field\", but a decorator created an element descriptor with' +\n                            ' .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                var key = _toPropertyKey(elementObject.key);\n\n                var placement = String(elementObject.placement);\n\n                if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n                    throw new TypeError(\n                        'An element descriptor\\'s .placement property must be one of \"static\",' +\n                            ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n                            ' with .placement \"' +\n                            placement +\n                            '\"'\n                    );\n                }\n\n                var descriptor = elementObject.descriptor;\n                this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n                var element = {\n                    kind: kind,\n                    key: key,\n                    placement: placement,\n                    descriptor: Object.assign({}, descriptor),\n                };\n\n                if (kind !== 'field') {\n                    this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n                } else {\n                    this.disallowProperty(\n                        descriptor,\n                        'get',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'set',\n                        'The property descriptor of a field descriptor'\n                    );\n                    this.disallowProperty(\n                        descriptor,\n                        'value',\n                        'The property descriptor of a field descriptor'\n                    );\n                    element.initializer = elementObject.initializer;\n                }\n\n                return element;\n            },\n            toElementFinisherExtras: function(elementObject) {\n                var element = this.toElementDescriptor(elementObject);\n\n                var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n                var extras = this.toElementDescriptors(elementObject.extras);\n                return {\n                    element: element,\n                    finisher: finisher,\n                    extras: extras,\n                };\n            },\n            fromClassDescriptor: function(elements) {\n                var obj = {\n                    kind: 'class',\n                    elements: elements.map(this.fromElementDescriptor, this),\n                };\n                var desc = {\n                    value: 'Descriptor',\n                    configurable: true,\n                };\n                Object.defineProperty(obj, Symbol.toStringTag, desc);\n                return obj;\n            },\n            toClassDescriptor: function(obj) {\n                var kind = String(obj.kind);\n\n                if (kind !== 'class') {\n                    throw new TypeError(\n                        'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n                            ' created a class descriptor with .kind \"' +\n                            kind +\n                            '\"'\n                    );\n                }\n\n                this.disallowProperty(obj, 'key', 'A class descriptor');\n                this.disallowProperty(obj, 'placement', 'A class descriptor');\n                this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n                this.disallowProperty(obj, 'initializer', 'A class descriptor');\n                this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n                var finisher = _optionalCallableProperty(obj, 'finisher');\n\n                var elements = this.toElementDescriptors(obj.elements);\n                return {\n                    elements: elements,\n                    finisher: finisher,\n                };\n            },\n            runClassFinishers: function(constructor, finishers) {\n                for (var i = 0; i < finishers.length; i++) {\n                    var newConstructor = (0, finishers[i])(constructor);\n\n                    if (newConstructor !== undefined) {\n                        if (typeof newConstructor !== 'function') {\n                            throw new TypeError('Finishers must return a constructor.');\n                        }\n\n                        constructor = newConstructor;\n                    }\n                }\n\n                return constructor;\n            },\n            disallowProperty: function(obj, name, objectType) {\n                if (obj[name] !== undefined) {\n                    throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n                }\n            },\n        };\n        return api;\n    }\n\n    function _createElementDescriptor(def) {\n        var key = _toPropertyKey(def.key);\n\n        var descriptor;\n\n        if (def.kind === 'method') {\n            descriptor = {\n                value: def.value,\n                writable: true,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'get') {\n            descriptor = {\n                get: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'set') {\n            descriptor = {\n                set: def.value,\n                configurable: true,\n                enumerable: false,\n            };\n        } else if (def.kind === 'field') {\n            descriptor = {\n                configurable: true,\n                writable: true,\n                enumerable: true,\n            };\n        }\n\n        var element = {\n            kind: def.kind === 'field' ? 'field' : 'method',\n            key: key,\n            placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n            descriptor: descriptor,\n        };\n        if (def.decorators) element.decorators = def.decorators;\n        if (def.kind === 'field') element.initializer = def.value;\n        return element;\n    }\n\n    function _coalesceGetterSetter(element, other) {\n        if (element.descriptor.get !== undefined) {\n            other.descriptor.get = element.descriptor.get;\n        } else {\n            other.descriptor.set = element.descriptor.set;\n        }\n    }\n\n    function _coalesceClassElements(elements) {\n        var newElements = [];\n\n        var isSameElement = function(other) {\n            return (\n                other.kind === 'method' &&\n                other.key === element.key &&\n                other.placement === element.placement\n            );\n        };\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var other;\n\n            if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n                if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n                    if (_hasDecorators(element) || _hasDecorators(other)) {\n                        throw new ReferenceError(\n                            'Duplicated methods (' + element.key + \") can't be decorated.\"\n                        );\n                    }\n\n                    other.descriptor = element.descriptor;\n                } else {\n                    if (_hasDecorators(element)) {\n                        if (_hasDecorators(other)) {\n                            throw new ReferenceError(\n                                \"Decorators can't be placed on different accessors with for \" +\n                                    'the same property (' +\n                                    element.key +\n                                    ').'\n                            );\n                        }\n\n                        other.decorators = element.decorators;\n                    }\n\n                    _coalesceGetterSetter(element, other);\n                }\n            } else {\n                newElements.push(element);\n            }\n        }\n\n        return newElements;\n    }\n\n    function _hasDecorators(element) {\n        return element.decorators && element.decorators.length;\n    }\n\n    function _isDataDescriptor(desc) {\n        return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n    }\n\n    function _optionalCallableProperty(obj, name) {\n        var value = obj[name];\n\n        if (value !== undefined && typeof value !== 'function') {\n            throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n        }\n\n        return value;\n    }\n\n    function _classPrivateMethodGet(receiver, privateSet, fn) {\n        if (!privateSet.has(receiver)) {\n            throw new TypeError('attempted to get private field on non-instance');\n        }\n\n        return fn;\n    }\n\n    function _classPrivateMethodSet() {\n        throw new TypeError('attempted to reassign private method');\n    }\n\n    function _wrapRegExp(re, groups) {\n        _wrapRegExp = function(re, groups) {\n            return new BabelRegExp(re, groups);\n        };\n\n        var _RegExp = _wrapNativeSuper(RegExp);\n\n        var _super = RegExp.prototype;\n\n        var _groups = new WeakMap();\n\n        function BabelRegExp(re, groups) {\n            var _this = _RegExp.call(this, re);\n\n            _groups.set(_this, groups);\n\n            return _this;\n        }\n\n        _inherits(BabelRegExp, _RegExp);\n\n        BabelRegExp.prototype.exec = function(str) {\n            var result = _super.exec.call(this, str);\n\n            if (result) result.groups = buildGroups(result, this);\n            return result;\n        };\n\n        BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n            if (typeof substitution === 'string') {\n                var groups = _groups.get(this);\n\n                return _super[Symbol.replace].call(\n                    this,\n                    str,\n                    substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n                        return '$' + groups[name];\n                    })\n                );\n            } else if (typeof substitution === 'function') {\n                var _this = this;\n\n                return _super[Symbol.replace].call(this, str, function() {\n                    var args = [];\n                    args.push.apply(args, arguments);\n\n                    if (typeof args[args.length - 1] !== 'object') {\n                        args.push(buildGroups(args, _this));\n                    }\n\n                    return substitution.apply(this, args);\n                });\n            } else {\n                return _super[Symbol.replace].call(this, str, substitution);\n            }\n        };\n\n        function buildGroups(result, re) {\n            var g = _groups.get(re);\n\n            return Object.keys(g).reduce(function(groups, name) {\n                groups[name] = result[g[name]];\n                return groups;\n            }, Object.create(null));\n        }\n\n        return _wrapRegExp.apply(this, arguments);\n    }\n\n    var MARKUP_RECT = ['x', 'y', 'left', 'top', 'right', 'bottom', 'width', 'height'];\n\n    var toOptionalFraction = function toOptionalFraction(value) {\n        return typeof value === 'string' && /%/.test(value) ? parseFloat(value) / 100 : value;\n    };\n\n    // adds default markup properties, clones markup\n    var prepareMarkup = function prepareMarkup(markup) {\n        var _markup = _slicedToArray(markup, 2),\n            type = _markup[0],\n            props = _markup[1];\n\n        var rect = props.points\n            ? {}\n            : MARKUP_RECT.reduce(function(prev, curr) {\n                  prev[curr] = toOptionalFraction(props[curr]);\n                  return prev;\n              }, {});\n\n        return [\n            type,\n            Object.assign(\n                {\n                    zIndex: 0,\n                },\n                props,\n                rect\n            ),\n        ];\n    };\n\n    var getImageSize = function getImageSize(file) {\n        return new Promise(function(resolve, reject) {\n            var imageElement = new Image();\n            imageElement.src = URL.createObjectURL(file);\n\n            // start testing size\n            var measure = function measure() {\n                var width = imageElement.naturalWidth;\n                var height = imageElement.naturalHeight;\n                var hasSize = width && height;\n                if (!hasSize) return;\n\n                URL.revokeObjectURL(imageElement.src);\n                clearInterval(intervalId);\n                resolve({ width: width, height: height });\n            };\n\n            imageElement.onerror = function(err) {\n                URL.revokeObjectURL(imageElement.src);\n                clearInterval(intervalId);\n                reject(err);\n            };\n\n            var intervalId = setInterval(measure, 1);\n\n            measure();\n        });\n    };\n\n    /**\n     * Polyfill Edge and IE when in Browser\n     */\n    if (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n        if (!HTMLCanvasElement.prototype.toBlob) {\n            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n                value: function value(cb, type, quality) {\n                    var canvas = this;\n                    setTimeout(function() {\n                        var dataURL = canvas.toDataURL(type, quality).split(',')[1];\n                        var binStr = atob(dataURL);\n                        var index = binStr.length;\n                        var data = new Uint8Array(index);\n                        while (index--) {\n                            data[index] = binStr.charCodeAt(index);\n                        }\n                        cb(new Blob([data], { type: type || 'image/png' }));\n                    });\n                },\n            });\n        }\n    }\n\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    var isIOS = isBrowser && /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n\n    /**\n     * Image Transform Plugin\n     */\n    var plugin = function plugin(_ref) {\n        var addFilter = _ref.addFilter,\n            utils = _ref.utils;\n        var Type = utils.Type,\n            forin = utils.forin,\n            getFileFromBlob = utils.getFileFromBlob,\n            isFile = utils.isFile;\n\n        /**\n         * Helper functions\n         */\n\n        // valid transforms (in correct order)\n        var TRANSFORM_LIST = ['crop', 'resize', 'filter', 'markup', 'output'];\n\n        var createVariantCreator = function createVariantCreator(updateMetadata) {\n            return function(transform, file, metadata) {\n                return transform(file, updateMetadata ? updateMetadata(metadata) : metadata);\n            };\n        };\n\n        var isDefaultCrop = function isDefaultCrop(crop) {\n            return (\n                crop.aspectRatio === null &&\n                crop.rotation === 0 &&\n                crop.zoom === 1 &&\n                crop.center &&\n                crop.center.x === 0.5 &&\n                crop.center.y === 0.5 &&\n                crop.flip &&\n                crop.flip.horizontal === false &&\n                crop.flip.vertical === false\n            );\n        };\n\n        /**\n         * Filters\n         */\n        addFilter('SHOULD_PREPARE_OUTPUT', function(shouldPrepareOutput, _ref2) {\n            var query = _ref2.query;\n            return new Promise(function(resolve) {\n                // If is not async should prepare now\n                resolve(!query('IS_ASYNC'));\n            });\n        });\n\n        var shouldTransformFile = function shouldTransformFile(query, file, item) {\n            return new Promise(function(resolve) {\n                if (\n                    !query('GET_ALLOW_IMAGE_TRANSFORM') ||\n                    item.archived ||\n                    !isFile(file) ||\n                    !isImage(file)\n                ) {\n                    return resolve(false);\n                }\n\n                // if size can't be read this browser doesn't support image\n                getImageSize(file)\n                    .then(function() {\n                        var fn = query('GET_IMAGE_TRANSFORM_IMAGE_FILTER');\n                        if (fn) {\n                            var filterResult = fn(file);\n                            if (filterResult == null) {\n                                // undefined or null\n                                return handleRevert(true);\n                            }\n                            if (typeof filterResult === 'boolean') {\n                                return resolve(filterResult);\n                            }\n                            if (typeof filterResult.then === 'function') {\n                                return filterResult.then(resolve);\n                            }\n                        }\n\n                        resolve(true);\n                    })\n                    .catch(function(err) {\n                        resolve(false);\n                    });\n            });\n        };\n\n        addFilter('DID_CREATE_ITEM', function(item, _ref3) {\n            var query = _ref3.query,\n                dispatch = _ref3.dispatch;\n            if (!query('GET_ALLOW_IMAGE_TRANSFORM')) return;\n\n            item.extend('requestPrepare', function() {\n                return new Promise(function(resolve, reject) {\n                    dispatch(\n                        'REQUEST_PREPARE_OUTPUT',\n                        {\n                            query: item.id,\n                            item: item,\n                            success: resolve,\n                            failure: reject,\n                        },\n\n                        true\n                    );\n                });\n            });\n        });\n\n        // subscribe to file transformations\n        addFilter('PREPARE_OUTPUT', function(file, _ref4) {\n            var query = _ref4.query,\n                item = _ref4.item;\n            return new Promise(function(resolve) {\n                shouldTransformFile(query, file, item).then(function(shouldTransform) {\n                    // no need to transform, exit\n                    if (!shouldTransform) return resolve(file);\n\n                    // get variants\n                    var variants = [];\n\n                    // add original file\n                    if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL')) {\n                        variants.push(function() {\n                            return new Promise(function(resolve) {\n                                resolve({\n                                    name: query('GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME'),\n                                    file: file,\n                                });\n                            });\n                        });\n                    }\n\n                    // add default output version if output default set to true or if no variants defined\n                    if (query('GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT')) {\n                        variants.push(function(transform, file, metadata) {\n                            return new Promise(function(resolve) {\n                                transform(file, metadata).then(function(file) {\n                                    return resolve({\n                                        name: query('GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME'),\n\n                                        file: file,\n                                    });\n                                });\n                            });\n                        });\n                    }\n\n                    // get other variants\n                    var variantsDefinition = query('GET_IMAGE_TRANSFORM_VARIANTS') || {};\n                    forin(variantsDefinition, function(key, fn) {\n                        var createVariant = createVariantCreator(fn);\n                        variants.push(function(transform, file, metadata) {\n                            return new Promise(function(resolve) {\n                                createVariant(transform, file, metadata).then(function(file) {\n                                    return resolve({ name: key, file: file });\n                                });\n                            });\n                        });\n                    });\n\n                    // output format (quality 0 => 100)\n                    var qualityAsPercentage = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY');\n                    var qualityMode = query('GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE');\n                    var quality = qualityAsPercentage === null ? null : qualityAsPercentage / 100;\n                    var type = query('GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE');\n                    var clientTransforms =\n                        query('GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS') || TRANSFORM_LIST;\n\n                    // update transform metadata object\n                    item.setMetadata(\n                        'output',\n                        {\n                            type: type,\n                            quality: quality,\n                            client: clientTransforms,\n                        },\n\n                        true\n                    );\n\n                    // the function that is used to apply the file transformations\n                    var transform = function transform(file, metadata) {\n                        return new Promise(function(resolve, reject) {\n                            var filteredMetadata = Object.assign({}, metadata);\n\n                            Object.keys(filteredMetadata)\n                                .filter(function(instruction) {\n                                    return instruction !== 'exif';\n                                })\n                                .forEach(function(instruction) {\n                                    // if not in list, remove from object, the instruction will be handled by the server\n                                    if (clientTransforms.indexOf(instruction) === -1) {\n                                        delete filteredMetadata[instruction];\n                                    }\n                                });\n                            var resize = filteredMetadata.resize,\n                                exif = filteredMetadata.exif,\n                                output = filteredMetadata.output,\n                                crop = filteredMetadata.crop,\n                                filter = filteredMetadata.filter,\n                                markup = filteredMetadata.markup;\n\n                            var instructions = {\n                                image: {\n                                    orientation: exif ? exif.orientation : null,\n                                },\n\n                                output:\n                                    output &&\n                                    (output.type ||\n                                        typeof output.quality === 'number' ||\n                                        output.background)\n                                        ? {\n                                              type: output.type,\n                                              quality:\n                                                  typeof output.quality === 'number'\n                                                      ? output.quality * 100\n                                                      : null,\n                                              background:\n                                                  output.background ||\n                                                  query(\n                                                      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n                                                  ) ||\n                                                  null,\n                                          }\n                                        : undefined,\n                                size:\n                                    resize && (resize.size.width || resize.size.height)\n                                        ? Object.assign(\n                                              {\n                                                  mode: resize.mode,\n                                                  upscale: resize.upscale,\n                                              },\n                                              resize.size\n                                          )\n                                        : undefined,\n                                crop:\n                                    crop && !isDefaultCrop(crop)\n                                        ? Object.assign(\n                                              {},\n\n                                              crop\n                                          )\n                                        : undefined,\n                                markup: markup && markup.length ? markup.map(prepareMarkup) : [],\n                                filter: filter,\n                            };\n\n                            if (instructions.output) {\n                                // determine if file type will change\n                                var willChangeType = output.type\n                                    ? // type set\n                                      output.type !== file.type\n                                    : // type not set\n                                      false;\n\n                                var canChangeQuality = /\\/jpe?g$/.test(file.type);\n                                var willChangeQuality =\n                                    output.quality !== null\n                                        ? // quality set\n                                          canChangeQuality && qualityMode === 'always'\n                                        : // quality not set\n                                          false;\n\n                                // determine if file data will be modified\n                                var willModifyImageData = !!(\n                                    instructions.size ||\n                                    instructions.crop ||\n                                    instructions.filter ||\n                                    willChangeType ||\n                                    willChangeQuality\n                                );\n\n                                // if we're not modifying the image data then we don't have to modify the output\n                                if (!willModifyImageData) return resolve(file);\n                            }\n\n                            var options = {\n                                beforeCreateBlob: query('GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB'),\n                                afterCreateBlob: query('GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB'),\n                                canvasMemoryLimit: query('GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT'),\n                                stripImageHead: query(\n                                    'GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD'\n                                ),\n                            };\n\n                            transformImage(file, instructions, options)\n                                .then(function(blob) {\n                                    // set file object\n                                    var out = getFileFromBlob(\n                                        blob,\n                                        // rename the original filename to match the mime type of the output image\n                                        renameFileToMatchMimeType(\n                                            file.name,\n                                            getValidOutputMimeType(blob.type)\n                                        )\n                                    );\n\n                                    resolve(out);\n                                })\n                                .catch(reject);\n                        });\n                    };\n\n                    // start creating variants\n                    var variantPromises = variants.map(function(create) {\n                        return create(transform, file, item.getMetadata());\n                    });\n\n                    // wait for results\n                    Promise.all(variantPromises).then(function(files) {\n                        // if single file object in array, return the single file object else, return array of\n                        resolve(\n                            files.length === 1 && files[0].name === null\n                                ? // return the File object\n                                  files[0].file\n                                : // return an array of files { name:'name', file:File }\n                                  files\n                        );\n                    });\n                });\n            });\n        });\n\n        // Expose plugin options\n        return {\n            options: {\n                allowImageTransform: [true, Type.BOOLEAN],\n\n                // filter images to transform\n                imageTransformImageFilter: [null, Type.FUNCTION],\n\n                // null, 'image/jpeg', 'image/png'\n                imageTransformOutputMimeType: [null, Type.STRING],\n\n                // null, 0 - 100\n                imageTransformOutputQuality: [null, Type.INT],\n\n                // set to false to copy image exif data to output\n                imageTransformOutputStripImageHead: [true, Type.BOOLEAN],\n\n                // only apply transforms in this list\n                imageTransformClientTransforms: [null, Type.ARRAY],\n\n                // only apply output quality when a transform is required\n                imageTransformOutputQualityMode: ['always', Type.STRING],\n                // 'always'\n                // 'optional'\n                // 'mismatch' (future feature, only applied if quality differs from input)\n\n                // get image transform variants\n                imageTransformVariants: [null, Type.OBJECT],\n\n                // should we post the default transformed file\n                imageTransformVariantsIncludeDefault: [true, Type.BOOLEAN],\n\n                // which name to prefix the default transformed file with\n                imageTransformVariantsDefaultName: [null, Type.STRING],\n\n                // should we post the original file\n                imageTransformVariantsIncludeOriginal: [false, Type.BOOLEAN],\n\n                // which name to prefix the original file with\n                imageTransformVariantsOriginalName: ['original_', Type.STRING],\n\n                // called before creating the blob, receives canvas, expects promise resolve with canvas\n                imageTransformBeforeCreateBlob: [null, Type.FUNCTION],\n\n                // expects promise resolved with blob\n                imageTransformAfterCreateBlob: [null, Type.FUNCTION],\n\n                // canvas memory limit\n                imageTransformCanvasMemoryLimit: [\n                    isBrowser && isIOS ? 4096 * 4096 : null,\n                    Type.INT,\n                ],\n\n                // background image of the output canvas\n                imageTransformCanvasBackgroundColor: [null, Type.STRING],\n            },\n        };\n    };\n\n    // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n    if (isBrowser) {\n        document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', { detail: plugin }));\n    }\n\n    return plugin;\n});\n","// utils/filesize.js\nexport function formatFileSize(bytes, decimals = 1) {\n    if (!Number.isFinite(bytes) || bytes < 0) {\n        return '0 B';\n    }\n\n    if (bytes === 0) {\n        return '0 B';\n    }\n\n    //const k = 1024; // Binary (IEC units)  formerly used more often\n    const k = 1000;\n\n    const units = ['B', 'KB', 'MB', 'GB', 'TB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    const size = bytes / Math.pow(k, i);\n    const fixed = size.toFixed(decimals);\n\n    return `${fixed} ${units[i]}`;\n}\n","import { formatFileSize } from './../utils/filesize.js';\n\nexport class FilepondFileSizeValidator {\n    static tags = [\n        {\n            event: 'contao_filepond:process_start',\n            priority: 100,\n        }\n    ];\n\n    async handle(event) {\n        const file = event.file;\n        const options = event.filepondOptions;\n\n        if (!options.allowFileSizeValidation) {\n            return;\n        }\n\n        const minFileSize = Number(options.minFileSize) || 0;\n        const maxFileSize = Number(options.maxFileSize) || 0;\n\n        const filesize = file.size;\n        const filesizeHuman = formatFileSize(filesize);\n        const maxFileSizeHuman = formatFileSize(maxFileSize);\n        const minFileSizeHuman = formatFileSize(minFileSize);\n\n        // Max file size\n        if (maxFileSize && filesize > maxFileSize) {\n            const data = {\n                filesize,\n                filesizeHuman,\n                maxFileSize,\n                maxFileSizeHuman,\n            };\n\n            const message = options.labelMaxFileSizeError.replace(\n                /\\{(\\w+)\\}/g,\n                (_, key) => data[key] ?? `{${key}}`\n            );\n\n            throw new Error(message);\n        }\n\n        // Min file size\n        if (minFileSize && filesize < minFileSize) {\n            const data = {\n                filesize,\n                filesizeHuman,\n                minFileSize,\n                minFileSizeHuman,\n            };\n\n            const message = options.labelMinFileSizeError.replace(\n                /\\{(\\w+)\\}/g,\n                (_, key) => data[key] ?? `{${key}}`\n            );\n\n            throw new Error(message);\n        }\n    }\n}\n\n","/*!\n * FilePondPluginImagePreview 4.6.12\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? (module.exports = factory())\n    : typeof define === 'function' && define.amd\n    ? define(factory)\n    : ((global = global || self),\n      (global.FilePondPluginImagePreview = factory()));\n})(this, function() {\n  'use strict';\n\n  // test if file is of type image and can be viewed in canvas\n  var isPreviewableImage = function isPreviewableImage(file) {\n    return /^image/.test(file.type);\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol.for &&\n          Symbol.for('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol === 'function') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var vectorMultiply = function vectorMultiply(v, amount) {\n    return createVector(v.x * amount, v.y * amount);\n  };\n\n  var vectorAdd = function vectorAdd(a, b) {\n    return createVector(a.x + b.x, a.y + b.y);\n  };\n\n  var vectorNormalize = function vectorNormalize(v) {\n    var l = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (l === 0) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    return createVector(v.x / l, v.y / l);\n  };\n\n  var vectorRotate = function vectorRotate(v, radians, origin) {\n    var cos = Math.cos(radians);\n    var sin = Math.sin(radians);\n    var t = createVector(v.x - origin.x, v.y - origin.y);\n    return createVector(\n      origin.x + cos * t.x - sin * t.y,\n      origin.y + sin * t.x + cos * t.y\n    );\n  };\n\n  var createVector = function createVector() {\n    var x =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    return { x: x, y: y };\n  };\n\n  var getMarkupValue = function getMarkupValue(value, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var axis = arguments.length > 3 ? arguments[3] : undefined;\n    if (typeof value === 'string') {\n      return parseFloat(value) * scalar;\n    }\n    if (typeof value === 'number') {\n      return value * (axis ? size[axis] : Math.min(size.width, size.height));\n    }\n    return;\n  };\n\n  var getMarkupStyles = function getMarkupStyles(markup, size, scale) {\n    var lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n    var fill = markup.backgroundColor || markup.fontColor || 'transparent';\n    var stroke = markup.borderColor || markup.lineColor || 'transparent';\n    var strokeWidth = getMarkupValue(\n      markup.borderWidth || markup.lineWidth,\n      size,\n      scale\n    );\n    var lineCap = markup.lineCap || 'round';\n    var lineJoin = markup.lineJoin || 'round';\n    var dashes =\n      typeof lineStyle === 'string'\n        ? ''\n        : lineStyle\n            .map(function(v) {\n              return getMarkupValue(v, size, scale);\n            })\n            .join(',');\n    var opacity = markup.opacity || 1;\n    return {\n      'stroke-linecap': lineCap,\n      'stroke-linejoin': lineJoin,\n      'stroke-width': strokeWidth || 0,\n      'stroke-dasharray': dashes,\n      stroke: stroke,\n      fill: fill,\n      opacity: opacity\n    };\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  var getMarkupRect = function getMarkupRect(rect, size) {\n    var scalar =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var left =\n      getMarkupValue(rect.x, size, scalar, 'width') ||\n      getMarkupValue(rect.left, size, scalar, 'width');\n    var top =\n      getMarkupValue(rect.y, size, scalar, 'height') ||\n      getMarkupValue(rect.top, size, scalar, 'height');\n    var width = getMarkupValue(rect.width, size, scalar, 'width');\n    var height = getMarkupValue(rect.height, size, scalar, 'height');\n    var right = getMarkupValue(rect.right, size, scalar, 'width');\n    var bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n    if (!isDefined(top)) {\n      if (isDefined(height) && isDefined(bottom)) {\n        top = size.height - height - bottom;\n      } else {\n        top = bottom;\n      }\n    }\n\n    if (!isDefined(left)) {\n      if (isDefined(width) && isDefined(right)) {\n        left = size.width - width - right;\n      } else {\n        left = right;\n      }\n    }\n\n    if (!isDefined(width)) {\n      if (isDefined(left) && isDefined(right)) {\n        width = size.width - left - right;\n      } else {\n        width = 0;\n      }\n    }\n\n    if (!isDefined(height)) {\n      if (isDefined(top) && isDefined(bottom)) {\n        height = size.height - top - bottom;\n      } else {\n        height = 0;\n      }\n    }\n\n    return {\n      x: left || 0,\n      y: top || 0,\n      width: width || 0,\n      height: height || 0\n    };\n  };\n\n  var pointsToPathShape = function pointsToPathShape(points) {\n    return points\n      .map(function(point, index) {\n        return ''\n          .concat(index === 0 ? 'M' : 'L', ' ')\n          .concat(point.x, ' ')\n          .concat(point.y);\n      })\n      .join(' ');\n  };\n\n  var setAttributes = function setAttributes(element, attr) {\n    return Object.keys(attr).forEach(function(key) {\n      return element.setAttribute(key, attr[key]);\n    });\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svg = function svg(tag, attr) {\n    var element = document.createElementNS(ns, tag);\n    if (attr) {\n      setAttributes(element, attr);\n    }\n    return element;\n  };\n\n  var updateRect = function updateRect(element) {\n    return setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles)\n    );\n  };\n\n  var updateEllipse = function updateEllipse(element) {\n    var cx = element.rect.x + element.rect.width * 0.5;\n    var cy = element.rect.y + element.rect.height * 0.5;\n    var rx = element.rect.width * 0.5;\n    var ry = element.rect.height * 0.5;\n    return setAttributes(\n      element,\n      Object.assign(\n        {\n          cx: cx,\n          cy: cy,\n          rx: rx,\n          ry: ry\n        },\n        element.styles\n      )\n    );\n  };\n\n  var IMAGE_FIT_STYLE = {\n    contain: 'xMidYMid meet',\n    cover: 'xMidYMid slice'\n  };\n\n  var updateImage = function updateImage(element, markup) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n      })\n    );\n  };\n\n  var TEXT_ANCHOR = {\n    left: 'start',\n    center: 'middle',\n    right: 'end'\n  };\n\n  var updateText = function updateText(element, markup, size, scale) {\n    var fontSize = getMarkupValue(markup.fontSize, size, scale);\n    var fontFamily = markup.fontFamily || 'sans-serif';\n    var fontWeight = markup.fontWeight || 'normal';\n    var textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        'stroke-width': 0,\n        'font-weight': fontWeight,\n        'font-size': fontSize,\n        'font-family': fontFamily,\n        'text-anchor': textAlign\n      })\n    );\n\n    // update text\n    if (element.text !== markup.text) {\n      element.text = markup.text;\n      element.textContent = markup.text.length ? markup.text : ' ';\n    }\n  };\n\n  var updateLine = function updateLine(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.rect, element.styles, {\n        fill: 'none'\n      })\n    );\n\n    var line = element.childNodes[0];\n    var begin = element.childNodes[1];\n    var end = element.childNodes[2];\n\n    var origin = element.rect;\n\n    var target = {\n      x: element.rect.x + element.rect.width,\n      y: element.rect.y + element.rect.height\n    };\n\n    setAttributes(line, {\n      x1: origin.x,\n      y1: origin.y,\n      x2: target.x,\n      y2: target.y\n    });\n\n    if (!markup.lineDecoration) return;\n\n    begin.style.display = 'none';\n    end.style.display = 'none';\n\n    var v = vectorNormalize({\n      x: target.x - origin.x,\n      y: target.y - origin.y\n    });\n\n    var l = getMarkupValue(0.05, size, scale);\n\n    if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n      var arrowBeginRotationPoint = vectorMultiply(v, l);\n      var arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n      var arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n      var arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n      setAttributes(begin, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowBeginA.x, ',')\n          .concat(arrowBeginA.y, ' L')\n          .concat(origin.x, ',')\n          .concat(origin.y, ' L')\n          .concat(arrowBeginB.x, ',')\n          .concat(arrowBeginB.y)\n      });\n    }\n\n    if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n      var arrowEndRotationPoint = vectorMultiply(v, -l);\n      var arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n      var arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n      var arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n      setAttributes(end, {\n        style: 'display:block;',\n        d: 'M'\n          .concat(arrowEndA.x, ',')\n          .concat(arrowEndA.y, ' L')\n          .concat(target.x, ',')\n          .concat(target.y, ' L')\n          .concat(arrowEndB.x, ',')\n          .concat(arrowEndB.y)\n      });\n    }\n  };\n\n  var updatePath = function updatePath(element, markup, size, scale) {\n    setAttributes(\n      element,\n      Object.assign({}, element.styles, {\n        fill: 'none',\n        d: pointsToPathShape(\n          markup.points.map(function(point) {\n            return {\n              x: getMarkupValue(point.x, size, scale, 'width'),\n              y: getMarkupValue(point.y, size, scale, 'height')\n            };\n          })\n        )\n      })\n    );\n  };\n\n  var createShape = function createShape(node) {\n    return function(markup) {\n      return svg(node, { id: markup.id });\n    };\n  };\n\n  var createImage = function createImage(markup) {\n    var shape = svg('image', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round',\n      opacity: '0'\n    });\n\n    shape.onload = function() {\n      shape.setAttribute('opacity', markup.opacity || 1);\n    };\n    shape.setAttributeNS(\n      'http://www.w3.org/1999/xlink',\n      'xlink:href',\n      markup.src\n    );\n    return shape;\n  };\n\n  var createLine = function createLine(markup) {\n    var shape = svg('g', {\n      id: markup.id,\n      'stroke-linecap': 'round',\n      'stroke-linejoin': 'round'\n    });\n\n    var line = svg('line');\n    shape.appendChild(line);\n\n    var begin = svg('path');\n    shape.appendChild(begin);\n\n    var end = svg('path');\n    shape.appendChild(end);\n\n    return shape;\n  };\n\n  var CREATE_TYPE_ROUTES = {\n    image: createImage,\n    rect: createShape('rect'),\n    ellipse: createShape('ellipse'),\n    text: createShape('text'),\n    path: createShape('path'),\n    line: createLine\n  };\n\n  var UPDATE_TYPE_ROUTES = {\n    rect: updateRect,\n    ellipse: updateEllipse,\n    image: updateImage,\n    text: updateText,\n    path: updatePath,\n    line: updateLine\n  };\n\n  var createMarkupByType = function createMarkupByType(type, markup) {\n    return CREATE_TYPE_ROUTES[type](markup);\n  };\n\n  var updateMarkupByType = function updateMarkupByType(\n    element,\n    type,\n    markup,\n    size,\n    scale\n  ) {\n    if (type !== 'path') {\n      element.rect = getMarkupRect(markup, size, scale);\n    }\n    element.styles = getMarkupStyles(markup, size, scale);\n    UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n  };\n\n  var MARKUP_RECT = [\n    'x',\n    'y',\n    'left',\n    'top',\n    'right',\n    'bottom',\n    'width',\n    'height'\n  ];\n\n  var toOptionalFraction = function toOptionalFraction(value) {\n    return typeof value === 'string' && /%/.test(value)\n      ? parseFloat(value) / 100\n      : value;\n  };\n\n  // adds default markup properties, clones markup\n  var prepareMarkup = function prepareMarkup(markup) {\n    var _markup = _slicedToArray(markup, 2),\n      type = _markup[0],\n      props = _markup[1];\n\n    var rect = props.points\n      ? {}\n      : MARKUP_RECT.reduce(function(prev, curr) {\n          prev[curr] = toOptionalFraction(props[curr]);\n          return prev;\n        }, {});\n\n    return [\n      type,\n      Object.assign(\n        {\n          zIndex: 0\n        },\n        props,\n        rect\n      )\n    ];\n  };\n\n  var sortMarkupByZIndex = function sortMarkupByZIndex(a, b) {\n    if (a[1].zIndex > b[1].zIndex) {\n      return 1;\n    }\n    if (a[1].zIndex < b[1].zIndex) {\n      return -1;\n    }\n    return 0;\n  };\n\n  var createMarkupView = function createMarkupView(_) {\n    return _.utils.createView({\n      name: 'image-preview-markup',\n      tag: 'svg',\n      ignoreRect: true,\n      mixins: {\n        apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n      },\n\n      write: function write(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n\n        if (!props.dirty) return;\n        var crop = props.crop,\n          resize = props.resize,\n          markup = props.markup;\n\n        var viewWidth = props.width;\n        var viewHeight = props.height;\n\n        var cropWidth = crop.width;\n        var cropHeight = crop.height;\n\n        if (resize) {\n          var _size = resize.size;\n\n          var outputWidth = _size && _size.width;\n          var outputHeight = _size && _size.height;\n          var outputFit = resize.mode;\n          var outputUpscale = resize.upscale;\n\n          if (outputWidth && !outputHeight) outputHeight = outputWidth;\n          if (outputHeight && !outputWidth) outputWidth = outputHeight;\n\n          var shouldUpscale =\n            cropWidth < outputWidth && cropHeight < outputHeight;\n\n          if (!shouldUpscale || (shouldUpscale && outputUpscale)) {\n            var scalarWidth = outputWidth / cropWidth;\n            var scalarHeight = outputHeight / cropHeight;\n\n            if (outputFit === 'force') {\n              cropWidth = outputWidth;\n              cropHeight = outputHeight;\n            } else {\n              var scalar;\n              if (outputFit === 'cover') {\n                scalar = Math.max(scalarWidth, scalarHeight);\n              } else if (outputFit === 'contain') {\n                scalar = Math.min(scalarWidth, scalarHeight);\n              }\n              cropWidth = cropWidth * scalar;\n              cropHeight = cropHeight * scalar;\n            }\n          }\n        }\n\n        var size = {\n          width: viewWidth,\n          height: viewHeight\n        };\n\n        root.element.setAttribute('width', size.width);\n        root.element.setAttribute('height', size.height);\n\n        var scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n        // clear\n        root.element.innerHTML = '';\n\n        // get filter\n        var markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n        // draw new\n        markup\n          .filter(markupFilter)\n          .map(prepareMarkup)\n          .sort(sortMarkupByZIndex)\n          .forEach(function(markup) {\n            var _markup = _slicedToArray(markup, 2),\n              type = _markup[0],\n              settings = _markup[1];\n\n            // create\n            var element = createMarkupByType(type, settings);\n\n            // update\n            updateMarkupByType(element, type, settings, size, scale);\n\n            // add\n            root.element.appendChild(element);\n          });\n      }\n    });\n  };\n\n  var createVector$1 = function createVector(x, y) {\n    return { x: x, y: y };\n  };\n\n  var vectorDot = function vectorDot(a, b) {\n    return a.x * b.x + a.y * b.y;\n  };\n\n  var vectorSubtract = function vectorSubtract(a, b) {\n    return createVector$1(a.x - b.x, a.y - b.y);\n  };\n\n  var vectorDistanceSquared = function vectorDistanceSquared(a, b) {\n    return vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n  };\n\n  var vectorDistance = function vectorDistance(a, b) {\n    return Math.sqrt(vectorDistanceSquared(a, b));\n  };\n\n  var getOffsetPointOnEdge = function getOffsetPointOnEdge(length, rotation) {\n    var a = length;\n\n    var A = 1.5707963267948966;\n    var B = rotation;\n    var C = 1.5707963267948966 - rotation;\n\n    var sinA = Math.sin(A);\n    var sinB = Math.sin(B);\n    var sinC = Math.sin(C);\n    var cosC = Math.cos(C);\n    var ratio = a / sinA;\n    var b = ratio * sinB;\n    var c = ratio * sinC;\n\n    return createVector$1(cosC * b, cosC * c);\n  };\n\n  var getRotatedRectSize = function getRotatedRectSize(rect, rotation) {\n    var w = rect.width;\n    var h = rect.height;\n\n    var hor = getOffsetPointOnEdge(w, rotation);\n    var ver = getOffsetPointOnEdge(h, rotation);\n\n    var tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n    var tr = createVector$1(\n      rect.x + rect.width + Math.abs(ver.y),\n      rect.y + Math.abs(ver.x)\n    );\n\n    var bl = createVector$1(\n      rect.x - Math.abs(ver.y),\n      rect.y + rect.height - Math.abs(ver.x)\n    );\n\n    return {\n      width: vectorDistance(tl, tr),\n      height: vectorDistance(tl, bl)\n    };\n  };\n\n  var calculateCanvasSize = function calculateCanvasSize(\n    image,\n    canvasAspectRatio\n  ) {\n    var zoom =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n    var imageAspectRatio = image.height / image.width;\n\n    // determine actual pixels on x and y axis\n    var canvasWidth = 1;\n    var canvasHeight = canvasAspectRatio;\n    var imgWidth = 1;\n    var imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n      imgHeight = canvasHeight;\n      imgWidth = imgHeight / imageAspectRatio;\n    }\n\n    var scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    var width = image.width / (zoom * scalar * imgWidth);\n    var height = width * canvasAspectRatio;\n\n    return {\n      width: width,\n      height: height\n    };\n  };\n\n  var getImageRectZoomFactor = function getImageRectZoomFactor(\n    imageRect,\n    cropRect,\n    rotation,\n    center\n  ) {\n    // calculate available space round image center position\n    var cx = center.x > 0.5 ? 1 - center.x : center.x;\n    var cy = center.y > 0.5 ? 1 - center.y : center.y;\n    var imageWidth = cx * 2 * imageRect.width;\n    var imageHeight = cy * 2 * imageRect.height;\n\n    // calculate rotated crop rectangle size\n    var rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n    // calculate scalar required to fit image\n    return Math.max(\n      rotatedCropSize.width / imageWidth,\n      rotatedCropSize.height / imageHeight\n    );\n  };\n\n  var getCenteredCropRect = function getCenteredCropRect(\n    container,\n    aspectRatio\n  ) {\n    var width = container.width;\n    var height = width * aspectRatio;\n    if (height > container.height) {\n      height = container.height;\n      width = height / aspectRatio;\n    }\n    var x = (container.width - width) * 0.5;\n    var y = (container.height - height) * 0.5;\n\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var getCurrentCropSize = function getCurrentCropSize(imageSize) {\n    var crop =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var zoom = crop.zoom,\n      rotation = crop.rotation,\n      center = crop.center,\n      aspectRatio = crop.aspectRatio;\n\n    if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n\n    var canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n    var canvasCenter = {\n      x: canvasSize.width * 0.5,\n      y: canvasSize.height * 0.5\n    };\n\n    var stage = {\n      x: 0,\n      y: 0,\n      width: canvasSize.width,\n      height: canvasSize.height,\n      center: canvasCenter\n    };\n\n    var shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n    var stageZoomFactor = getImageRectZoomFactor(\n      imageSize,\n      getCenteredCropRect(stage, aspectRatio),\n      rotation,\n      shouldLimit ? center : { x: 0.5, y: 0.5 }\n    );\n\n    var scale = zoom * stageZoomFactor;\n\n    // start drawing\n    return {\n      widthFloat: canvasSize.width / scale,\n      heightFloat: canvasSize.height / scale,\n      width: Math.round(canvasSize.width / scale),\n      height: Math.round(canvasSize.height / scale)\n    };\n  };\n\n  var IMAGE_SCALE_SPRING_PROPS = {\n    type: 'spring',\n    stiffness: 0.5,\n    damping: 0.45,\n    mass: 10\n  };\n\n  // does horizontal and vertical flipping\n  var createBitmapView = function createBitmapView(_) {\n    return _.utils.createView({\n      name: 'image-bitmap',\n      ignoreRect: true,\n      mixins: { styles: ['scaleX', 'scaleY'] },\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        root.appendChild(props.image);\n      }\n    });\n  };\n\n  // shifts and rotates image\n  var createImageCanvasWrapper = function createImageCanvasWrapper(_) {\n    return _.utils.createView({\n      name: 'image-canvas-wrapper',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['crop', 'width', 'height'],\n\n        styles: [\n          'originX',\n          'originY',\n          'translateX',\n          'translateY',\n          'scaleX',\n          'scaleY',\n          'rotateZ'\n        ],\n\n        animations: {\n          originX: IMAGE_SCALE_SPRING_PROPS,\n          originY: IMAGE_SCALE_SPRING_PROPS,\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateX: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          rotateZ: IMAGE_SCALE_SPRING_PROPS\n        }\n      },\n\n      create: function create(_ref2) {\n        var root = _ref2.root,\n          props = _ref2.props;\n        props.width = props.image.width;\n        props.height = props.image.height;\n        root.ref.bitmap = root.appendChildView(\n          root.createChildView(createBitmapView(_), { image: props.image })\n        );\n      },\n      write: function write(_ref3) {\n        var root = _ref3.root,\n          props = _ref3.props;\n        var flip = props.crop.flip;\n        var bitmap = root.ref.bitmap;\n        bitmap.scaleX = flip.horizontal ? -1 : 1;\n        bitmap.scaleY = flip.vertical ? -1 : 1;\n      }\n    });\n  };\n\n  // clips canvas to correct aspect ratio\n  var createClipView = function createClipView(_) {\n    return _.utils.createView({\n      name: 'image-clip',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: [\n          'crop',\n          'markup',\n          'resize',\n          'width',\n          'height',\n          'dirty',\n          'background'\n        ],\n\n        styles: ['width', 'height', 'opacity'],\n        animations: {\n          opacity: { type: 'tween', duration: 250 }\n        }\n      },\n\n      didWriteView: function didWriteView(_ref4) {\n        var root = _ref4.root,\n          props = _ref4.props;\n        if (!props.background) return;\n        root.element.style.backgroundColor = props.background;\n      },\n      create: function create(_ref5) {\n        var root = _ref5.root,\n          props = _ref5.props;\n\n        root.ref.image = root.appendChildView(\n          root.createChildView(\n            createImageCanvasWrapper(_),\n            Object.assign({}, props)\n          )\n        );\n\n        root.ref.createMarkup = function() {\n          if (root.ref.markup) return;\n          root.ref.markup = root.appendChildView(\n            root.createChildView(createMarkupView(_), Object.assign({}, props))\n          );\n        };\n\n        root.ref.destroyMarkup = function() {\n          if (!root.ref.markup) return;\n          root.removeChildView(root.ref.markup);\n          root.ref.markup = null;\n        };\n\n        // set up transparency grid\n        var transparencyIndicator = root.query(\n          'GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR'\n        );\n        if (transparencyIndicator === null) return;\n\n        // grid pattern\n        if (transparencyIndicator === 'grid') {\n          root.element.dataset.transparencyIndicator = transparencyIndicator;\n        }\n        // basic color\n        else {\n          root.element.dataset.transparencyIndicator = 'color';\n        }\n      },\n      write: function write(_ref6) {\n        var root = _ref6.root,\n          props = _ref6.props,\n          shouldOptimize = _ref6.shouldOptimize;\n        var crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty,\n          width = props.width,\n          height = props.height;\n\n        root.ref.image.crop = crop;\n\n        var stage = {\n          x: 0,\n          y: 0,\n          width: width,\n          height: height,\n          center: {\n            x: width * 0.5,\n            y: height * 0.5\n          }\n        };\n\n        var image = {\n          width: root.ref.image.width,\n          height: root.ref.image.height\n        };\n\n        var origin = {\n          x: crop.center.x * image.width,\n          y: crop.center.y * image.height\n        };\n\n        var translation = {\n          x: stage.center.x - image.width * crop.center.x,\n          y: stage.center.y - image.height * crop.center.y\n        };\n\n        var rotation = Math.PI * 2 + (crop.rotation % (Math.PI * 2));\n\n        var cropAspectRatio = crop.aspectRatio || image.height / image.width;\n\n        var shouldLimit =\n          typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n        var stageZoomFactor = getImageRectZoomFactor(\n          image,\n          getCenteredCropRect(stage, cropAspectRatio),\n\n          rotation,\n          shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n        );\n\n        var scale = crop.zoom * stageZoomFactor;\n\n        // update markup view\n        if (markup && markup.length) {\n          root.ref.createMarkup();\n          root.ref.markup.width = width;\n          root.ref.markup.height = height;\n          root.ref.markup.resize = resize;\n          root.ref.markup.dirty = dirty;\n          root.ref.markup.markup = markup;\n          root.ref.markup.crop = getCurrentCropSize(image, crop);\n        } else if (root.ref.markup) {\n          root.ref.destroyMarkup();\n        }\n\n        // update image view\n        var imageView = root.ref.image;\n\n        // don't update clip layout\n        if (shouldOptimize) {\n          imageView.originX = null;\n          imageView.originY = null;\n          imageView.translateX = null;\n          imageView.translateY = null;\n          imageView.rotateZ = null;\n          imageView.scaleX = null;\n          imageView.scaleY = null;\n          return;\n        }\n\n        imageView.originX = origin.x;\n        imageView.originY = origin.y;\n        imageView.translateX = translation.x;\n        imageView.translateY = translation.y;\n        imageView.rotateZ = rotation;\n        imageView.scaleX = scale;\n        imageView.scaleY = scale;\n      }\n    });\n  };\n\n  var createImageView = function createImageView(_) {\n    return _.utils.createView({\n      name: 'image-preview',\n      tag: 'div',\n      ignoreRect: true,\n      mixins: {\n        apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n\n        styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n\n        animations: {\n          scaleX: IMAGE_SCALE_SPRING_PROPS,\n          scaleY: IMAGE_SCALE_SPRING_PROPS,\n          translateY: IMAGE_SCALE_SPRING_PROPS,\n          opacity: { type: 'tween', duration: 400 }\n        }\n      },\n\n      create: function create(_ref7) {\n        var root = _ref7.root,\n          props = _ref7.props;\n        root.ref.clip = root.appendChildView(\n          root.createChildView(createClipView(_), {\n            id: props.id,\n            image: props.image,\n            crop: props.crop,\n            markup: props.markup,\n            resize: props.resize,\n            dirty: props.dirty,\n            background: props.background\n          })\n        );\n      },\n      write: function write(_ref8) {\n        var root = _ref8.root,\n          props = _ref8.props,\n          shouldOptimize = _ref8.shouldOptimize;\n        var clip = root.ref.clip;\n        var image = props.image,\n          crop = props.crop,\n          markup = props.markup,\n          resize = props.resize,\n          dirty = props.dirty;\n\n        clip.crop = crop;\n        clip.markup = markup;\n        clip.resize = resize;\n        clip.dirty = dirty;\n\n        // don't update clip layout\n        clip.opacity = shouldOptimize ? 0 : 1;\n\n        // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n        if (shouldOptimize || root.rect.element.hidden) return;\n\n        // calculate scaled preview image size\n        var imageAspectRatio = image.height / image.width;\n        var aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n        // calculate container size\n        var containerWidth = root.rect.inner.width;\n        var containerHeight = root.rect.inner.height;\n\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n        if (panelAspectRatio && !allowMultiple) {\n          fixedPreviewHeight = containerWidth * panelAspectRatio;\n          aspectRatio = panelAspectRatio;\n        }\n\n        // determine clip width and height\n        var clipHeight =\n          fixedPreviewHeight !== null\n            ? fixedPreviewHeight\n            : Math.max(\n                minPreviewHeight,\n                Math.min(containerWidth * aspectRatio, maxPreviewHeight)\n              );\n\n        var clipWidth = clipHeight / aspectRatio;\n        if (clipWidth > containerWidth) {\n          clipWidth = containerWidth;\n          clipHeight = clipWidth * aspectRatio;\n        }\n\n        if (clipHeight > containerHeight) {\n          clipHeight = containerHeight;\n          clipWidth = containerHeight / aspectRatio;\n        }\n\n        clip.width = clipWidth;\n        clip.height = clipHeight;\n      }\n    });\n  };\n\n  var SVG_MASK =\n    '<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\\n    <defs>\\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\\n            <stop offset=\\'50%\\' stop-color=\\'#000000\\'/>\\n            <stop offset=\\'56%\\' stop-color=\\'#0a0a0a\\'/>\\n            <stop offset=\\'63%\\' stop-color=\\'#262626\\'/>\\n            <stop offset=\\'69%\\' stop-color=\\'#4f4f4f\\'/>\\n            <stop offset=\\'75%\\' stop-color=\\'#808080\\'/>\\n            <stop offset=\\'81%\\' stop-color=\\'#b1b1b1\\'/>\\n            <stop offset=\\'88%\\' stop-color=\\'#dadada\\'/>\\n            <stop offset=\\'94%\\' stop-color=\\'#f6f6f6\\'/>\\n            <stop offset=\\'100%\\' stop-color=\\'#ffffff\\'/>\\n        </radialGradient>\\n        <mask id=\"mask-__UID__\">\\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\\n        </mask>\\n    </defs>\\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\\n</svg>';\n\n  var SVGMaskUniqueId = 0;\n\n  var createImageOverlayView = function createImageOverlayView(fpAPI) {\n    return fpAPI.utils.createView({\n      name: 'image-preview-overlay',\n      tag: 'div',\n      ignoreRect: true,\n      create: function create(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var mask = SVG_MASK;\n        if (document.querySelector('base')) {\n          var url = new URL(\n            window.location.href.replace(window.location.hash, '')\n          ).href;\n          mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n        }\n\n        SVGMaskUniqueId++;\n        root.element.classList.add(\n          'filepond--image-preview-overlay-'.concat(props.status)\n        );\n\n        root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n      },\n      mixins: {\n        styles: ['opacity'],\n        animations: {\n          opacity: { type: 'spring', mass: 25 }\n        }\n      }\n    });\n  };\n\n  /**\n   * Bitmap Worker\n   */\n  var BitmapWorker = function BitmapWorker() {\n    self.onmessage = function(e) {\n      createImageBitmap(e.data.message.file).then(function(bitmap) {\n        self.postMessage({ id: e.data.id, message: bitmap }, [bitmap]);\n      });\n    };\n  };\n\n  /**\n   * ColorMatrix Worker\n   */\n  var ColorMatrixWorker = function ColorMatrixWorker() {\n    self.onmessage = function(e) {\n      var imageData = e.data.message.imageData;\n      var matrix = e.data.message.colorMatrix;\n\n      var data = imageData.data;\n      var l = data.length;\n\n      var m11 = matrix[0];\n      var m12 = matrix[1];\n      var m13 = matrix[2];\n      var m14 = matrix[3];\n      var m15 = matrix[4];\n\n      var m21 = matrix[5];\n      var m22 = matrix[6];\n      var m23 = matrix[7];\n      var m24 = matrix[8];\n      var m25 = matrix[9];\n\n      var m31 = matrix[10];\n      var m32 = matrix[11];\n      var m33 = matrix[12];\n      var m34 = matrix[13];\n      var m35 = matrix[14];\n\n      var m41 = matrix[15];\n      var m42 = matrix[16];\n      var m43 = matrix[17];\n      var m44 = matrix[18];\n      var m45 = matrix[19];\n\n      var index = 0,\n        r = 0.0,\n        g = 0.0,\n        b = 0.0,\n        a = 0.0;\n\n      for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        data[index] = Math.max(\n          0,\n          Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255)\n        );\n        data[index + 1] = Math.max(\n          0,\n          Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255)\n        );\n        data[index + 2] = Math.max(\n          0,\n          Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255)\n        );\n        data[index + 3] = Math.max(\n          0,\n          Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255)\n        );\n      }\n\n      self.postMessage({ id: e.data.id, message: imageData }, [\n        imageData.data.buffer\n      ]);\n    };\n  };\n\n  var getImageSize = function getImageSize(url, cb) {\n    var image = new Image();\n    image.onload = function() {\n      var width = image.naturalWidth;\n      var height = image.naturalHeight;\n      image = null;\n      cb(width, height);\n    };\n    image.src = url;\n  };\n\n  var transforms = {\n    1: function _() {\n      return [1, 0, 0, 1, 0, 0];\n    },\n    2: function _(width) {\n      return [-1, 0, 0, 1, width, 0];\n    },\n    3: function _(width, height) {\n      return [-1, 0, 0, -1, width, height];\n    },\n    4: function _(width, height) {\n      return [1, 0, 0, -1, 0, height];\n    },\n    5: function _() {\n      return [0, 1, 1, 0, 0, 0];\n    },\n    6: function _(width, height) {\n      return [0, 1, -1, 0, height, 0];\n    },\n    7: function _(width, height) {\n      return [0, -1, -1, 0, height, width];\n    },\n    8: function _(width) {\n      return [0, -1, 1, 0, 0, width];\n    }\n  };\n\n  var fixImageOrientation = function fixImageOrientation(\n    ctx,\n    width,\n    height,\n    orientation\n  ) {\n    // no orientation supplied\n    if (orientation === -1) {\n      return;\n    }\n\n    ctx.transform.apply(ctx, transforms[orientation](width, height));\n  };\n\n  // draws the preview image to canvas\n  var createPreviewImage = function createPreviewImage(\n    data,\n    width,\n    height,\n    orientation\n  ) {\n    // can't draw on half pixels\n    width = Math.round(width);\n    height = Math.round(height);\n\n    // draw image\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d');\n\n    // if is rotated incorrectly swap width and height\n    if (orientation >= 5 && orientation <= 8) {\n      var _ref = [height, width];\n      width = _ref[0];\n      height = _ref[1];\n    }\n\n    // correct image orientation\n    fixImageOrientation(ctx, width, height, orientation);\n\n    // draw the image\n    ctx.drawImage(data, 0, 0, width, height);\n\n    return canvas;\n  };\n\n  var isBitmap = function isBitmap(file) {\n    return /^image/.test(file.type) && !/svg/.test(file.type);\n  };\n\n  var MAX_WIDTH = 10;\n  var MAX_HEIGHT = 10;\n\n  var calculateAverageColor = function calculateAverageColor(image) {\n    var scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n    var width = (canvas.width = Math.ceil(image.width * scalar));\n    var height = (canvas.height = Math.ceil(image.height * scalar));\n    ctx.drawImage(image, 0, 0, width, height);\n    var data = null;\n    try {\n      data = ctx.getImageData(0, 0, width, height).data;\n    } catch (e) {\n      return null;\n    }\n    var l = data.length;\n\n    var r = 0;\n    var g = 0;\n    var b = 0;\n    var i = 0;\n\n    for (; i < l; i += 4) {\n      r += data[i] * data[i];\n      g += data[i + 1] * data[i + 1];\n      b += data[i + 2] * data[i + 2];\n    }\n\n    r = averageColor(r, l);\n    g = averageColor(g, l);\n    b = averageColor(b, l);\n\n    return { r: r, g: g, b: b };\n  };\n\n  var averageColor = function averageColor(c, l) {\n    return Math.floor(Math.sqrt(c / (l / 4)));\n  };\n\n  var cloneCanvas = function cloneCanvas(origin, target) {\n    target = target || document.createElement('canvas');\n    target.width = origin.width;\n    target.height = origin.height;\n    var ctx = target.getContext('2d');\n    ctx.drawImage(origin, 0, 0);\n    return target;\n  };\n\n  var cloneImageData = function cloneImageData(imageData) {\n    var id;\n    try {\n      id = new ImageData(imageData.width, imageData.height);\n    } catch (e) {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n      id = ctx.createImageData(imageData.width, imageData.height);\n    }\n    id.data.set(new Uint8ClampedArray(imageData.data));\n    return id;\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var createImageWrapperView = function createImageWrapperView(_) {\n    // create overlay view\n    var OverlayView = createImageOverlayView(_);\n\n    var ImageView = createImageView(_);\n    var createWorker = _.utils.createWorker;\n\n    var applyFilter = function applyFilter(root, filter, target) {\n      return new Promise(function(resolve) {\n        // will store image data for future filter updates\n        if (!root.ref.imageData) {\n          root.ref.imageData = target\n            .getContext('2d')\n            .getImageData(0, 0, target.width, target.height);\n        }\n\n        // get image data reference\n        var imageData = cloneImageData(root.ref.imageData);\n\n        if (!filter || filter.length !== 20) {\n          target.getContext('2d').putImageData(imageData, 0, 0);\n          return resolve();\n        }\n\n        var worker = createWorker(ColorMatrixWorker);\n        worker.post(\n          {\n            imageData: imageData,\n            colorMatrix: filter\n          },\n\n          function(response) {\n            // apply filtered colors\n            target.getContext('2d').putImageData(response, 0, 0);\n\n            // stop worker\n            worker.terminate();\n\n            // done!\n            resolve();\n          },\n          [imageData.data.buffer]\n        );\n      });\n    };\n\n    var removeImageView = function removeImageView(root, imageView) {\n      root.removeChildView(imageView);\n      imageView.image.width = 1;\n      imageView.image.height = 1;\n      imageView._destroy();\n    };\n\n    // remove an image\n    var shiftImage = function shiftImage(_ref) {\n      var root = _ref.root;\n      var imageView = root.ref.images.shift();\n      imageView.opacity = 0;\n      imageView.translateY = -15;\n      root.ref.imageViewBin.push(imageView);\n      return imageView;\n    };\n\n    // add new image\n    var pushImage = function pushImage(_ref2) {\n      var root = _ref2.root,\n        props = _ref2.props,\n        image = _ref2.image;\n      var id = props.id;\n      var item = root.query('GET_ITEM', { id: id });\n      if (!item) return;\n\n      var crop = item.getMetadata('crop') || {\n        center: {\n          x: 0.5,\n          y: 0.5\n        },\n\n        flip: {\n          horizontal: false,\n          vertical: false\n        },\n\n        zoom: 1,\n        rotation: 0,\n        aspectRatio: null\n      };\n\n      var background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      var markup;\n      var resize;\n      var dirty = false;\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        markup = item.getMetadata('markup') || [];\n        resize = item.getMetadata('resize');\n        dirty = true;\n      }\n\n      // append image presenter\n      var imageView = root.appendChildView(\n        root.createChildView(ImageView, {\n          id: id,\n          image: image,\n          crop: crop,\n          resize: resize,\n          markup: markup,\n          dirty: dirty,\n          background: background,\n          opacity: 0,\n          scaleX: 1.15,\n          scaleY: 1.15,\n          translateY: 15\n        }),\n\n        root.childViews.length\n      );\n\n      root.ref.images.push(imageView);\n\n      // reveal the preview image\n      imageView.opacity = 1;\n      imageView.scaleX = 1;\n      imageView.scaleY = 1;\n      imageView.translateY = 0;\n\n      // the preview is now ready to be drawn\n      setTimeout(function() {\n        root.dispatch('DID_IMAGE_PREVIEW_SHOW', { id: id });\n      }, 250);\n    };\n\n    var updateImage = function updateImage(_ref3) {\n      var root = _ref3.root,\n        props = _ref3.props;\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n      var imageView = root.ref.images[root.ref.images.length - 1];\n      imageView.crop = item.getMetadata('crop');\n      imageView.background = root.query(\n        'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n      );\n\n      if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n        imageView.dirty = true;\n        imageView.resize = item.getMetadata('resize');\n        imageView.markup = item.getMetadata('markup');\n      }\n    };\n\n    // replace image preview\n    var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n      var root = _ref4.root,\n        props = _ref4.props,\n        action = _ref4.action;\n      // only filter and crop trigger redraw\n      if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n      // no images to update, exit\n      if (!root.ref.images.length) return;\n\n      // no item found, exit\n      var item = root.query('GET_ITEM', { id: props.id });\n      if (!item) return;\n\n      // for now, update existing image when filtering\n      if (/filter/.test(action.change.key)) {\n        var imageView = root.ref.images[root.ref.images.length - 1];\n        applyFilter(root, action.change.value, imageView.image);\n        return;\n      }\n\n      if (/crop|markup|resize/.test(action.change.key)) {\n        var crop = item.getMetadata('crop');\n        var image = root.ref.images[root.ref.images.length - 1];\n\n        // if aspect ratio has changed, we need to create a new image\n        if (\n          crop &&\n          crop.aspectRatio &&\n          image.crop &&\n          image.crop.aspectRatio &&\n          Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001\n        ) {\n          var _imageView = shiftImage({ root: root });\n          pushImage({\n            root: root,\n            props: props,\n            image: cloneCanvas(_imageView.image)\n          });\n        }\n        // if not, we can update the current image\n        else {\n          updateImage({ root: root, props: props });\n        }\n      }\n    };\n\n    var canCreateImageBitmap = function canCreateImageBitmap(file) {\n      // Firefox versions before 58 will freeze when running createImageBitmap\n      // in a Web Worker so we detect those versions and return false for support\n      var userAgent = window.navigator.userAgent;\n      var isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n      var firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n      if (firefoxVersion !== null && firefoxVersion <= 58) return false;\n\n      return 'createImageBitmap' in window && isBitmap(file);\n    };\n\n    /**\n     * Write handler for when preview container has been created\n     */\n    var didCreatePreviewContainer = function didCreatePreviewContainer(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // determine image size of this item\n      getImageSize(fileURL, function(width, height) {\n        // we can now scale the panel to the final size\n        root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n          id: id,\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var drawPreview = function drawPreview(_ref6) {\n      var root = _ref6.root,\n        props = _ref6.props;\n      var id = props.id;\n\n      // we need to get the file data to determine the eventual image size\n      var item = root.query('GET_ITEM', id);\n      if (!item) return;\n\n      // get url to file (we'll revoke it later on when done)\n      var fileURL = URL.createObjectURL(item.file);\n\n      // fallback\n      var loadPreviewFallback = function loadPreviewFallback() {\n        // let's scale the image in the main thread :(\n        loadImage(fileURL).then(previewImageLoaded);\n      };\n\n      // image is now ready\n      var previewImageLoaded = function previewImageLoaded(imageData) {\n        // the file url is no longer needed\n        URL.revokeObjectURL(fileURL);\n\n        // draw the scaled down version here and use that as source so bitmapdata can be closed\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap if orientation is incorrect\n        var width = imageData.width,\n          height = imageData.height;\n\n        // if no width or height, just return early.\n        if (!width || !height) return;\n\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref7 = [height, width];\n          width = _ref7[0];\n          height = _ref7[1];\n        }\n\n        // scale canvas based on pixel density\n        // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n        var pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n        // we want as much pixels to work with as possible,\n        // this multiplies the minimum image resolution,\n        // so when zooming in it doesn't get too blurry\n        var zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n        // imaeg scale factor\n        var scaleFactor = zoomFactor * pixelDensityFactor;\n\n        // calculate scaled preview image size\n        var previewImageRatio = height / width;\n\n        // calculate image preview height and width\n        var previewContainerWidth = root.rect.element.width;\n        var previewContainerHeight = root.rect.element.height;\n\n        var imageWidth = previewContainerWidth;\n        var imageHeight = imageWidth * previewImageRatio;\n\n        if (previewImageRatio > 1) {\n          imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n          imageHeight = imageWidth * previewImageRatio;\n        } else {\n          imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n          imageWidth = imageHeight / previewImageRatio;\n        }\n\n        // transfer to image tag so no canvas memory wasted on iOS\n        var previewImage = createPreviewImage(\n          imageData,\n          imageWidth,\n          imageHeight,\n          orientation\n        );\n\n        // done\n        var done = function done() {\n          // calculate average image color, disabled for now\n          var averageColor = root.query(\n            'GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR'\n          )\n            ? calculateAverageColor(data)\n            : null;\n          item.setMetadata('color', averageColor, true);\n\n          // data has been transferred to canvas ( if was ImageBitmap )\n          if ('close' in imageData) {\n            imageData.close();\n          }\n\n          // show the overlay\n          root.ref.overlayShadow.opacity = 1;\n\n          // create the first image\n          pushImage({ root: root, props: props, image: previewImage });\n        };\n\n        // apply filter\n        var filter = item.getMetadata('filter');\n        if (filter) {\n          applyFilter(root, filter, previewImage).then(done);\n        } else {\n          done();\n        }\n      };\n\n      // if we support scaling using createImageBitmap we use a worker\n      if (canCreateImageBitmap(item.file)) {\n        // let's scale the image in a worker\n        var worker = createWorker(BitmapWorker);\n\n        worker.post(\n          {\n            file: item.file\n          },\n\n          function(imageBitmap) {\n            // destroy worker\n            worker.terminate();\n\n            // no bitmap returned, must be something wrong,\n            // try the oldschool way\n            if (!imageBitmap) {\n              loadPreviewFallback();\n              return;\n            }\n\n            // yay we got our bitmap, let's continue showing the preview\n            previewImageLoaded(imageBitmap);\n          }\n        );\n      } else {\n        // create fallback preview\n        loadPreviewFallback();\n      }\n    };\n\n    /**\n     * Write handler for when the preview image is ready to be animated\n     */\n    var didDrawPreview = function didDrawPreview(_ref8) {\n      var root = _ref8.root;\n      // get last added image\n      var image = root.ref.images[root.ref.images.length - 1];\n      image.translateY = 0;\n      image.scaleX = 1.0;\n      image.scaleY = 1.0;\n      image.opacity = 1;\n    };\n\n    /**\n     * Write handler for when the preview has been loaded\n     */\n    var restoreOverlay = function restoreOverlay(_ref9) {\n      var root = _ref9.root;\n      root.ref.overlayShadow.opacity = 1;\n      root.ref.overlayError.opacity = 0;\n      root.ref.overlaySuccess.opacity = 0;\n    };\n\n    var didThrowError = function didThrowError(_ref10) {\n      var root = _ref10.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlayError.opacity = 1;\n    };\n\n    var didCompleteProcessing = function didCompleteProcessing(_ref11) {\n      var root = _ref11.root;\n      root.ref.overlayShadow.opacity = 0.25;\n      root.ref.overlaySuccess.opacity = 1;\n    };\n\n    /**\n     * Constructor\n     */\n    var create = function create(_ref12) {\n      var root = _ref12.root;\n      // image view\n      root.ref.images = [];\n\n      // the preview image data (we need this to filter the image)\n      root.ref.imageData = null;\n\n      // image bin\n      root.ref.imageViewBin = [];\n\n      // image overlays\n      root.ref.overlayShadow = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'idle'\n        })\n      );\n\n      root.ref.overlaySuccess = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'success'\n        })\n      );\n\n      root.ref.overlayError = root.appendChildView(\n        root.createChildView(OverlayView, {\n          opacity: 0,\n          status: 'failure'\n        })\n      );\n    };\n\n    return _.utils.createView({\n      name: 'image-preview-wrapper',\n      create: create,\n      styles: ['height'],\n      apis: ['height'],\n      destroy: function destroy(_ref13) {\n        var root = _ref13.root;\n        // we resize the image so memory on iOS 12 is released more quickly (it seems)\n        root.ref.images.forEach(function(imageView) {\n          imageView.image.width = 1;\n          imageView.image.height = 1;\n        });\n      },\n      didWriteView: function didWriteView(_ref14) {\n        var root = _ref14.root;\n        root.ref.images.forEach(function(imageView) {\n          imageView.dirty = false;\n        });\n      },\n      write: _.utils.createRoute(\n        {\n          // image preview stated\n          DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n          DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n          DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n\n          // file states\n          DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n          DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n          DID_THROW_ITEM_INVALID: didThrowError,\n          DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n          DID_START_ITEM_PROCESSING: restoreOverlay,\n          DID_REVERT_ITEM_PROCESSING: restoreOverlay\n        },\n\n        function(_ref15) {\n          var root = _ref15.root;\n          // views on death row\n          var viewsToRemove = root.ref.imageViewBin.filter(function(imageView) {\n            return imageView.opacity === 0;\n          });\n\n          // views to retain\n          root.ref.imageViewBin = root.ref.imageViewBin.filter(function(\n            imageView\n          ) {\n            return imageView.opacity > 0;\n          });\n\n          // remove these views\n          viewsToRemove.forEach(function(imageView) {\n            return removeImageView(root, imageView);\n          });\n          viewsToRemove.length = 0;\n        }\n      )\n    });\n  };\n\n  /**\n   * Image Preview Plugin\n   */\n  var plugin = function plugin(fpAPI) {\n    var addFilter = fpAPI.addFilter,\n      utils = fpAPI.utils;\n    var Type = utils.Type,\n      createRoute = utils.createRoute,\n      isFile = utils.isFile;\n\n    // imagePreviewView\n    var imagePreviewView = createImageWrapperView(fpAPI);\n\n    // called for each view that is created right after the 'create' method\n    addFilter('CREATE_VIEW', function(viewAPI) {\n      // get reference to created view\n      var is = viewAPI.is,\n        view = viewAPI.view,\n        query = viewAPI.query;\n\n      // only hook up to item view and only if is enabled for this cropper\n      if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n      // create the image preview plugin, but only do so if the item is an image\n      var didLoadItem = function didLoadItem(_ref) {\n        var root = _ref.root,\n          props = _ref.props;\n        var id = props.id;\n        var item = query('GET_ITEM', id);\n\n        // item could theoretically have been removed in the mean time\n        if (!item || !isFile(item.file) || item.archived) return;\n\n        // get the file object\n        var file = item.file;\n\n        // exit if this is not an image\n        if (!isPreviewableImage(file)) return;\n\n        // test if is filtered\n        if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n        // exit if image size is too high and no createImageBitmap support\n        // this would simply bring the browser to its knees and that is not what we want\n        var supportsCreateImageBitmap = 'createImageBitmap' in (window || {});\n        var maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n        if (\n          !supportsCreateImageBitmap &&\n          maxPreviewFileSize &&\n          file.size > maxPreviewFileSize\n        )\n          return;\n\n        // set preview view\n        root.ref.imagePreview = view.appendChildView(\n          view.createChildView(imagePreviewView, { id: id })\n        );\n\n        // update height if is fixed\n        var fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (fixedPreviewHeight) {\n          root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n            id: item.id,\n            height: fixedPreviewHeight\n          });\n        }\n\n        // now ready\n        var queue =\n          !supportsCreateImageBitmap &&\n          file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n        root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', { id: id }, queue);\n      };\n\n      var rescaleItem = function rescaleItem(root, props) {\n        if (!root.ref.imagePreview) return;\n        var id = props.id;\n\n        // get item\n        var item = root.query('GET_ITEM', { id: id });\n        if (!item) return;\n\n        // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n        var panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n        var itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n        var fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n        if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n        // no data!\n        var _root$ref = root.ref,\n          imageWidth = _root$ref.imageWidth,\n          imageHeight = _root$ref.imageHeight;\n        if (!imageWidth || !imageHeight) return;\n\n        // get height min and max\n        var minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n        var maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n        // orientation info\n        var exif = item.getMetadata('exif') || {};\n        var orientation = exif.orientation || -1;\n\n        // get width and height from action, and swap of orientation is incorrect\n        if (orientation >= 5 && orientation <= 8) {\n          var _ref2 = [imageHeight, imageWidth];\n          imageWidth = _ref2[0];\n          imageHeight = _ref2[1];\n        }\n\n        // scale up width and height when we're dealing with an SVG\n        if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n          var scalar = 2048 / imageWidth;\n          imageWidth *= scalar;\n          imageHeight *= scalar;\n        }\n\n        // image aspect ratio\n        var imageAspectRatio = imageHeight / imageWidth;\n\n        // we need the item to get to the crop size\n        var previewAspectRatio =\n          (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n        // preview height range\n        var previewHeightMax = Math.max(\n          minPreviewHeight,\n          Math.min(imageHeight, maxPreviewHeight)\n        );\n\n        var itemWidth = root.rect.element.width;\n        var previewHeight = Math.min(\n          itemWidth * previewAspectRatio,\n          previewHeightMax\n        );\n\n        // request update to panel height\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: previewHeight\n        });\n      };\n\n      var didResizeView = function didResizeView(_ref3) {\n        var root = _ref3.root;\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didUpdateItemMetadata = function didUpdateItemMetadata(_ref4) {\n        var root = _ref4.root,\n          action = _ref4.action;\n        if (action.change.key !== 'crop') return;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n      };\n\n      var didCalculatePreviewSize = function didCalculatePreviewSize(_ref5) {\n        var root = _ref5.root,\n          action = _ref5.action;\n        // remember dimensions\n        root.ref.imageWidth = action.width;\n        root.ref.imageHeight = action.height;\n\n        // actions in next write operation\n        root.ref.shouldRescale = true;\n        root.ref.shouldDrawPreview = true;\n\n        // as image load could take a while and fire when draw loop is resting we need to give it a kick\n        root.dispatch('KICK');\n      };\n\n      // start writing\n      view.registerWriter(\n        createRoute(\n          {\n            DID_RESIZE_ROOT: didResizeView,\n            DID_STOP_RESIZE: didResizeView,\n            DID_LOAD_ITEM: didLoadItem,\n            DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n            DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n          },\n\n          function(_ref6) {\n            var root = _ref6.root,\n              props = _ref6.props;\n            // no preview view attached\n            if (!root.ref.imagePreview) return;\n\n            // don't do anything while hidden\n            if (root.rect.element.hidden) return;\n\n            // resize the item panel\n            if (root.ref.shouldRescale) {\n              rescaleItem(root, props);\n              root.ref.shouldRescale = false;\n            }\n\n            if (root.ref.shouldDrawPreview) {\n              // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n              requestAnimationFrame(function() {\n                // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n                // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n                requestAnimationFrame(function() {\n                  root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                    id: props.id\n                  });\n                });\n              });\n\n              root.ref.shouldDrawPreview = false;\n            }\n          }\n        )\n      );\n    });\n\n    // expose plugin\n    return {\n      options: {\n        // Enable or disable image preview\n        allowImagePreview: [true, Type.BOOLEAN],\n\n        // filters file items to determine which are shown as preview\n        imagePreviewFilterItem: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ],\n\n        // Fixed preview height\n        imagePreviewHeight: [null, Type.INT],\n\n        // Min image height\n        imagePreviewMinHeight: [44, Type.INT],\n\n        // Max image height\n        imagePreviewMaxHeight: [256, Type.INT],\n\n        // Max size of preview file for when createImageBitmap is not supported\n        imagePreviewMaxFileSize: [null, Type.INT],\n\n        // The amount of extra pixels added to the image preview to allow comfortable zooming\n        imagePreviewZoomFactor: [2, Type.INT],\n\n        // Should we upscale small images to fit the max bounding box of the preview area\n        imagePreviewUpscale: [false, Type.BOOLEAN],\n\n        // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n        imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n\n        // Style of the transparancy indicator used behind images\n        imagePreviewTransparencyIndicator: [null, Type.STRING],\n\n        // Enables or disables reading average image color\n        imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n\n        // Enables or disables the previewing of markup\n        imagePreviewMarkupShow: [true, Type.BOOLEAN],\n\n        // Allows filtering of markup to only show certain shapes\n        imagePreviewMarkupFilter: [\n          function() {\n            return true;\n          },\n          Type.FUNCTION\n        ]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser =\n    typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser) {\n    document.dispatchEvent(\n      new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n    );\n  }\n\n  return plugin;\n});\n","/*!\n * FilePondPluginFileValidateType 1.2.9\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? (module.exports = factory())\n        : typeof define === 'function' && define.amd\n        ? define(factory)\n        : ((global = global || self), (global.FilePondPluginFileValidateType = factory()));\n})(this, function() {\n    'use strict';\n\n    var plugin = function plugin(_ref) {\n        var addFilter = _ref.addFilter,\n            utils = _ref.utils;\n        // get quick reference to Type utils\n        var Type = utils.Type,\n            isString = utils.isString,\n            replaceInString = utils.replaceInString,\n            guesstimateMimeType = utils.guesstimateMimeType,\n            getExtensionFromFilename = utils.getExtensionFromFilename,\n            getFilenameFromURL = utils.getFilenameFromURL;\n\n        var mimeTypeMatchesWildCard = function mimeTypeMatchesWildCard(mimeType, wildcard) {\n            var mimeTypeGroup = (/^[^/]+/.exec(mimeType) || []).pop(); // image/png -> image\n            var wildcardGroup = wildcard.slice(0, -2); // image/* -> image\n            return mimeTypeGroup === wildcardGroup;\n        };\n\n        var isValidMimeType = function isValidMimeType(acceptedTypes, userInputType) {\n            return acceptedTypes.some(function(acceptedType) {\n                // accepted is wildcard mime type\n                if (/\\*$/.test(acceptedType)) {\n                    return mimeTypeMatchesWildCard(userInputType, acceptedType);\n                }\n\n                // is normal mime type\n                return acceptedType === userInputType;\n            });\n        };\n\n        var getItemType = function getItemType(item) {\n            // if the item is a url we guess the mime type by the extension\n            var type = '';\n            if (isString(item)) {\n                var filename = getFilenameFromURL(item);\n                var extension = getExtensionFromFilename(filename);\n                if (extension) {\n                    type = guesstimateMimeType(extension);\n                }\n            } else {\n                type = item.type;\n            }\n\n            return type;\n        };\n\n        var validateFile = function validateFile(item, acceptedFileTypes, typeDetector) {\n            // no types defined, everything is allowed \\o/\n            if (acceptedFileTypes.length === 0) {\n                return true;\n            }\n\n            // gets the item type\n            var type = getItemType(item);\n\n            // no type detector, test now\n            if (!typeDetector) {\n                return isValidMimeType(acceptedFileTypes, type);\n            }\n\n            // use type detector\n            return new Promise(function(resolve, reject) {\n                typeDetector(item, type)\n                    .then(function(detectedType) {\n                        if (isValidMimeType(acceptedFileTypes, detectedType)) {\n                            resolve();\n                        } else {\n                            reject();\n                        }\n                    })\n                    .catch(reject);\n            });\n        };\n\n        var applyMimeTypeMap = function applyMimeTypeMap(map) {\n            return function(acceptedFileType) {\n                return map[acceptedFileType] === null\n                    ? false\n                    : map[acceptedFileType] || acceptedFileType;\n            };\n        };\n\n        // setup attribute mapping for accept\n        addFilter('SET_ATTRIBUTE_TO_OPTION_MAP', function(map) {\n            return Object.assign(map, {\n                accept: 'acceptedFileTypes',\n            });\n        });\n\n        // filtering if an item is allowed in hopper\n        addFilter('ALLOW_HOPPER_ITEM', function(file, _ref2) {\n            var query = _ref2.query;\n            // if we are not doing file type validation exit\n            if (!query('GET_ALLOW_FILE_TYPE_VALIDATION')) {\n                return true;\n            }\n\n            // we validate the file against the accepted file types\n            return validateFile(file, query('GET_ACCEPTED_FILE_TYPES'));\n        });\n\n        // called for each file that is loaded\n        // right before it is set to the item state\n        // should return a promise\n        addFilter('LOAD_FILE', function(file, _ref3) {\n            var query = _ref3.query;\n            return new Promise(function(resolve, reject) {\n                if (!query('GET_ALLOW_FILE_TYPE_VALIDATION')) {\n                    resolve(file);\n                    return;\n                }\n\n                var acceptedFileTypes = query('GET_ACCEPTED_FILE_TYPES');\n\n                // custom type detector method\n                var typeDetector = query('GET_FILE_VALIDATE_TYPE_DETECT_TYPE');\n\n                // if invalid, exit here\n                var validationResult = validateFile(file, acceptedFileTypes, typeDetector);\n\n                var handleRejection = function handleRejection() {\n                    var acceptedFileTypesMapped = acceptedFileTypes\n                        .map(\n                            applyMimeTypeMap(\n                                query('GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP')\n                            )\n                        )\n                        .filter(function(label) {\n                            return label !== false;\n                        });\n\n                    var acceptedFileTypesMappedUnique = acceptedFileTypesMapped.filter(function(\n                        item,\n                        index\n                    ) {\n                        return acceptedFileTypesMapped.indexOf(item) === index;\n                    });\n\n                    reject({\n                        status: {\n                            main: query('GET_LABEL_FILE_TYPE_NOT_ALLOWED'),\n                            sub: replaceInString(\n                                query('GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES'),\n                                {\n                                    allTypes: acceptedFileTypesMappedUnique.join(', '),\n                                    allButLastType: acceptedFileTypesMappedUnique\n                                        .slice(0, -1)\n                                        .join(', '),\n                                    lastType:\n                                        acceptedFileTypesMappedUnique[\n                                            acceptedFileTypesMappedUnique.length - 1\n                                        ],\n                                }\n                            ),\n                        },\n                    });\n                };\n\n                // has returned new filename immidiately\n                if (typeof validationResult === 'boolean') {\n                    if (!validationResult) {\n                        return handleRejection();\n                    }\n                    return resolve(file);\n                }\n\n                // is promise\n                validationResult\n                    .then(function() {\n                        resolve(file);\n                    })\n                    .catch(handleRejection);\n            });\n        });\n\n        // expose plugin\n        return {\n            // default options\n            options: {\n                // Enable or disable file type validation\n                allowFileTypeValidation: [true, Type.BOOLEAN],\n\n                // What file types to accept\n                acceptedFileTypes: [[], Type.ARRAY],\n                // - must be comma separated\n                // - mime types: image/png, image/jpeg, image/gif\n                // - extensions: .png, .jpg, .jpeg ( not enabled yet )\n                // - wildcards: image/*\n\n                // label to show when a type is not allowed\n                labelFileTypeNotAllowed: ['File is of invalid type', Type.STRING],\n\n                // nicer label\n                fileValidateTypeLabelExpectedTypes: [\n                    'Expects {allButLastType} or {lastType}',\n                    Type.STRING,\n                ],\n\n                // map mime types to extensions\n                fileValidateTypeLabelExpectedTypesMap: [{}, Type.OBJECT],\n\n                // Custom function to detect type of file\n                fileValidateTypeDetectType: [null, Type.FUNCTION],\n            },\n        };\n    };\n\n    // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    if (isBrowser) {\n        document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', { detail: plugin }));\n    }\n\n    return plugin;\n});\n","export class FilepondImageResolutionValidator {\n    static tags = [\n        {\n            event: 'contao_filepond:process_start',\n            priority: 90,\n        }\n    ];\n\n    async handle(event) {\n        const file = event.file;\n\n        // Skip non-images early\n        if (!this.isImage(file)) {\n            return;\n        }\n\n        const options = event.filepondOptions;\n\n        const minImageWidth = Number(event.jsConfig.minImageWidth) || 0;\n        const minImageHeight = Number(event.jsConfig.minImageHeight) || 0;\n        const maxImageWidth = Number(event.jsConfig.maxImageWidth) || 0;\n        const maxImageHeight = Number(event.jsConfig.maxImageHeight) || 0;\n\n        if (!(file instanceof Blob)) {\n            throw new Error(options.labelImageValidateSizeLabelFormatError);\n        }\n\n        // Load the image\n        let width, height;\n\n        try {\n            ({width, height} = await this.loadImage(file));\n        } catch (e) {\n            console.log(`Skip resolution validator: Could not load image from ${file.name}.`);\n            return;\n        }\n\n        // Skip if width or height is not a number\n        if (!Number.isFinite(width) || !Number.isFinite(height)) {\n            console.log(`Skip resolution validator: Invalid resolution for ${file.name}.`);\n            return;\n        }\n\n        // Min resolution\n        if (width < minImageWidth || height < minImageHeight) {\n            const data = {'width': width, 'height': height, 'minWidth': minImageWidth, 'minHeight': minImageHeight};\n            const msg = options.labelMinImageResolutionValidationError.replace(/\\{(\\w+)\\}/g, (_, k) => data[k]);\n            throw new Error(msg);\n        }\n\n        // Max resolution\n        if (maxImageWidth && (width > maxImageWidth || height > maxImageHeight)) {\n            const data = {'width': width, 'height': height, 'maxWidth': maxImageWidth, 'maxHeight': maxImageHeight};\n            const msg = options.labelMaxImageResolutionValidationError.replace(/\\{(\\w+)\\}/g, (_, k) => data[k]);\n            throw new Error(msg);\n        }\n    }\n\n    loadImage(file) {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            const url = URL.createObjectURL(file);\n\n            img.onload = () => {\n                URL.revokeObjectURL(url);\n                resolve({width: img.naturalWidth, height: img.naturalHeight});\n            };\n\n            img.onerror = () => {\n                URL.revokeObjectURL(url);\n                reject(new Error(\"Invalid image, cannot extract resolution.\"));\n            };\n\n            img.src = url;\n        });\n    }\n\n    isImage(file) {\n        // MIME type OR extension fallback\n        return (\n            /^image\\//.test(file.type) ||\n            /\\.(png|jpe?g|gif|webp|bmp|svg)$/i.test(file.name)\n        );\n    }\n}\n","var map = {\n\t\"./filepond_file_size_validator.js\": 1824,\n\t\"./filepond_image_resolution_validator.js\": 4852\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 5925;","/*!\n * FilePondPluginImageExifOrientation 1.0.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? (module.exports = factory())\n    : typeof define === 'function' && define.amd\n    ? define(factory)\n    : ((global = global || self),\n      (global.FilePondPluginImageExifOrientation = factory()));\n})(this, function() {\n  'use strict';\n\n  // test if file is of type image\n  var isJPEG = function isJPEG(file) {\n    return /^image\\/jpeg/.test(file.type);\n  };\n\n  var Marker = {\n    JPEG: 0xffd8,\n    APP1: 0xffe1,\n    EXIF: 0x45786966,\n    TIFF: 0x4949,\n    Orientation: 0x0112,\n    Unknown: 0xff00\n  };\n\n  var getUint16 = function getUint16(view, offset) {\n    var little =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return view.getUint16(offset, little);\n  };\n  var getUint32 = function getUint32(view, offset) {\n    var little =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return view.getUint32(offset, little);\n  };\n\n  var getImageOrientation = function getImageOrientation(file) {\n    return new Promise(function(resolve, reject) {\n      var reader = new FileReader();\n      reader.onload = function(e) {\n        var view = new DataView(e.target.result);\n\n        // Every JPEG file starts from binary value '0xFFD8'\n        if (getUint16(view, 0) !== Marker.JPEG) {\n          // This aint no JPEG\n          resolve(-1);\n          return;\n        }\n\n        var length = view.byteLength;\n        var offset = 2;\n\n        while (offset < length) {\n          var marker = getUint16(view, offset);\n          offset += 2;\n\n          // There's our APP1 Marker\n          if (marker === Marker.APP1) {\n            if (getUint32(view, (offset += 2)) !== Marker.EXIF) {\n              // no EXIF info defined\n              break;\n            }\n\n            // Get TIFF Header\n            var little = getUint16(view, (offset += 6)) === Marker.TIFF;\n            offset += getUint32(view, offset + 4, little);\n\n            var tags = getUint16(view, offset, little);\n            offset += 2;\n\n            for (var i = 0; i < tags; i++) {\n              // found the orientation tag\n              if (\n                getUint16(view, offset + i * 12, little) === Marker.Orientation\n              ) {\n                resolve(getUint16(view, offset + i * 12 + 8, little));\n\n                return;\n              }\n            }\n          } else if ((marker & Marker.Unknown) !== Marker.Unknown) {\n            // Invalid\n            break;\n          } else {\n            offset += getUint16(view, offset);\n          }\n        }\n\n        // Nothing found\n        resolve(-1);\n      };\n\n      // we don't need to read the entire file to get the orientation\n      reader.readAsArrayBuffer(file.slice(0, 64 * 1024));\n    });\n  };\n\n  var IS_BROWSER = (function() {\n    return (\n      typeof window !== 'undefined' && typeof window.document !== 'undefined'\n    );\n  })();\n  var isBrowser = function isBrowser() {\n    return IS_BROWSER;\n  };\n\n  // 2x1 pixel image 90CW rotated with orientation header\n  var testSrc =\n    'data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=';\n\n  // should correct orientation if is presented in landscape, in which case the browser doesn't autocorrect\n  var shouldCorrect = undefined;\n  var testImage = isBrowser() ? new Image() : {};\n  testImage.onload = function() {\n    return (shouldCorrect = testImage.naturalWidth > testImage.naturalHeight);\n  };\n  testImage.src = testSrc;\n\n  var shouldCorrectImageExifOrientation = function shouldCorrectImageExifOrientation() {\n    return shouldCorrect;\n  };\n\n  /**\n   * Read Image Orientation Plugin\n   */\n  var plugin = function plugin(_ref) {\n    var addFilter = _ref.addFilter,\n      utils = _ref.utils;\n    var Type = utils.Type,\n      isFile = utils.isFile;\n\n    // subscribe to file load and append required info\n    addFilter('DID_LOAD_ITEM', function(item, _ref2) {\n      var query = _ref2.query;\n      return new Promise(function(resolve, reject) {\n        // get file reference\n        var file = item.file;\n\n        // if this is not a jpeg image we are not interested\n        if (\n          !isFile(file) ||\n          !isJPEG(file) ||\n          !query('GET_ALLOW_IMAGE_EXIF_ORIENTATION') ||\n          !shouldCorrectImageExifOrientation()\n        ) {\n          // continue with the unaltered dataset\n          return resolve(item);\n        }\n\n        // get orientation from exif data\n        getImageOrientation(file).then(function(orientation) {\n          item.setMetadata('exif', { orientation: orientation });\n          resolve(item);\n        });\n      });\n    });\n\n    // Expose plugin options\n    return {\n      options: {\n        // Enable or disable image orientation reading\n        allowImageExifOrientation: [true, Type.BOOLEAN]\n      }\n    };\n  };\n\n  // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n  var isBrowser$1 =\n    typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  if (isBrowser$1) {\n    document.dispatchEvent(\n      new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n    );\n  }\n\n  return plugin;\n});\n","/*!\n * FilePondPluginImageResize 2.0.10\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined'\n        ? (module.exports = factory())\n        : typeof define === 'function' && define.amd\n        ? define(factory)\n        : ((global = global || self), (global.FilePondPluginImageResize = factory()));\n})(this, function() {\n    'use strict';\n\n    // test if file is of type image\n    var isImage = function isImage(file) {\n        return /^image/.test(file.type);\n    };\n\n    var getImageSize = function getImageSize(url, cb) {\n        var image = new Image();\n        image.onload = function() {\n            var width = image.naturalWidth;\n            var height = image.naturalHeight;\n            image = null;\n            cb({ width: width, height: height });\n        };\n        image.onerror = function() {\n            return cb(null);\n        };\n        image.src = url;\n    };\n\n    /**\n     * Image Auto Resize Plugin\n     */\n    var plugin = function plugin(_ref) {\n        var addFilter = _ref.addFilter,\n            utils = _ref.utils;\n        var Type = utils.Type;\n\n        // subscribe to file load and append required transformations\n        addFilter('DID_LOAD_ITEM', function(item, _ref2) {\n            var query = _ref2.query;\n            return new Promise(function(resolve, reject) {\n                // get file reference\n                var file = item.file;\n\n                // if this is not an image we do not have any business cropping it\n                if (!isImage(file) || !query('GET_ALLOW_IMAGE_RESIZE')) {\n                    // continue with the unaltered dataset\n                    return resolve(item);\n                }\n\n                var mode = query('GET_IMAGE_RESIZE_MODE');\n                var width = query('GET_IMAGE_RESIZE_TARGET_WIDTH');\n                var height = query('GET_IMAGE_RESIZE_TARGET_HEIGHT');\n                var upscale = query('GET_IMAGE_RESIZE_UPSCALE');\n\n                // no resizing to be done\n                if (width === null && height === null) return resolve(item);\n\n                var targetWidth = width === null ? height : width;\n                var targetHeight = height === null ? targetWidth : height;\n\n                // if should not upscale, we need to determine the size of the file\n                var fileURL = URL.createObjectURL(file);\n                getImageSize(fileURL, function(size) {\n                    URL.revokeObjectURL(fileURL);\n\n                    // something went wrong\n                    if (!size) return resolve(item);\n                    var imageWidth = size.width,\n                        imageHeight = size.height;\n\n                    // get exif orientation\n                    var orientation = (item.getMetadata('exif') || {}).orientation || -1;\n\n                    // swap width and height if orientation needs correcting\n                    if (orientation >= 5 && orientation <= 8) {\n                        var _ref3 = [imageHeight, imageWidth];\n                        imageWidth = _ref3[0];\n                        imageHeight = _ref3[1];\n                    }\n\n                    // image is already perfect size, no transformations required\n                    if (imageWidth === targetWidth && imageHeight === targetHeight)\n                        return resolve(item);\n\n                    // already contained?\n                    // can't upscale image, so if already at correct scale, exit\n                    if (!upscale) {\n                        // covering target size\n                        if (mode === 'cover') {\n                            // if one of edges is smaller than target size, exit\n                            if (imageWidth <= targetWidth || imageHeight <= targetHeight)\n                                return resolve(item);\n                        }\n\n                        // not covering target size, if image is contained in target size, exit\n                        else if (imageWidth <= targetWidth && imageHeight <= targetWidth) {\n                            return resolve(item);\n                        }\n                    }\n\n                    // the image needs to be resized\n                    item.setMetadata('resize', {\n                        mode: mode,\n                        upscale: upscale,\n                        size: {\n                            width: targetWidth,\n                            height: targetHeight,\n                        },\n                    });\n\n                    resolve(item);\n                });\n            });\n        });\n\n        // Expose plugin options\n        return {\n            options: {\n                // Enable or disable image resizing\n                allowImageResize: [true, Type.BOOLEAN],\n\n                // the method of rescaling\n                // - force => force set size\n                // - cover => pick biggest dimension\n                // - contain => pick smaller dimension\n                imageResizeMode: ['cover', Type.STRING],\n\n                // set to false to disable upscaling of image smaller than the target width / height\n                imageResizeUpscale: [true, Type.BOOLEAN],\n\n                // target width\n                imageResizeTargetWidth: [null, Type.INT],\n\n                // target height\n                imageResizeTargetHeight: [null, Type.INT],\n            },\n        };\n    };\n\n    // fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\n    var isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    if (isBrowser) {\n        document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', { detail: plugin }));\n    }\n\n    return plugin;\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*!\n * FilePond 4.32.10\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\nconst isNode = value => value instanceof HTMLElement;\n\nconst createStore = (initialState, queries = [], actions = []) => {\n    // internal state\n    const state = {\n        ...initialState,\n    };\n\n    // contains all actions for next frame, is clear when actions are requested\n    const actionQueue = [];\n    const dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    const getState = () => ({ ...state });\n\n    // returns a duplicate of the actions array and clears the actions array\n    const processActionQueue = () => {\n        // create copy of actions queue\n        const queue = [...actionQueue];\n\n        // clear actions queue (we don't want no double actions)\n        actionQueue.length = 0;\n\n        return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    const processDispatchQueue = () => {\n        // create copy of actions queue\n        const queue = [...dispatchQueue];\n\n        // clear actions queue (we don't want no double actions)\n        dispatchQueue.length = 0;\n\n        // now dispatch these actions\n        queue.forEach(({ type, data }) => {\n            dispatch(type, data);\n        });\n    };\n\n    // adds a new action, calls its handler and\n    const dispatch = (type, data, isBlocking) => {\n        // is blocking action (should never block if document is hidden)\n        if (isBlocking && !document.hidden) {\n            dispatchQueue.push({ type, data });\n            return;\n        }\n\n        // if this action has a handler, handle the action\n        if (actionHandlers[type]) {\n            actionHandlers[type](data);\n        }\n\n        // now add action\n        actionQueue.push({\n            type,\n            data,\n        });\n    };\n\n    const query = (str, ...args) => (queryHandles[str] ? queryHandles[str](...args) : null);\n\n    const api = {\n        getState,\n        processActionQueue,\n        processDispatchQueue,\n        dispatch,\n        query,\n    };\n\n    let queryHandles = {};\n    queries.forEach(query => {\n        queryHandles = {\n            ...query(state),\n            ...queryHandles,\n        };\n    });\n\n    let actionHandlers = {};\n    actions.forEach(action => {\n        actionHandlers = {\n            ...action(dispatch, query, state),\n            ...actionHandlers,\n        };\n    });\n\n    return api;\n};\n\nconst defineProperty = (obj, property, definition) => {\n    if (typeof definition === 'function') {\n        obj[property] = definition;\n        return;\n    }\n    Object.defineProperty(obj, property, { ...definition });\n};\n\nconst forin = (obj, cb) => {\n    for (const key in obj) {\n        if (!obj.hasOwnProperty(key)) {\n            continue;\n        }\n\n        cb(key, obj[key]);\n    }\n};\n\nconst createObject = definition => {\n    const obj = {};\n    forin(definition, property => {\n        defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n};\n\nconst attr = (node, name, value = null) => {\n    if (value === null) {\n        return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n};\n\nconst ns = 'http://www.w3.org/2000/svg';\nconst svgElements = ['svg', 'path']; // only svg elements used\n\nconst isSVGElement = tag => svgElements.includes(tag);\n\nconst createElement = (tag, className, attributes = {}) => {\n    if (typeof className === 'object') {\n        attributes = className;\n        className = null;\n    }\n    const element = isSVGElement(tag)\n        ? document.createElementNS(ns, tag)\n        : document.createElement(tag);\n    if (className) {\n        if (isSVGElement(tag)) {\n            attr(element, 'class', className);\n        } else {\n            element.className = className;\n        }\n    }\n    forin(attributes, (name, value) => {\n        attr(element, name, value);\n    });\n    return element;\n};\n\nconst appendChild = parent => (child, index) => {\n    if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n    } else {\n        parent.appendChild(child);\n    }\n};\n\nconst appendChildView = (parent, childViews) => (view, index) => {\n    if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n    } else {\n        childViews.push(view);\n    }\n\n    return view;\n};\n\nconst removeChildView = (parent, childViews) => view => {\n    // remove from child views\n    childViews.splice(childViews.indexOf(view), 1);\n\n    // remove the element\n    if (view.element.parentNode) {\n        parent.removeChild(view.element);\n    }\n\n    return view;\n};\n\nconst IS_BROWSER = (() =>\n    typeof window !== 'undefined' && typeof window.document !== 'undefined')();\nconst isBrowser = () => IS_BROWSER;\n\nconst testElement = isBrowser() ? createElement('svg') : {};\nconst getChildCount =\n    'children' in testElement ? el => el.children.length : el => el.childNodes.length;\n\nconst getViewRect = (elementRect, childViews, offset, scale) => {\n    const left = offset[0] || elementRect.left;\n    const top = offset[1] || elementRect.top;\n    const right = left + elementRect.width;\n    const bottom = top + elementRect.height * (scale[1] || 1);\n\n    const rect = {\n        // the rectangle of the element itself\n        element: {\n            ...elementRect,\n        },\n\n        // the rectangle of the element expanded to contain its children, does not include any margins\n        inner: {\n            left: elementRect.left,\n            top: elementRect.top,\n            right: elementRect.right,\n            bottom: elementRect.bottom,\n        },\n\n        // the rectangle of the element expanded to contain its children including own margin and child margins\n        // margins will be added after we've recalculated the size\n        outer: {\n            left,\n            top,\n            right,\n            bottom,\n        },\n    };\n\n    // expand rect to fit all child rectangles\n    childViews\n        .filter(childView => !childView.isRectIgnored())\n        .map(childView => childView.rect)\n        .forEach(childViewRect => {\n            expandRect(rect.inner, { ...childViewRect.inner });\n            expandRect(rect.outer, { ...childViewRect.outer });\n        });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n\n    return rect;\n};\n\nconst expandRect = (parent, child) => {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n        parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n        parent.right = child.right;\n    }\n};\n\nconst calculateRectSize = rect => {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n};\n\nconst isNumber = value => typeof value === 'number';\n\n/**\n * Determines if position is at destination\n * @param position\n * @param destination\n * @param velocity\n * @param errorMargin\n * @returns {boolean}\n */\nconst thereYet = (position, destination, velocity, errorMargin = 0.001) => {\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n};\n\n/**\n * Spring animation\n */\nconst spring =\n    // default options\n    ({ stiffness = 0.5, damping = 0.75, mass = 10 } = {}) =>\n        // method definition\n        {\n            let target = null;\n            let position = null;\n            let velocity = 0;\n            let resting = false;\n\n            // updates spring state\n            const interpolate = (ts, skipToEndState) => {\n                // in rest, don't animate\n                if (resting) return;\n\n                // need at least a target or position to do springy things\n                if (!(isNumber(target) && isNumber(position))) {\n                    resting = true;\n                    velocity = 0;\n                    return;\n                }\n\n                // calculate spring force\n                const f = -(position - target) * stiffness;\n\n                // update velocity by adding force based on mass\n                velocity += f / mass;\n\n                // update position by adding velocity\n                position += velocity;\n\n                // slow down based on amount of damping\n                velocity *= damping;\n\n                // we've arrived if we're near target and our velocity is near zero\n                if (thereYet(position, target, velocity) || skipToEndState) {\n                    position = target;\n                    velocity = 0;\n                    resting = true;\n\n                    // we done\n                    api.onupdate(position);\n                    api.oncomplete(position);\n                } else {\n                    // progress update\n                    api.onupdate(position);\n                }\n            };\n\n            /**\n             * Set new target value\n             * @param value\n             */\n            const setTarget = value => {\n                // if currently has no position, set target and position to this value\n                if (isNumber(value) && !isNumber(position)) {\n                    position = value;\n                }\n\n                // next target value will not be animated to\n                if (target === null) {\n                    target = value;\n                    position = value;\n                }\n\n                // let start moving to target\n                target = value;\n\n                // already at target\n                if (position === target || typeof target === 'undefined') {\n                    // now resting as target is current position, stop moving\n                    resting = true;\n                    velocity = 0;\n\n                    // done!\n                    api.onupdate(position);\n                    api.oncomplete(position);\n\n                    return;\n                }\n\n                resting = false;\n            };\n\n            // need 'api' to call onupdate callback\n            const api = createObject({\n                interpolate,\n                target: {\n                    set: setTarget,\n                    get: () => target,\n                },\n                resting: {\n                    get: () => resting,\n                },\n                onupdate: value => {},\n                oncomplete: value => {},\n            });\n\n            return api;\n        };\n\nconst easeLinear = t => t;\nconst easeInOutQuad = t => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\n\nconst tween =\n    // default values\n    ({ duration = 500, easing = easeInOutQuad, delay = 0 } = {}) =>\n        // method definition\n        {\n            let start = null;\n            let t;\n            let p;\n            let resting = true;\n            let reverse = false;\n            let target = null;\n\n            const interpolate = (ts, skipToEndState) => {\n                if (resting || target === null) return;\n\n                if (start === null) {\n                    start = ts;\n                }\n\n                if (ts - start < delay) return;\n\n                t = ts - start - delay;\n\n                if (t >= duration || skipToEndState) {\n                    t = 1;\n                    p = reverse ? 0 : 1;\n                    api.onupdate(p * target);\n                    api.oncomplete(p * target);\n                    resting = true;\n                } else {\n                    p = t / duration;\n                    api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n                }\n            };\n\n            // need 'api' to call onupdate callback\n            const api = createObject({\n                interpolate,\n                target: {\n                    get: () => (reverse ? 0 : target),\n                    set: value => {\n                        // is initial value\n                        if (target === null) {\n                            target = value;\n                            api.onupdate(value);\n                            api.oncomplete(value);\n                            return;\n                        }\n\n                        // want to tween to a smaller value and have a current value\n                        if (value < target) {\n                            target = 1;\n                            reverse = true;\n                        } else {\n                            // not tweening to a smaller value\n                            reverse = false;\n                            target = value;\n                        }\n\n                        // let's go!\n                        resting = false;\n                        start = null;\n                    },\n                },\n                resting: {\n                    get: () => resting,\n                },\n                onupdate: value => {},\n                oncomplete: value => {},\n            });\n\n            return api;\n        };\n\nconst animator = {\n    spring,\n    tween,\n};\n\n/*\n { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n { translation: { type: 'spring', ... }, ... }\n { translation: { x: { type: 'spring', ... } } }\n*/\nconst createAnimator = (definition, category, property) => {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    const def =\n        definition[category] && typeof definition[category][property] === 'object'\n            ? definition[category][property]\n            : definition[category] || definition;\n\n    const type = typeof def === 'string' ? def : def.type;\n    const props = typeof def === 'object' ? { ...def } : {};\n\n    return animator[type] ? animator[type](props) : null;\n};\n\nconst addGetSet = (keys, obj, props, overwrite = false) => {\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(o => {\n        keys.forEach(key => {\n            let name = key;\n            let getter = () => props[key];\n            let setter = value => (props[key] = value);\n\n            if (typeof key === 'object') {\n                name = key.key;\n                getter = key.getter || getter;\n                setter = key.setter || setter;\n            }\n\n            if (o[name] && !overwrite) {\n                return;\n            }\n\n            o[name] = {\n                get: getter,\n                set: setter,\n            };\n        });\n    });\n};\n\n// add to state,\n// add getters and setters to internal and external api (if not set)\n// setup animators\n\nconst animations = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI }) => {\n    // initial properties\n    const initialProps = { ...viewProps };\n\n    // list of all active animations\n    const animations = [];\n\n    // setup animators\n    forin(mixinConfig, (property, animation) => {\n        const animator = createAnimator(animation);\n        if (!animator) {\n            return;\n        }\n\n        // when the animator updates, update the view state value\n        animator.onupdate = value => {\n            viewProps[property] = value;\n        };\n\n        // set animator target\n        animator.target = initialProps[property];\n\n        // when value is set, set the animator target value\n        const prop = {\n            key: property,\n            setter: value => {\n                // if already at target, we done!\n                if (animator.target === value) {\n                    return;\n                }\n\n                animator.target = value;\n            },\n            getter: () => viewProps[property],\n        };\n\n        // add getters and setters\n        addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n        // add it to the list for easy updating from the _write method\n        animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n        write: ts => {\n            let skipToEndState = document.hidden;\n            let resting = true;\n            animations.forEach(animation => {\n                if (!animation.resting) resting = false;\n                animation.interpolate(ts, skipToEndState);\n            });\n            return resting;\n        },\n        destroy: () => {},\n    };\n};\n\nconst addEvent = element => (type, fn) => {\n    element.addEventListener(type, fn);\n};\n\nconst removeEvent = element => (type, fn) => {\n    element.removeEventListener(type, fn);\n};\n\n// mixin\nconst listeners = ({\n    mixinConfig,\n    viewProps,\n    viewInternalAPI,\n    viewExternalAPI,\n    viewState,\n    view,\n}) => {\n    const events = [];\n\n    const add = addEvent(view.element);\n    const remove = removeEvent(view.element);\n\n    viewExternalAPI.on = (type, fn) => {\n        events.push({\n            type,\n            fn,\n        });\n        add(type, fn);\n    };\n\n    viewExternalAPI.off = (type, fn) => {\n        events.splice(events.findIndex(event => event.type === type && event.fn === fn), 1);\n        remove(type, fn);\n    };\n\n    return {\n        write: () => {\n            // not busy\n            return true;\n        },\n        destroy: () => {\n            events.forEach(event => {\n                remove(event.type, event.fn);\n            });\n        },\n    };\n};\n\n// add to external api and link to props\n\nconst apis = ({ mixinConfig, viewProps, viewExternalAPI }) => {\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n};\n\nconst isDefined = value => value != null;\n\n// add to state,\n// add getters and setters to internal and external api (if not set)\n// set initial state based on props in viewProps\n// apply as transforms each frame\n\nconst defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0,\n};\n\nconst styles = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI, view }) => {\n    // initial props\n    const initialProps = { ...viewProps };\n\n    // current props\n    const currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    const getOffset = () => [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    const getScale = () => [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    const getRect = () =>\n        view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    viewInternalAPI.rect = { get: getRect };\n    viewExternalAPI.rect = { get: getRect };\n\n    // apply view props\n    mixinConfig.forEach(key => {\n        viewProps[key] =\n            typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    });\n\n    // expose api\n    return {\n        write: () => {\n            // see if props have changed\n            if (!propsHaveChanged(currentProps, viewProps)) {\n                return;\n            }\n\n            // moves element to correct position on screen\n            applyStyles(view.element, viewProps);\n\n            // store new transforms\n            Object.assign(currentProps, { ...viewProps });\n\n            // no longer busy\n            return true;\n        },\n        destroy: () => {},\n    };\n};\n\nconst propsHaveChanged = (currentProps, newProps) => {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n        return true;\n    }\n\n    // lets analyze the individual props\n    for (const prop in newProps) {\n        if (newProps[prop] !== currentProps[prop]) {\n            return true;\n        }\n    }\n\n    return false;\n};\n\nconst applyStyles = (\n    element,\n    {\n        opacity,\n        perspective,\n        translateX,\n        translateY,\n        scaleX,\n        scaleY,\n        rotateX,\n        rotateY,\n        rotateZ,\n        originX,\n        originY,\n        width,\n        height,\n    }\n) => {\n    let transforms = '';\n    let styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n        styles += `transform-origin: ${originX || 0}px ${originY || 0}px;`;\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n        transforms += `perspective(${perspective}px) `;\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n        transforms += `translate3d(${translateX || 0}px, ${translateY || 0}px, 0) `;\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n        transforms += `scale3d(${isDefined(scaleX) ? scaleX : 1}, ${\n            isDefined(scaleY) ? scaleY : 1\n        }, 1) `;\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n        transforms += `rotateZ(${rotateZ}rad) `;\n    }\n\n    if (isDefined(rotateX)) {\n        transforms += `rotateX(${rotateX}rad) `;\n    }\n\n    if (isDefined(rotateY)) {\n        transforms += `rotateY(${rotateY}rad) `;\n    }\n\n    // add transforms\n    if (transforms.length) {\n        styles += `transform:${transforms};`;\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n        styles += `opacity:${opacity};`;\n\n        // if we reach zero, we make the element inaccessible\n        if (opacity === 0) {\n            styles += `visibility:hidden;`;\n        }\n\n        // if we're below 100% opacity this element can't be clicked\n        if (opacity < 1) {\n            styles += `pointer-events:none;`;\n        }\n    }\n\n    // add height\n    if (isDefined(height)) {\n        styles += `height:${height}px;`;\n    }\n\n    // add width\n    if (isDefined(width)) {\n        styles += `width:${width}px;`;\n    }\n\n    // apply styles\n    const elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n        element.style.cssText = styles;\n        // store current styles so we can compare them to new styles later on\n        // _not_ getting the style value is faster\n        element.elementCurrentStyle = styles;\n    }\n};\n\nconst Mixins = {\n    styles,\n    listeners,\n    animations,\n    apis,\n};\n\nconst updateRect = (rect = {}, element = {}, style = {}) => {\n    if (!element.layoutCalculated) {\n        rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n        rect.marginTop = parseInt(style.marginTop, 10) || 0;\n        rect.marginRight = parseInt(style.marginRight, 10) || 0;\n        rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n        rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n        element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n\n    rect.scrollTop = element.scrollTop;\n\n    rect.hidden = element.offsetParent === null;\n\n    return rect;\n};\n\nconst createView =\n    // default view definition\n    ({\n        // element definition\n        tag = 'div',\n        name = null,\n        attributes = {},\n\n        // view interaction\n        read = () => {},\n        write = () => {},\n        create = () => {},\n        destroy = () => {},\n\n        // hooks\n        filterFrameActionsForChild = (child, actions) => actions,\n        didCreateView = () => {},\n        didWriteView = () => {},\n\n        // rect related\n        ignoreRect = false,\n        ignoreRectUpdate = false,\n\n        // mixins\n        mixins = [],\n    } = {}) => (\n        // each view requires reference to store\n        store,\n        // specific properties for this view\n        props = {}\n    ) => {\n        // root element should not be changed\n        const element = createElement(tag, `filepond--${name}`, attributes);\n\n        // style reference should also not be changed\n        const style = window.getComputedStyle(element, null);\n\n        // element rectangle\n        const rect = updateRect();\n        let frameRect = null;\n\n        // rest state\n        let isResting = false;\n\n        // pretty self explanatory\n        const childViews = [];\n\n        // loaded mixins\n        const activeMixins = [];\n\n        // references to created children\n        const ref = {};\n\n        // state used for each instance\n        const state = {};\n\n        // list of writers that will be called to update this view\n        const writers = [\n            write, // default writer\n        ];\n\n        const readers = [\n            read, // default reader\n        ];\n\n        const destroyers = [\n            destroy, // default destroy\n        ];\n\n        // core view methods\n        const getElement = () => element;\n        const getChildViews = () => childViews.concat();\n        const getReference = () => ref;\n        const createChildView = store => (view, props) => view(store, props);\n        const getRect = () => {\n            if (frameRect) {\n                return frameRect;\n            }\n            frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n            return frameRect;\n        };\n        const getStyle = () => style;\n\n        /**\n         * Read data from DOM\n         * @private\n         */\n        const _read = () => {\n            frameRect = null;\n\n            // read child views\n            childViews.forEach(child => child._read());\n\n            const shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n            if (shouldUpdate) {\n                updateRect(rect, element, style);\n            }\n\n            // readers\n            const api = { root: internalAPI, props, rect };\n            readers.forEach(reader => reader(api));\n        };\n\n        /**\n         * Write data to DOM\n         * @private\n         */\n        const _write = (ts, frameActions, shouldOptimize) => {\n            // if no actions, we assume that the view is resting\n            let resting = frameActions.length === 0;\n\n            // writers\n            writers.forEach(writer => {\n                const writerResting = writer({\n                    props,\n                    root: internalAPI,\n                    actions: frameActions,\n                    timestamp: ts,\n                    shouldOptimize,\n                });\n                if (writerResting === false) {\n                    resting = false;\n                }\n            });\n\n            // run mixins\n            activeMixins.forEach(mixin => {\n                // if one of the mixins is still busy after write operation, we are not resting\n                const mixinResting = mixin.write(ts);\n                if (mixinResting === false) {\n                    resting = false;\n                }\n            });\n\n            // updates child views that are currently attached to the DOM\n            childViews\n                .filter(child => !!child.element.parentNode)\n                .forEach(child => {\n                    // if a child view is not resting, we are not resting\n                    const childResting = child._write(\n                        ts,\n                        filterFrameActionsForChild(child, frameActions),\n                        shouldOptimize\n                    );\n                    if (!childResting) {\n                        resting = false;\n                    }\n                });\n\n            // append new elements to DOM and update those\n            childViews\n                //.filter(child => !child.element.parentNode)\n                .forEach((child, index) => {\n                    // skip\n                    if (child.element.parentNode) {\n                        return;\n                    }\n\n                    // append to DOM\n                    internalAPI.appendChild(child.element, index);\n\n                    // call read (need to know the size of these elements)\n                    child._read();\n\n                    // re-call write\n                    child._write(\n                        ts,\n                        filterFrameActionsForChild(child, frameActions),\n                        shouldOptimize\n                    );\n\n                    // we just added somthing to the dom, no rest\n                    resting = false;\n                });\n\n            // update resting state\n            isResting = resting;\n\n            didWriteView({\n                props,\n                root: internalAPI,\n                actions: frameActions,\n                timestamp: ts,\n            });\n\n            // let parent know if we are resting\n            return resting;\n        };\n\n        const _destroy = () => {\n            activeMixins.forEach(mixin => mixin.destroy());\n            destroyers.forEach(destroyer => {\n                destroyer({ root: internalAPI, props });\n            });\n            childViews.forEach(child => child._destroy());\n        };\n\n        // sharedAPI\n        const sharedAPIDefinition = {\n            element: {\n                get: getElement,\n            },\n            style: {\n                get: getStyle,\n            },\n            childViews: {\n                get: getChildViews,\n            },\n        };\n\n        // private API definition\n        const internalAPIDefinition = {\n            ...sharedAPIDefinition,\n            rect: {\n                get: getRect,\n            },\n\n            // access to custom children references\n            ref: {\n                get: getReference,\n            },\n\n            // dom modifiers\n            is: needle => name === needle,\n            appendChild: appendChild(element),\n            createChildView: createChildView(store),\n            linkView: view => {\n                childViews.push(view);\n                return view;\n            },\n            unlinkView: view => {\n                childViews.splice(childViews.indexOf(view), 1);\n            },\n            appendChildView: appendChildView(element, childViews),\n            removeChildView: removeChildView(element, childViews),\n            registerWriter: writer => writers.push(writer),\n            registerReader: reader => readers.push(reader),\n            registerDestroyer: destroyer => destroyers.push(destroyer),\n            invalidateLayout: () => (element.layoutCalculated = false),\n\n            // access to data store\n            dispatch: store.dispatch,\n            query: store.query,\n        };\n\n        // public view API methods\n        const externalAPIDefinition = {\n            element: {\n                get: getElement,\n            },\n            childViews: {\n                get: getChildViews,\n            },\n            rect: {\n                get: getRect,\n            },\n            resting: {\n                get: () => isResting,\n            },\n            isRectIgnored: () => ignoreRect,\n            _read,\n            _write,\n            _destroy,\n        };\n\n        // mixin API methods\n        const mixinAPIDefinition = {\n            ...sharedAPIDefinition,\n            rect: {\n                get: () => rect,\n            },\n        };\n\n        // add mixin functionality\n        Object.keys(mixins)\n            .sort((a, b) => {\n                // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n                if (a === 'styles') {\n                    return 1;\n                } else if (b === 'styles') {\n                    return -1;\n                }\n                return 0;\n            })\n            .forEach(key => {\n                const mixinAPI = Mixins[key]({\n                    mixinConfig: mixins[key],\n                    viewProps: props,\n                    viewState: state,\n                    viewInternalAPI: internalAPIDefinition,\n                    viewExternalAPI: externalAPIDefinition,\n                    view: createObject(mixinAPIDefinition),\n                });\n\n                if (mixinAPI) {\n                    activeMixins.push(mixinAPI);\n                }\n            });\n\n        // construct private api\n        const internalAPI = createObject(internalAPIDefinition);\n\n        // create the view\n        create({\n            root: internalAPI,\n            props,\n        });\n\n        // append created child views to root node\n        const childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n        childViews.forEach((child, index) => {\n            internalAPI.appendChild(child.element, childCount + index);\n        });\n\n        // call did create\n        didCreateView(internalAPI);\n\n        // expose public api\n        return createObject(externalAPIDefinition);\n    };\n\nconst createPainter = (read, write, fps = 60) => {\n    const name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n        window[name].readers.push(read);\n        window[name].writers.push(write);\n        return;\n    }\n\n    window[name] = {\n        readers: [read],\n        writers: [write],\n    };\n\n    const painter = window[name];\n\n    const interval = 1000 / fps;\n    let last = null;\n    let id = null;\n    let requestTick = null;\n    let cancelTick = null;\n\n    const setTimerType = () => {\n        if (document.hidden) {\n            requestTick = () => window.setTimeout(() => tick(performance.now()), interval);\n            cancelTick = () => window.clearTimeout(id);\n        } else {\n            requestTick = () => window.requestAnimationFrame(tick);\n            cancelTick = () => window.cancelAnimationFrame(id);\n        }\n    };\n\n    document.addEventListener('visibilitychange', () => {\n        if (cancelTick) cancelTick();\n        setTimerType();\n        tick(performance.now());\n    });\n\n    const tick = ts => {\n        // queue next tick\n        id = requestTick(tick);\n\n        // limit fps\n        if (!last) {\n            last = ts;\n        }\n\n        const delta = ts - last;\n\n        if (delta <= interval) {\n            // skip frame\n            return;\n        }\n\n        // align next frame\n        last = ts - (delta % interval);\n\n        // update view\n        painter.readers.forEach(read => read());\n        painter.writers.forEach(write => write(ts));\n    };\n\n    setTimerType();\n    tick(performance.now());\n\n    return {\n        pause: () => {\n            cancelTick(id);\n        },\n    };\n};\n\nconst createRoute = (routes, fn) => ({ root, props, actions = [], timestamp, shouldOptimize }) => {\n    actions\n        .filter(action => routes[action.type])\n        .forEach(action =>\n            routes[action.type]({ root, props, action: action.data, timestamp, shouldOptimize })\n        );\n    if (fn) {\n        fn({ root, props, actions, timestamp, shouldOptimize });\n    }\n};\n\nconst insertBefore = (newNode, referenceNode) =>\n    referenceNode.parentNode.insertBefore(newNode, referenceNode);\n\nconst insertAfter = (newNode, referenceNode) => {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n};\n\nconst isArray = value => Array.isArray(value);\n\nconst isEmpty = value => value == null;\n\nconst trim = str => str.trim();\n\nconst toString = value => '' + value;\n\nconst toArray = (value, splitter = ',') => {\n    if (isEmpty(value)) {\n        return [];\n    }\n    if (isArray(value)) {\n        return value;\n    }\n    return toString(value)\n        .split(splitter)\n        .map(trim)\n        .filter(str => str.length);\n};\n\nconst isBoolean = value => typeof value === 'boolean';\n\nconst toBoolean = value => (isBoolean(value) ? value : value === 'true');\n\nconst isString = value => typeof value === 'string';\n\nconst toNumber = value =>\n    isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n\nconst toInt = value => parseInt(toNumber(value), 10);\n\nconst toFloat = value => parseFloat(toNumber(value));\n\nconst isInt = value => isNumber(value) && isFinite(value) && Math.floor(value) === value;\n\nconst toBytes = (value, base = 1000) => {\n    // is in bytes\n    if (isInt(value)) {\n        return value;\n    }\n\n    // is natural file size\n    let naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n        naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n        return toInt(naturalFileSize) * base * base;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n        naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n        return toInt(naturalFileSize) * base;\n    }\n\n    return toInt(naturalFileSize);\n};\n\nconst isFunction = value => typeof value === 'function';\n\nconst toFunctionReference = string => {\n    let ref = self;\n    let levels = string.split('.');\n    let level = null;\n    while ((level = levels.shift())) {\n        ref = ref[level];\n        if (!ref) {\n            return null;\n        }\n    }\n    return ref;\n};\n\nconst methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET',\n};\n\nconst createServerAPI = outline => {\n    const api = {};\n\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n\n    forin(methods, key => {\n        api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    });\n\n    // remove process if no url or process on outline\n    api.process = outline.process || isString(outline) || outline.url ? api.process : null;\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n\n    return api;\n};\n\nconst createAction = (name, outline, method, timeout, headers) => {\n    // is explicitely set to null so disable\n    if (outline === null) {\n        return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n        return outline;\n    }\n\n    // build action object\n    const action = {\n        url: method === 'GET' || method === 'PATCH' ? `?${name}=` : '',\n        method,\n        headers,\n        withCredentials: false,\n        timeout,\n        onload: null,\n        ondata: null,\n        onerror: null,\n    };\n\n    // is a single url\n    if (isString(outline)) {\n        action.url = outline;\n        return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n        const parts = action.headers.split(/:(.+)/);\n        action.headers = {\n            header: parts[0],\n            value: parts[1],\n        };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n\n    return action;\n};\n\nconst toServerAPI = value => createServerAPI(value);\n\nconst isNull = value => value === null;\n\nconst isObject = value => typeof value === 'object' && value !== null;\n\nconst isAPI = value => {\n    return (\n        isObject(value) &&\n        isString(value.url) &&\n        isObject(value.process) &&\n        isObject(value.revert) &&\n        isObject(value.restore) &&\n        isObject(value.fetch)\n    );\n};\n\nconst getType = value => {\n    if (isArray(value)) {\n        return 'array';\n    }\n\n    if (isNull(value)) {\n        return 'null';\n    }\n\n    if (isInt(value)) {\n        return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n        return 'bytes';\n    }\n\n    if (isAPI(value)) {\n        return 'api';\n    }\n\n    return typeof value;\n};\n\nconst replaceSingleQuotes = str =>\n    str\n        .replace(/{\\s*'/g, '{\"')\n        .replace(/'\\s*}/g, '\"}')\n        .replace(/'\\s*:/g, '\":')\n        .replace(/:\\s*'/g, ':\"')\n        .replace(/,\\s*'/g, ',\"')\n        .replace(/'\\s*,/g, '\",');\n\nconst conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: value => (getType(value) === 'bytes' ? toBytes(value) : toInt(value)),\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: value => (isFunction(value) ? value : toString(value)),\n    function: value => toFunctionReference(value),\n    serverapi: toServerAPI,\n    object: value => {\n        try {\n            return JSON.parse(replaceSingleQuotes(value));\n        } catch (e) {\n            return null;\n        }\n    },\n};\n\nconst convertTo = (value, type) => conversionTable[type](value);\n\nconst getValueByType = (newValue, defaultValue, valueType) => {\n    // can always assign default value\n    if (newValue === defaultValue) {\n        return newValue;\n    }\n\n    // get the type of the new value\n    let newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n        // is string input, let's attempt to convert\n        const convertedValue = convertTo(newValue, valueType);\n\n        // what is the type now\n        newValueType = getType(convertedValue);\n\n        // no valid conversions found\n        if (convertedValue === null) {\n            throw `Trying to assign value with incorrect type to \"${option}\", allowed type: \"${valueType}\"`;\n        } else {\n            newValue = convertedValue;\n        }\n    }\n\n    // assign new value\n    return newValue;\n};\n\nconst createOption = (defaultValue, valueType) => {\n    let currentValue = defaultValue;\n    return {\n        enumerable: true,\n        get: () => currentValue,\n        set: newValue => {\n            currentValue = getValueByType(newValue, defaultValue, valueType);\n        },\n    };\n};\n\nconst createOptions = options => {\n    const obj = {};\n    forin(options, prop => {\n        const optionDefinition = options[prop];\n        obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n};\n\nconst createInitialState = options => ({\n    // model\n    items: [],\n\n    // timeout used for calling update items\n    listUpdateTimeout: null,\n\n    // timeout used for stacking metadata updates\n    itemUpdateTimeout: null,\n\n    // queue of items waiting to be processed\n    processingQueue: [],\n\n    // options\n    options: createOptions(options),\n});\n\nconst fromCamels = (string, separator = '-') =>\n    string\n        .split(/(?=[A-Z])/)\n        .map(part => part.toLowerCase())\n        .join(separator);\n\nconst createOptionAPI = (store, options) => {\n    const obj = {};\n    forin(options, key => {\n        obj[key] = {\n            get: () => store.getState().options[key],\n            set: value => {\n                store.dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\n                    value,\n                });\n            },\n        };\n    });\n    return obj;\n};\n\nconst createOptionActions = options => (dispatch, query, state) => {\n    const obj = {};\n    forin(options, key => {\n        const name = fromCamels(key, '_').toUpperCase();\n\n        obj[`SET_${name}`] = action => {\n            try {\n                state.options[key] = action.value;\n            } catch (e) {\n                // nope, failed\n            }\n\n            // we successfully set the value of this option\n            dispatch(`DID_SET_${name}`, { value: state.options[key] });\n        };\n    });\n    return obj;\n};\n\nconst createOptionQueries = options => state => {\n    const obj = {};\n    forin(options, key => {\n        obj[`GET_${fromCamels(key, '_').toUpperCase()}`] = action => state.options[key];\n    });\n    return obj;\n};\n\nconst InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5,\n};\n\nconst getUniqueId = () =>\n    Math.random()\n        .toString(36)\n        .substring(2, 11);\n\nconst arrayRemove = (arr, index) => arr.splice(index, 1);\n\nconst run = (cb, sync) => {\n    if (sync) {\n        cb();\n    } else if (document.hidden) {\n        Promise.resolve(1).then(cb);\n    } else {\n        setTimeout(cb, 0);\n    }\n};\n\nconst on = () => {\n    const listeners = [];\n    const off = (event, cb) => {\n        arrayRemove(\n            listeners,\n            listeners.findIndex(listener => listener.event === event && (listener.cb === cb || !cb))\n        );\n    };\n    const fire = (event, args, sync) => {\n        listeners\n            .filter(listener => listener.event === event)\n            .map(listener => listener.cb)\n            .forEach(cb => run(() => cb(...args), sync));\n    };\n    return {\n        fireSync: (event, ...args) => {\n            fire(event, args, true);\n        },\n        fire: (event, ...args) => {\n            fire(event, args, false);\n        },\n        on: (event, cb) => {\n            listeners.push({ event, cb });\n        },\n        onOnce: (event, cb) => {\n            listeners.push({\n                event,\n                cb: (...args) => {\n                    off(event, cb);\n                    cb(...args);\n                },\n            });\n        },\n        off,\n    };\n};\n\nconst copyObjectPropertiesToObject = (src, target, excluded) => {\n    Object.getOwnPropertyNames(src)\n        .filter(property => !excluded.includes(property))\n        .forEach(key =>\n            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key))\n        );\n};\n\nconst PRIVATE = [\n    'fire',\n    'process',\n    'revert',\n    'load',\n    'on',\n    'off',\n    'onOnce',\n    'retryLoad',\n    'extend',\n    'archive',\n    'archived',\n    'release',\n    'released',\n    'requestProcessing',\n    'freeze',\n];\n\nconst createItemAPI = item => {\n    const api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n};\n\nconst removeReleasedItems = items => {\n    items.forEach((item, index) => {\n        if (item.released) {\n            arrayRemove(items, index);\n        }\n    });\n};\n\nconst ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8,\n};\n\nconst FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3,\n};\n\nconst getNonNumeric = str => /[^0-9]+/.exec(str);\n\nconst getDecimalSeparator = () => getNonNumeric((1.1).toLocaleString())[0];\n\nconst getThousandsSeparator = () => {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    const decimalSeparator = getDecimalSeparator();\n    const thousandsStringWithSeparator = (1000.0).toLocaleString();\n    const thousandsStringWithoutSeparator = (1000.0).toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n        return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n};\n\nconst Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex',\n};\n\n// all registered filters\nconst filters = [];\n\n// loops over matching filters and passes options to each filter, returning the mapped results\nconst applyFilterChain = (key, value, utils) =>\n    new Promise((resolve, reject) => {\n        // find matching filters for this key\n        const matchingFilters = filters.filter(f => f.key === key).map(f => f.cb);\n\n        // resolve now\n        if (matchingFilters.length === 0) {\n            resolve(value);\n            return;\n        }\n\n        // first filter to kick things of\n        const initialFilter = matchingFilters.shift();\n\n        // chain filters\n        matchingFilters\n            .reduce(\n                // loop over promises passing value to next promise\n                (current, next) => current.then(value => next(value, utils)),\n\n                // call initial filter, will return a promise\n                initialFilter(value, utils)\n\n                // all executed\n            )\n            .then(value => resolve(value))\n            .catch(error => reject(error));\n    });\n\nconst applyFilters = (key, value, utils) =>\n    filters.filter(f => f.key === key).map(f => f.cb(value, utils));\n\n// adds a new filter to the list\nconst addFilter = (key, cb) => filters.push({ key, cb });\n\nconst extendDefaultOptions = additionalOptions => Object.assign(defaultOptions, additionalOptions);\n\nconst getOptions = () => ({ ...defaultOptions });\n\nconst setOptions = opts => {\n    forin(opts, (key, value) => {\n        // key does not exist, so this option cannot be set\n        if (!defaultOptions[key]) {\n            return;\n        }\n        defaultOptions[key][0] = getValueByType(\n            value,\n            defaultOptions[key][0],\n            defaultOptions[key][1]\n        );\n    });\n};\n\n// default options on app\nconst defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n\n    // input field name to use\n    name: ['filepond', Type.STRING],\n\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n\n    // is the field required\n    required: [false, Type.BOOLEAN],\n\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // sync `acceptedFileTypes` property with `accept` attribute\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n    allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file\n    allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button\n    allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n    // Try store file if `server` not set\n    storeAsFile: [false, Type.BOOLEAN],\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT], // Max number of files\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n    allowMinimumUploadDuration: [true, Type.BOOLEAN], // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY], // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n    fileSizeBase: [1000, Type.INT],\n\n    // Labels and status messages\n    labelFileSizeBytes: ['bytes', Type.STRING],\n    labelFileSizeKilobytes: ['KB', Type.STRING],\n    labelFileSizeMegabytes: ['MB', Type.STRING],\n    labelFileSizeGigabytes: ['GB', Type.STRING],\n\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n    labelIdle: [\n        'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n        Type.STRING,\n    ],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING], // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconProcess: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n        Type.STRING,\n    ],\n    iconRetry: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconUndo: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconDone: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    oninitfile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    beforePrepareFile: [null, Type.FUNCTION],\n\n    // styles\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n\n    // custom initial files array\n    files: [[], Type.ARRAY],\n\n    // show support by displaying credits\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY],\n};\n\nconst getItemByQuery = (items, query) => {\n    // just return first index\n    if (isEmpty(query)) {\n        return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n        return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n        query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return items.find(item => item.id === query) || null;\n};\n\nconst getNumericAspectRatioFromString = aspectRatio => {\n    if (isEmpty(aspectRatio)) {\n        return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n        const parts = aspectRatio.split(':');\n        return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n};\n\nconst getActiveItems = items => items.filter(item => !item.archived);\n\nconst Status = {\n    EMPTY: 0,\n    IDLE: 1, // waiting\n    ERROR: 2, // a file is in error state\n    BUSY: 3, // busy processing or loading\n    READY: 4, // all files uploaded\n};\n\nlet res = null;\nconst canUpdateFileInput = () => {\n    if (res === null) {\n        try {\n            const dataTransfer = new DataTransfer();\n            dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));\n            const el = document.createElement('input');\n            el.setAttribute('type', 'file');\n            el.files = dataTransfer.files;\n            res = el.files.length === 1;\n        } catch (err) {\n            res = false;\n        }\n    }\n    return res;\n};\n\nconst ITEM_ERROR = [\n    ItemStatus.LOAD_ERROR,\n    ItemStatus.PROCESSING_ERROR,\n    ItemStatus.PROCESSING_REVERT_ERROR,\n];\nconst ITEM_BUSY = [\n    ItemStatus.LOADING,\n    ItemStatus.PROCESSING,\n    ItemStatus.PROCESSING_QUEUED,\n    ItemStatus.INIT,\n];\nconst ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\nconst isItemInErrorState = item => ITEM_ERROR.includes(item.status);\nconst isItemInBusyState = item => ITEM_BUSY.includes(item.status);\nconst isItemInReadyState = item => ITEM_READY.includes(item.status);\n\nconst isAsync = state =>\n    isObject(state.options.server) &&\n    (isObject(state.options.server.process) || isFunction(state.options.server.process));\n\nconst queries = state => ({\n    GET_STATUS: () => {\n        const items = getActiveItems(state.items);\n\n        const { EMPTY, ERROR, BUSY, IDLE, READY } = Status;\n\n        if (items.length === 0) return EMPTY;\n\n        if (items.some(isItemInErrorState)) return ERROR;\n\n        if (items.some(isItemInBusyState)) return BUSY;\n\n        if (items.some(isItemInReadyState)) return READY;\n\n        return IDLE;\n    },\n\n    GET_ITEM: query => getItemByQuery(state.items, query),\n\n    GET_ACTIVE_ITEM: query => getItemByQuery(getActiveItems(state.items), query),\n\n    GET_ACTIVE_ITEMS: () => getActiveItems(state.items),\n\n    GET_ITEMS: () => state.items,\n\n    GET_ITEM_NAME: query => {\n        const item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n    },\n\n    GET_ITEM_SIZE: query => {\n        const item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n    },\n\n    GET_STYLES: () =>\n        Object.keys(state.options)\n            .filter(key => /^style/.test(key))\n            .map(option => ({\n                name: option,\n                value: state.options[option],\n            })),\n\n    GET_PANEL_ASPECT_RATIO: () => {\n        const isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        const aspectRatio = isShapeCircle\n            ? 1\n            : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n    },\n\n    GET_ITEM_PANEL_ASPECT_RATIO: () => state.options.styleItemPanelAspectRatio,\n\n    GET_ITEMS_BY_STATUS: status =>\n        getActiveItems(state.items).filter(item => item.status === status),\n\n    GET_TOTAL_ITEMS: () => getActiveItems(state.items).length,\n\n    SHOULD_UPDATE_FILE_INPUT: () =>\n        state.options.storeAsFile && canUpdateFileInput() && !isAsync(state),\n\n    IS_ASYNC: () => isAsync(state),\n\n    GET_FILE_SIZE_LABELS: query => ({\n        labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,\n        labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,\n        labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,\n        labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined,\n    }),\n});\n\nconst hasRoomForItem = state => {\n    const count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n        return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    const maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n        return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n        return true;\n    }\n\n    // no more room for another file\n    return false;\n};\n\nconst limit = (value, min, max) => Math.max(Math.min(max, value), min);\n\nconst arrayInsert = (arr, index, item) => arr.splice(index, 0, item);\n\nconst insertItem = (items, item, index) => {\n    if (isEmpty(item)) {\n        return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n        items.push(item);\n        return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n};\n\nconst isBase64DataURI = str =>\n    /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n        str\n    );\n\nconst getFilenameFromURL = url =>\n    `${url}`\n        .split('/')\n        .pop()\n        .split('?')\n        .shift();\n\nconst getExtensionFromFilename = name => name.split('.').pop();\n\nconst guesstimateExtension = type => {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n        return '';\n    }\n\n    // get subtype\n    const subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n        return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n        return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n        return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n        return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n        // always use jpg extension\n        if (subtype === 'jpeg') {\n            return 'jpg';\n        }\n\n        // return subtype\n        return subtype;\n    }\n\n    return '';\n};\n\nconst leftPad = (value, padding = '') => (padding + value).slice(-padding.length);\n\nconst getDateString = (date = new Date()) =>\n    `${date.getFullYear()}-${leftPad(date.getMonth() + 1, '00')}-${leftPad(\n        date.getDate(),\n        '00'\n    )}_${leftPad(date.getHours(), '00')}-${leftPad(date.getMinutes(), '00')}-${leftPad(\n        date.getSeconds(),\n        '00'\n    )}`;\n\nconst getFileFromBlob = (blob, filename, type = null, extension = null) => {\n    const file =\n        typeof type === 'string'\n            ? blob.slice(0, blob.size, type)\n            : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // copy relative path\n    if (blob._relativePath) file._relativePath = blob._relativePath;\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n        filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n        file.name = filename;\n    } else {\n        extension = extension || guesstimateExtension(file.type);\n        file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n};\n\nconst getBlobBuilder = () => {\n    return (window.BlobBuilder =\n        window.BlobBuilder ||\n        window.WebKitBlobBuilder ||\n        window.MozBlobBuilder ||\n        window.MSBlobBuilder);\n};\n\nconst createBlob = (arrayBuffer, mimeType) => {\n    const BB = getBlobBuilder();\n\n    if (BB) {\n        const bb = new BB();\n        bb.append(arrayBuffer);\n        return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n        type: mimeType,\n    });\n};\n\nconst getBlobFromByteStringWithMimeType = (byteString, mimeType) => {\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n\n    for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n};\n\nconst getMimeTypeFromBase64DataURI = dataURI => {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n};\n\nconst getBase64DataFromBase64DataURI = dataURI => {\n    // get data part of string (remove data:image/jpeg...,)\n    const data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n};\n\nconst getByteStringFromBase64DataURI = dataURI => {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n};\n\nconst getBlobFromBase64DataURI = dataURI => {\n    const mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    const byteString = getByteStringFromBase64DataURI(dataURI);\n\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n};\n\nconst getFileFromBase64DataURI = (dataURI, filename, extension) => {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n};\n\nconst getFileNameFromHeader = header => {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    const matches = header\n        .split(/filename=|filename\\*=.+''/)\n        .splice(1)\n        .map(name => name.trim().replace(/^[\"']|[;\"']{0,2}$/g, ''))\n        .filter(name => name.length);\n\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n};\n\nconst getFileSizeFromHeader = header => {\n    if (/content-length:/i.test(header)) {\n        const size = header.match(/[0-9]+/)[0];\n        return size ? parseInt(size, 10) : null;\n    }\n    return null;\n};\n\nconst getTranfserIdFromHeader = header => {\n    if (/x-content-transfer-id:/i.test(header)) {\n        const id = (header.split(':')[1] || '').trim();\n        return id || null;\n    }\n    return null;\n};\n\nconst getFileInfoFromHeaders = headers => {\n    const info = {\n        source: null,\n        name: null,\n        size: null,\n    };\n\n    const rows = headers.split('\\n');\n    for (let header of rows) {\n        const name = getFileNameFromHeader(header);\n        if (name) {\n            info.name = name;\n            continue;\n        }\n\n        const size = getFileSizeFromHeader(header);\n        if (size) {\n            info.size = size;\n            continue;\n        }\n\n        const source = getTranfserIdFromHeader(header);\n        if (source) {\n            info.source = source;\n            continue;\n        }\n    }\n\n    return info;\n};\n\nconst createFileLoader = fetchFn => {\n    const state = {\n        source: null,\n        complete: false,\n        progress: 0,\n        size: null,\n        timestamp: null,\n        duration: 0,\n        request: null,\n    };\n\n    const getProgress = () => state.progress;\n    const abort = () => {\n        if (state.request && state.request.abort) {\n            state.request.abort();\n        }\n    };\n\n    // load source\n    const load = () => {\n        // get quick reference\n        const source = state.source;\n\n        api.fire('init', source);\n\n        // Load Files\n        if (source instanceof File) {\n            api.fire('load', source);\n        } else if (source instanceof Blob) {\n            // Load blobs, set default name to current date\n            api.fire('load', getFileFromBlob(source, source.name));\n        } else if (isBase64DataURI(source)) {\n            // Load base 64, set default name to current date\n            api.fire('load', getFileFromBase64DataURI(source));\n        } else {\n            // Deal as if is external URL, let's load it!\n            loadURL(source);\n        }\n    };\n\n    // loads a url\n    const loadURL = url => {\n        // is remote url and no fetch method supplied\n        if (!fetchFn) {\n            api.fire('error', {\n                type: 'error',\n                body: \"Can't load URL\",\n                code: 400,\n            });\n            return;\n        }\n\n        // set request start\n        state.timestamp = Date.now();\n\n        // load file\n        state.request = fetchFn(\n            url,\n            response => {\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // done!\n                state.complete = true;\n\n                // turn blob response into a file\n                if (response instanceof Blob) {\n                    response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n                }\n\n                api.fire(\n                    'load',\n                    // if has received blob, we go with blob, if no response, we return null\n                    response instanceof Blob ? response : response ? response.body : null\n                );\n            },\n            error => {\n                api.fire(\n                    'error',\n                    typeof error === 'string'\n                        ? {\n                              type: 'error',\n                              code: 0,\n                              body: error,\n                          }\n                        : error\n                );\n            },\n            (computable, current, total) => {\n                // collected some meta data already\n                if (total) {\n                    state.size = total;\n                }\n\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // if we can't compute progress, we're not going to fire progress events\n                if (!computable) {\n                    state.progress = null;\n                    return;\n                }\n\n                // update progress percentage\n                state.progress = current / total;\n\n                // expose\n                api.fire('progress', state.progress);\n            },\n            () => {\n                api.fire('abort');\n            },\n            response => {\n                const fileinfo = getFileInfoFromHeaders(\n                    typeof response === 'string' ? response : response.headers\n                );\n                api.fire('meta', {\n                    size: state.size || fileinfo.size,\n                    filename: fileinfo.name,\n                    source: fileinfo.source,\n                });\n            }\n        );\n    };\n\n    const api = {\n        ...on(),\n        setSource: source => (state.source = source),\n        getProgress, // file load progress\n        abort, // abort file load\n        load, // start load\n    };\n\n    return api;\n};\n\nconst isGet = method => /GET|HEAD/.test(method);\n\nconst sendRequest = (data, url, options) => {\n    const api = {\n        onheaders: () => {},\n        onprogress: () => {},\n        onload: () => {},\n        ontimeout: () => {},\n        onerror: () => {},\n        onabort: () => {},\n        abort: () => {\n            aborted = true;\n            xhr.abort();\n        },\n    };\n\n    // timeout identifier, only used when timeout is defined\n    let aborted = false;\n    let headersReceived = false;\n\n    // set default options\n    options = {\n        method: 'POST',\n        headers: {},\n        withCredentials: false,\n        ...options,\n    };\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n        url = `${url}${encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data))}`;\n    }\n\n    // create request\n    const xhr = new XMLHttpRequest();\n\n    // progress of load\n    const process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = e => {\n        // no progress event when aborted ( onprogress is called once after abort() )\n        if (aborted) {\n            return;\n        }\n\n        api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = () => {\n        // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n        if (xhr.readyState < 2) {\n            return;\n        }\n\n        // no server response\n        if (xhr.readyState === 4 && xhr.status === 0) {\n            return;\n        }\n\n        if (headersReceived) {\n            return;\n        }\n\n        headersReceived = true;\n\n        // we've probably received some useful data in response headers\n        api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = () => {\n        // is classified as valid response\n        if (xhr.status >= 200 && xhr.status < 300) {\n            api.onload(xhr);\n        } else {\n            api.onerror(xhr);\n        }\n    };\n\n    // error during load\n    xhr.onerror = () => api.onerror(xhr);\n\n    // request aborted\n    xhr.onabort = () => {\n        aborted = true;\n        api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = () => api.ontimeout(xhr);\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n        xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(key => {\n        const value = unescape(encodeURIComponent(options.headers[key]));\n        xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n        xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n        xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n\n    return api;\n};\n\nconst createResponse = (type, code, body, headers) => ({\n    type,\n    code,\n    body,\n    headers,\n});\n\nconst createTimeoutResponse = cb => xhr => {\n    cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n};\n\nconst hasQS = str => /\\?/.test(str);\nconst buildURL = (...parts) => {\n    let url = '';\n    parts.forEach(part => {\n        url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n};\n\nconst createFetchFunction = (apiUrl = '', action) => {\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n        return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n        return null;\n    }\n\n    // set onload hanlder\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    // internal handler\n    return (url, load, error, progress, abort, headers) => {\n        // do local or remote request based on if the url is external\n        const request = sendRequest(url, buildURL(apiUrl, action.url), {\n            ...action,\n            responseType: 'blob',\n        });\n\n        request.onload = xhr => {\n            // get headers\n            const headers = xhr.getAllResponseHeaders();\n\n            // get filename\n            const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n            // create response\n            load(\n                createResponse(\n                    'load',\n                    xhr.status,\n                    action.method === 'HEAD'\n                        ? null\n                        : getFileFromBlob(onload(xhr.response), filename),\n                    headers\n                )\n            );\n        };\n\n        request.onerror = xhr => {\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.onheaders = xhr => {\n            headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n        };\n\n        request.ontimeout = createTimeoutResponse(error);\n        request.onprogress = progress;\n        request.onabort = abort;\n\n        // should return request\n        return request;\n    };\n};\n\nconst ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4,\n};\n\n/*\nfunction signature:\n  (file, metadata, load, error, progress, abort, transfer, options) => {\n    return {\n    abort:() => {}\n  }\n}\n*/\n\n// apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\nconst processFileChunked = (\n    apiUrl,\n    action,\n    name,\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer,\n    options\n) => {\n    // all chunks\n    const chunks = [];\n    const { chunkTransferId, chunkServer, chunkSize, chunkRetryDelays } = options;\n\n    // default state\n    const state = {\n        serverId: chunkTransferId,\n        aborted: false,\n    };\n\n    // set onload handlers\n    const ondata = action.ondata || (fd => fd);\n    const onload =\n        action.onload ||\n        ((xhr, method) =>\n            method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response);\n    const onerror = action.onerror || (res => null);\n\n    // create server hook\n    const requestTransferId = cb => {\n        const formData = new FormData();\n\n        // add metadata under same name\n        if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n        const headers =\n            typeof action.headers === 'function'\n                ? action.headers(file, metadata)\n                : {\n                      ...action.headers,\n                      'Upload-Length': file.size,\n                  };\n\n        const requestParams = {\n            ...action,\n            headers,\n        };\n\n        // send request object\n        const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\n\n        request.onerror = xhr =>\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n\n        request.ontimeout = createTimeoutResponse(error);\n    };\n\n    const requestTransferOffset = cb => {\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n        const headers =\n            typeof action.headers === 'function'\n                ? action.headers(state.serverId)\n                : {\n                      ...action.headers,\n                  };\n\n        const requestParams = {\n            headers,\n            method: 'HEAD',\n        };\n\n        const request = sendRequest(null, requestUrl, requestParams);\n\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\n\n        request.onerror = xhr =>\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n\n        request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    const lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (let i = 0; i <= lastChunkIndex; i++) {\n        const offset = i * chunkSize;\n        const data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n        chunks[i] = {\n            index: i,\n            size: data.size,\n            offset,\n            data,\n            file,\n            progress: 0,\n            retries: [...chunkRetryDelays],\n            status: ChunkStatus.QUEUED,\n            error: null,\n            request: null,\n            timeout: null,\n        };\n    }\n\n    const completeProcessingChunks = () => load(state.serverId);\n\n    const canProcessChunk = chunk =>\n        chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n\n    const processChunk = chunk => {\n        // processing is paused, wait here\n        if (state.aborted) return;\n\n        // get next chunk to process\n        chunk = chunk || chunks.find(canProcessChunk);\n\n        // no more chunks to process\n        if (!chunk) {\n            // all done?\n            if (chunks.every(chunk => chunk.status === ChunkStatus.COMPLETE)) {\n                completeProcessingChunks();\n            }\n\n            // no chunk to handle\n            return;\n        }\n\n        // now processing this chunk\n        chunk.status = ChunkStatus.PROCESSING;\n        chunk.progress = null;\n\n        // allow parsing of formdata\n        const ondata = chunkServer.ondata || (fd => fd);\n        const onerror = chunkServer.onerror || (res => null);\n        const onload = chunkServer.onload || (() => {});\n\n        // send request object\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n        const headers =\n            typeof chunkServer.headers === 'function'\n                ? chunkServer.headers(chunk)\n                : {\n                      ...chunkServer.headers,\n                      'Content-Type': 'application/offset+octet-stream',\n                      'Upload-Offset': chunk.offset,\n                      'Upload-Length': file.size,\n                      'Upload-Name': file.name,\n                  };\n\n        const request = (chunk.request = sendRequest(ondata(chunk.data), requestUrl, {\n            ...chunkServer,\n            headers,\n        }));\n\n        request.onload = xhr => {\n            // allow hooking into request result\n            onload(xhr, chunk.index, chunks.length);\n\n            // done!\n            chunk.status = ChunkStatus.COMPLETE;\n\n            // remove request reference\n            chunk.request = null;\n\n            // start processing more chunks\n            processChunks();\n        };\n\n        request.onprogress = (lengthComputable, loaded, total) => {\n            chunk.progress = lengthComputable ? loaded : null;\n            updateTotalProgress();\n        };\n\n        request.onerror = xhr => {\n            chunk.status = ChunkStatus.ERROR;\n            chunk.request = null;\n            chunk.error = onerror(xhr.response) || xhr.statusText;\n            if (!retryProcessChunk(chunk)) {\n                error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            }\n        };\n\n        request.ontimeout = xhr => {\n            chunk.status = ChunkStatus.ERROR;\n            chunk.request = null;\n            if (!retryProcessChunk(chunk)) {\n                createTimeoutResponse(error)(xhr);\n            }\n        };\n\n        request.onabort = () => {\n            chunk.status = ChunkStatus.QUEUED;\n            chunk.request = null;\n            abort();\n        };\n    };\n\n    const retryProcessChunk = chunk => {\n        // no more retries left\n        if (chunk.retries.length === 0) return false;\n\n        // new retry\n        chunk.status = ChunkStatus.WAITING;\n        clearTimeout(chunk.timeout);\n        chunk.timeout = setTimeout(() => {\n            processChunk(chunk);\n        }, chunk.retries.shift());\n\n        // we're going to retry\n        return true;\n    };\n\n    const updateTotalProgress = () => {\n        // calculate total progress fraction\n        const totalBytesTransfered = chunks.reduce((p, chunk) => {\n            if (p === null || chunk.progress === null) return null;\n            return p + chunk.progress;\n        }, 0);\n\n        // can't compute progress\n        if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n        // calculate progress values\n        const totalSize = chunks.reduce((total, chunk) => total + chunk.size, 0);\n\n        // can update progress indicator\n        progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    const processChunks = () => {\n        const totalProcessing = chunks.filter(chunk => chunk.status === ChunkStatus.PROCESSING)\n            .length;\n        if (totalProcessing >= 1) return;\n        processChunk();\n    };\n\n    const abortChunks = () => {\n        chunks.forEach(chunk => {\n            clearTimeout(chunk.timeout);\n            if (chunk.request) {\n                chunk.request.abort();\n            }\n        });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n        requestTransferId(serverId => {\n            // stop here if aborted, might have happened in between request and callback\n            if (state.aborted) return;\n\n            // pass back to item so we can use it if something goes wrong\n            transfer(serverId);\n\n            // store internally\n            state.serverId = serverId;\n            processChunks();\n        });\n    } else {\n        requestTransferOffset(offset => {\n            // stop here if aborted, might have happened in between request and callback\n            if (state.aborted) return;\n\n            // mark chunks with lower offset as complete\n            chunks\n                .filter(chunk => chunk.offset < offset)\n                .forEach(chunk => {\n                    chunk.status = ChunkStatus.COMPLETE;\n                    chunk.progress = chunk.size;\n                });\n\n            // continue processing\n            processChunks();\n        });\n    }\n\n    return {\n        abort: () => {\n            state.aborted = true;\n            abortChunks();\n        },\n    };\n};\n\n/*\nfunction signature:\n  (file, metadata, load, error, progress, abort) => {\n    return {\n    abort:() => {}\n  }\n}\n*/\nconst createFileProcessorFunction = (apiUrl, action, name, options) => (\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer\n) => {\n    // no file received\n    if (!file) return;\n\n    // if was passed a file, and we can chunk it, exit here\n    const canChunkUpload = options.chunkUploads;\n    const shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n    const willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n    if (file instanceof Blob && willChunkUpload)\n        return processFileChunked(\n            apiUrl,\n            action,\n            name,\n            file,\n            metadata,\n            load,\n            error,\n            progress,\n            abort,\n            transfer,\n            options\n        );\n\n    // set handlers\n    const ondata = action.ondata || (fd => fd);\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    const headers =\n        typeof action.headers === 'function'\n            ? action.headers(file, metadata) || {}\n            : {\n                  ...action.headers,\n              };\n\n    const requestParams = {\n        ...action,\n        headers,\n    };\n\n    // create formdata object\n    var formData = new FormData();\n\n    // add metadata under same name\n    if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n    }\n\n    // Turn into an array of objects so no matter what the input, we can handle it the same way\n    (file instanceof Blob ? [{ name: null, file }] : file).forEach(item => {\n        formData.append(\n            name,\n            item.file,\n            item.name === null ? item.file.name : `${item.name}${item.file.name}`\n        );\n    });\n\n    // send request object\n    const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n    request.onload = xhr => {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n    };\n\n    request.onerror = xhr => {\n        error(\n            createResponse(\n                'error',\n                xhr.status,\n                onerror(xhr.response) || xhr.statusText,\n                xhr.getAllResponseHeaders()\n            )\n        );\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n};\n\nconst createProcessorFunction = (apiUrl = '', action, name, options) => {\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') return (...params) => action(name, ...params, options);\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n};\n\n/*\n function signature:\n (uniqueFileId, load, error) => { }\n */\nconst createRevertFunction = (apiUrl = '', action) => {\n    // is custom implementation\n    if (typeof action === 'function') {\n        return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n        return (uniqueFileId, load) => load();\n    }\n\n    // set onload hanlder\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    // internal implementation\n    return (uniqueFileId, load, error) => {\n        const request = sendRequest(\n            uniqueFileId,\n            apiUrl + action.url,\n            action // contains method, headers and withCredentials properties\n        );\n        request.onload = xhr => {\n            load(\n                createResponse(\n                    'load',\n                    xhr.status,\n                    onload(xhr.response),\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.onerror = xhr => {\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.ontimeout = createTimeoutResponse(error);\n\n        return request;\n    };\n};\n\nconst getRandomNumber = (min = 0, max = 1) => min + Math.random() * (max - min);\n\nconst createPerceivedPerformanceUpdater = (\n    cb,\n    duration = 1000,\n    offset = 0,\n    tickMin = 25,\n    tickMax = 250\n) => {\n    let timeout = null;\n    const start = Date.now();\n\n    const tick = () => {\n        let runtime = Date.now() - start;\n        let delay = getRandomNumber(tickMin, tickMax);\n\n        if (runtime + delay > duration) {\n            delay = runtime + delay - duration;\n        }\n\n        let progress = runtime / duration;\n        if (progress >= 1 || document.hidden) {\n            cb(1);\n            return;\n        }\n\n        cb(progress);\n\n        timeout = setTimeout(tick, delay);\n    };\n\n    if (duration > 0) tick();\n\n    return {\n        clear: () => {\n            clearTimeout(timeout);\n        },\n    };\n};\n\nconst createFileProcessor = (processFn, options) => {\n    const state = {\n        complete: false,\n        perceivedProgress: 0,\n        perceivedPerformanceUpdater: null,\n        progress: null,\n        timestamp: null,\n        perceivedDuration: 0,\n        duration: 0,\n        request: null,\n        response: null,\n    };\n\n    const { allowMinimumUploadDuration } = options;\n\n    const process = (file, metadata) => {\n        const progressFn = () => {\n            // we've not yet started the real download, stop here\n            // the request might not go through, for instance, there might be some server trouble\n            // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n            if (state.duration === 0 || state.progress === null) return;\n\n            // as we're now processing, fire the progress event\n            api.fire('progress', api.getProgress());\n        };\n\n        const completeFn = () => {\n            state.complete = true;\n            api.fire('load-perceived', state.response.body);\n        };\n\n        // let's start processing\n        api.fire('start');\n\n        // set request start\n        state.timestamp = Date.now();\n\n        // create perceived performance progress indicator\n        state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n            progress => {\n                state.perceivedProgress = progress;\n                state.perceivedDuration = Date.now() - state.timestamp;\n\n                progressFn();\n\n                // if fake progress is done, and a response has been received,\n                // and we've not yet called the complete method\n                if (state.response && state.perceivedProgress === 1 && !state.complete) {\n                    // we done!\n                    completeFn();\n                }\n            },\n            // random delay as in a list of files you start noticing\n            // files uploading at the exact same speed\n            allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0\n        );\n\n        // remember request so we can abort it later\n        state.request = processFn(\n            // the file to process\n            file,\n\n            // the metadata to send along\n            metadata,\n\n            // callbacks (load, error, progress, abort, transfer)\n            // load expects the body to be a server id if\n            // you want to make use of revert\n            response => {\n                // we put the response in state so we can access\n                // it outside of this method\n                state.response = isObject(response)\n                    ? response\n                    : {\n                          type: 'load',\n                          code: 200,\n                          body: `${response}`,\n                          headers: {},\n                      };\n\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // force progress to 1 as we're now done\n                state.progress = 1;\n\n                // actual load is done let's share results\n                api.fire('load', state.response.body);\n\n                // we are really done\n                // if perceived progress is 1 ( wait for perceived progress to complete )\n                // or if server does not support progress ( null )\n                if (\n                    !allowMinimumUploadDuration ||\n                    (allowMinimumUploadDuration && state.perceivedProgress === 1)\n                ) {\n                    completeFn();\n                }\n            },\n\n            // error is expected to be an object with type, code, body\n            error => {\n                // cancel updater\n                state.perceivedPerformanceUpdater.clear();\n\n                // update others about this error\n                api.fire(\n                    'error',\n                    isObject(error)\n                        ? error\n                        : {\n                              type: 'error',\n                              code: 0,\n                              body: `${error}`,\n                          }\n                );\n            },\n\n            // actual processing progress\n            (computable, current, total) => {\n                // update actual duration\n                state.duration = Date.now() - state.timestamp;\n\n                // update actual progress\n                state.progress = computable ? current / total : null;\n\n                progressFn();\n            },\n\n            // abort does not expect a value\n            () => {\n                // stop updater\n                state.perceivedPerformanceUpdater.clear();\n\n                // fire the abort event so we can switch visuals\n                api.fire('abort', state.response ? state.response.body : null);\n            },\n\n            // register the id for this transfer\n            transferId => {\n                api.fire('transfer', transferId);\n            }\n        );\n    };\n\n    const abort = () => {\n        // no request running, can't abort\n        if (!state.request) return;\n\n        // stop updater\n        state.perceivedPerformanceUpdater.clear();\n\n        // abort actual request\n        if (state.request.abort) state.request.abort();\n\n        // if has response object, we've completed the request\n        state.complete = true;\n    };\n\n    const reset = () => {\n        abort();\n        state.complete = false;\n        state.perceivedProgress = 0;\n        state.progress = 0;\n        state.timestamp = null;\n        state.perceivedDuration = 0;\n        state.duration = 0;\n        state.request = null;\n        state.response = null;\n    };\n\n    const getProgress = allowMinimumUploadDuration\n        ? () => (state.progress ? Math.min(state.progress, state.perceivedProgress) : null)\n        : () => state.progress || null;\n\n    const getDuration = allowMinimumUploadDuration\n        ? () => Math.min(state.duration, state.perceivedDuration)\n        : () => state.duration;\n\n    const api = {\n        ...on(),\n        process, // start processing file\n        abort, // abort active process request\n        getProgress,\n        getDuration,\n        reset,\n    };\n\n    return api;\n};\n\nconst getFilenameWithoutExtension = name => name.substring(0, name.lastIndexOf('.')) || name;\n\nconst createFileStub = source => {\n    let data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n        data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n        // if is base64 data uri we need to determine the average size and type\n        data[1] = source.length;\n        data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n        // url\n        data[0] = getFilenameFromURL(source);\n        data[1] = 0;\n        data[2] = 'application/octet-stream';\n    }\n\n    return {\n        name: data[0],\n        size: data[1],\n        type: data[2],\n    };\n};\n\nconst isFile = value => !!(value instanceof File || (value instanceof Blob && value.name));\n\nconst deepCloneObject = src => {\n    if (!isObject(src)) return src;\n    const target = isArray(src) ? [] : {};\n    for (const key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        const v = src[key];\n        target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n};\n\nconst createItem = (origin = null, serverFileReference = null, file = null) => {\n    // unique id for this item, is used to identify the item across views\n    const id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    const state = {\n        // is archived\n        archived: false,\n\n        // if is frozen, no longer fires events\n        frozen: false,\n\n        // removed from view\n        released: false,\n\n        // original source\n        source: null,\n\n        // file model reference\n        file,\n\n        // id of file on server\n        serverFileReference,\n\n        // id of file transfer on server\n        transferId: null,\n\n        // is aborted\n        processingAborted: false,\n\n        // current item status\n        status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n\n        // active processes\n        activeLoader: null,\n        activeProcessor: null,\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    let abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    const metadata = {};\n\n    // item data\n    const setStatus = status => (state.status = status);\n\n    // fire event unless the item has been archived\n    const fire = (event, ...params) => {\n        if (state.released || state.frozen) return;\n        api.fire(event, ...params);\n    };\n\n    // file data\n    const getFileExtension = () => getExtensionFromFilename(state.file.name);\n    const getFileType = () => state.file.type;\n    const getFileSize = () => state.file.size;\n    const getFile = () => state.file;\n\n    //\n    // logic to load a file\n    //\n    const load = (source, loader, onload) => {\n        // remember the original item source\n        state.source = source;\n\n        // source is known\n        api.fireSync('init');\n\n        // file stub is already there\n        if (state.file) {\n            api.fireSync('load-skip');\n            return;\n        }\n\n        // set a stub file object while loading the actual data\n        state.file = createFileStub(source);\n\n        // starts loading\n        loader.on('init', () => {\n            fire('load-init');\n        });\n\n        // we'eve received a size indication, let's update the stub\n        loader.on('meta', meta => {\n            // set size of file stub\n            state.file.size = meta.size;\n\n            // set name of file stub\n            state.file.filename = meta.filename;\n\n            // if has received source, we done\n            if (meta.source) {\n                origin = FileOrigin.LIMBO;\n                state.serverFileReference = meta.source;\n                state.status = ItemStatus.PROCESSING_COMPLETE;\n            }\n\n            // size has been updated\n            fire('load-meta');\n        });\n\n        // the file is now loading we need to update the progress indicators\n        loader.on('progress', progress => {\n            setStatus(ItemStatus.LOADING);\n\n            fire('load-progress', progress);\n        });\n\n        // an error was thrown while loading the file, we need to switch to error state\n        loader.on('error', error => {\n            setStatus(ItemStatus.LOAD_ERROR);\n\n            fire('load-request-error', error);\n        });\n\n        // user or another process aborted the file load (cannot retry)\n        loader.on('abort', () => {\n            setStatus(ItemStatus.INIT);\n            fire('load-abort');\n        });\n\n        // done loading\n        loader.on('load', file => {\n            // as we've now loaded the file the loader is no longer required\n            state.activeLoader = null;\n\n            // called when file has loaded succesfully\n            const success = result => {\n                // set (possibly) transformed file\n                state.file = isFile(result) ? result : state.file;\n\n                // file received\n                if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n                    setStatus(ItemStatus.PROCESSING_COMPLETE);\n                } else {\n                    setStatus(ItemStatus.IDLE);\n                }\n\n                fire('load');\n            };\n\n            const error = result => {\n                // set original file\n                state.file = file;\n                fire('load-meta');\n\n                setStatus(ItemStatus.LOAD_ERROR);\n                fire('load-file-error', result);\n            };\n\n            // if we already have a server file reference, we don't need to call the onload method\n            if (state.serverFileReference) {\n                success(file);\n                return;\n            }\n\n            // no server id, let's give this file the full treatment\n            onload(file, success, error);\n        });\n\n        // set loader source data\n        loader.setSource(source);\n\n        // set as active loader\n        state.activeLoader = loader;\n\n        // load the source data\n        loader.load();\n    };\n\n    const retryLoad = () => {\n        if (!state.activeLoader) {\n            return;\n        }\n        state.activeLoader.load();\n    };\n\n    const abortLoad = () => {\n        if (state.activeLoader) {\n            state.activeLoader.abort();\n            return;\n        }\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    const process = (processor, onprocess) => {\n        // processing was aborted\n        if (state.processingAborted) {\n            state.processingAborted = false;\n            return;\n        }\n\n        // now processing\n        setStatus(ItemStatus.PROCESSING);\n\n        // reset abort callback\n        abortProcessingRequestComplete = null;\n\n        // if no file loaded we'll wait for the load event\n        if (!(state.file instanceof Blob)) {\n            api.on('load', () => {\n                process(processor, onprocess);\n            });\n            return;\n        }\n\n        // setup processor\n        processor.on('load', serverFileReference => {\n            // need this id to be able to revert the upload\n            state.transferId = null;\n            state.serverFileReference = serverFileReference;\n        });\n\n        // register transfer id\n        processor.on('transfer', transferId => {\n            // need this id to be able to revert the upload\n            state.transferId = transferId;\n        });\n\n        processor.on('load-perceived', serverFileReference => {\n            // no longer required\n            state.activeProcessor = null;\n\n            // need this id to be able to rever the upload\n            state.transferId = null;\n            state.serverFileReference = serverFileReference;\n\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n            fire('process-complete', serverFileReference);\n        });\n\n        processor.on('start', () => {\n            fire('process-start');\n        });\n\n        processor.on('error', error => {\n            state.activeProcessor = null;\n            setStatus(ItemStatus.PROCESSING_ERROR);\n            fire('process-error', error);\n        });\n\n        processor.on('abort', serverFileReference => {\n            state.activeProcessor = null;\n\n            // if file was uploaded but processing was cancelled during perceived processor time store file reference\n            state.serverFileReference = serverFileReference;\n\n            setStatus(ItemStatus.IDLE);\n            fire('process-abort');\n\n            // has timeout so doesn't interfere with remove action\n            if (abortProcessingRequestComplete) {\n                abortProcessingRequestComplete();\n            }\n        });\n\n        processor.on('progress', progress => {\n            fire('process-progress', progress);\n        });\n\n        // when successfully transformed\n        const success = file => {\n            // if was archived in the mean time, don't process\n            if (state.archived) return;\n\n            // process file!\n            processor.process(file, { ...metadata });\n        };\n\n        // something went wrong during transform phase\n        const error = console.error;\n\n        // start processing the file\n        onprocess(state.file, success, error);\n\n        // set as active processor\n        state.activeProcessor = processor;\n    };\n\n    const requestProcessing = () => {\n        state.processingAborted = false;\n        setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    const abortProcessing = () =>\n        new Promise(resolve => {\n            if (!state.activeProcessor) {\n                state.processingAborted = true;\n\n                setStatus(ItemStatus.IDLE);\n                fire('process-abort');\n\n                resolve();\n                return;\n            }\n\n            abortProcessingRequestComplete = () => {\n                resolve();\n            };\n\n            state.activeProcessor.abort();\n        });\n\n    //\n    // logic to revert a processed file\n    //\n    const revert = (revertFileUpload, forceRevert) =>\n        new Promise((resolve, reject) => {\n            // a completed upload will have a serverFileReference, a failed chunked upload where\n            // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set\n            const serverTransferId =\n                state.serverFileReference !== null ? state.serverFileReference : state.transferId;\n\n            // cannot revert without a server id for this process\n            if (serverTransferId === null) {\n                resolve();\n                return;\n            }\n\n            // revert the upload (fire and forget)\n            revertFileUpload(\n                serverTransferId,\n                () => {\n                    // reset file server id and transfer id as now it's not available on the server\n                    state.serverFileReference = null;\n                    state.transferId = null;\n                    resolve();\n                },\n                error => {\n                    // don't set error state when reverting is optional, it will always resolve\n                    if (!forceRevert) {\n                        resolve();\n                        return;\n                    }\n\n                    // oh no errors\n                    setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n                    fire('process-revert-error');\n                    reject(error);\n                }\n            );\n\n            // fire event\n            setStatus(ItemStatus.IDLE);\n            fire('process-revert');\n        });\n\n    // exposed methods\n    const setMetadata = (key, value, silent) => {\n        const keys = key.split('.');\n        const root = keys[0];\n        const last = keys.pop();\n        let data = metadata;\n        keys.forEach(key => (data = data[key]));\n\n        // compare old value against new value, if they're the same, we're not updating\n        if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n        // update value\n        data[last] = value;\n\n        // fire update\n        fire('metadata-update', {\n            key: root,\n            value: metadata[root],\n            silent,\n        });\n    };\n\n    const getMetadata = key => deepCloneObject(key ? metadata[key] : metadata);\n\n    const api = {\n        id: { get: () => id },\n        origin: { get: () => origin, set: value => (origin = value) },\n        serverId: { get: () => state.serverFileReference },\n        transferId: { get: () => state.transferId },\n        status: { get: () => state.status },\n        filename: { get: () => state.file.name },\n        filenameWithoutExtension: { get: () => getFilenameWithoutExtension(state.file.name) },\n        fileExtension: { get: getFileExtension },\n        fileType: { get: getFileType },\n        fileSize: { get: getFileSize },\n        file: { get: getFile },\n        relativePath: { get: () => state.file._relativePath },\n\n        source: { get: () => state.source },\n\n        getMetadata,\n        setMetadata: (key, value, silent) => {\n            if (isObject(key)) {\n                const data = key;\n                Object.keys(data).forEach(key => {\n                    setMetadata(key, data[key], value);\n                });\n                return key;\n            }\n            setMetadata(key, value, silent);\n            return value;\n        },\n\n        extend: (name, handler) => (itemAPI[name] = handler),\n\n        abortLoad,\n        retryLoad,\n        requestProcessing,\n        abortProcessing,\n\n        load,\n        process,\n        revert,\n\n        ...on(),\n\n        freeze: () => (state.frozen = true),\n\n        release: () => (state.released = true),\n        released: { get: () => state.released },\n\n        archive: () => (state.archived = true),\n        archived: { get: () => state.archived },\n\n        // replace source and file object\n        setFile: file => (state.file = file),\n    };\n\n    // create it here instead of returning it instantly so we can extend it later\n    const itemAPI = createObject(api);\n\n    return itemAPI;\n};\n\nconst getItemIndexByQuery = (items, query) => {\n    // just return first index\n    if (isEmpty(query)) {\n        return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n        return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(item => item.id === query);\n};\n\nconst getItemById = (items, itemId) => {\n    const index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n        return;\n    }\n    return items[index] || null;\n};\n\nconst fetchBlob = (url, load, error, progress, abort, headers) => {\n    const request = sendRequest(null, url, {\n        method: 'GET',\n        responseType: 'blob',\n    });\n\n    request.onload = xhr => {\n        // get headers\n        const headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n\n    request.onerror = xhr => {\n        error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n\n    request.onheaders = xhr => {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n};\n\nconst getDomainFromURL = url => {\n    if (url.indexOf('//') === 0) {\n        url = location.protocol + url;\n    }\n    return url\n        .toLowerCase()\n        .replace('blob:', '')\n        .replace(/([a-z])?:\\/\\//, '$1')\n        .split('/')[0];\n};\n\nconst isExternalURL = url =>\n    (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n    getDomainFromURL(location.href) !== getDomainFromURL(url);\n\nconst dynamicLabel = label => (...params) => (isFunction(label) ? label(...params) : label);\n\nconst isMockItem = item => !isFile(item.file);\n\nconst listUpdated = (dispatch, state) => {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(() => {\n        dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n    }, 0);\n};\n\nconst optionalPromise = (fn, ...params) =>\n    new Promise(resolve => {\n        if (!fn) {\n            return resolve(true);\n        }\n\n        const result = fn(...params);\n\n        if (result == null) {\n            return resolve(true);\n        }\n\n        if (typeof result === 'boolean') {\n            return resolve(result);\n        }\n\n        if (typeof result.then === 'function') {\n            result.then(resolve);\n        }\n    });\n\nconst sortItems = (state, compare) => {\n    state.items.sort((a, b) => compare(createItemAPI(a), createItemAPI(b)));\n};\n\n// returns item based on state\nconst getItemByQueryFromState = (state, itemHandler) => ({\n    query,\n    success = () => {},\n    failure = () => {},\n    ...options\n} = {}) => {\n    const item = getItemByQuery(state.items, query);\n    if (!item) {\n        failure({\n            error: createResponse('error', 0, 'Item not found'),\n            file: null,\n        });\n        return;\n    }\n    itemHandler(item, success, failure, options || {});\n};\n\nconst actions = (dispatch, query, state) => ({\n    /**\n     * Aborts all ongoing processes\n     */\n    ABORT_ALL: () => {\n        getActiveItems(state.items).forEach(item => {\n            item.freeze();\n            item.abortLoad();\n            item.abortProcessing();\n        });\n    },\n\n    /**\n     * Sets initial files\n     */\n    DID_SET_FILES: ({ value = [] }) => {\n        // map values to file objects\n        const files = value.map(file => ({\n            source: file.source ? file.source : file,\n            options: file.options,\n        }));\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        let activeItems = getActiveItems(state.items);\n\n        activeItems.forEach(item => {\n            // if item not is in new value, remove\n            if (!files.find(file => file.source === item.source || file.source === item.file)) {\n                dispatch('REMOVE_ITEM', { query: item, remove: false });\n            }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach((file, index) => {\n            // if file is already in list\n            if (activeItems.find(item => item.source === file.source || item.file === file.source))\n                return;\n\n            // not in list, add\n            dispatch('ADD_ITEM', {\n                ...file,\n                interactionMethod: InteractionMethod.NONE,\n                index,\n            });\n        });\n    },\n\n    DID_UPDATE_ITEM_METADATA: ({ id, action, change }) => {\n        // don't do anything\n        if (change.silent) return;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(() => {\n            const item = getItemById(state.items, id);\n\n            // only revert and attempt to upload when we're uploading to a server\n            if (!query('IS_ASYNC')) {\n                // should we update the output data\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n                    item,\n                    query,\n                    action,\n                    change,\n                }).then(shouldPrepareOutput => {\n                    // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                    const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                    if (beforePrepareFile)\n                        shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                    if (!shouldPrepareOutput) return;\n\n                    dispatch(\n                        'REQUEST_PREPARE_OUTPUT',\n                        {\n                            query: id,\n                            item,\n                            success: file => {\n                                dispatch('DID_PREPARE_OUTPUT', { id, file });\n                            },\n                        },\n                        true\n                    );\n                });\n\n                return;\n            }\n\n            // if is local item we need to enable upload button so change can be propagated to server\n            if (item.origin === FileOrigin.LOCAL) {\n                dispatch('DID_LOAD_ITEM', {\n                    id: item.id,\n                    error: null,\n                    serverFileReference: item.source,\n                });\n            }\n\n            // for async scenarios\n            const upload = () => {\n                // we push this forward a bit so the interface is updated correctly\n                setTimeout(() => {\n                    dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n                }, 32);\n            };\n\n            const revert = doUpload => {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                )\n                    .then(doUpload ? upload : () => {})\n                    .catch(() => {});\n            };\n\n            const abort = doUpload => {\n                item.abortProcessing().then(doUpload ? upload : () => {});\n            };\n\n            // if we should re-upload the file immediately\n            if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n                return revert(state.options.instantUpload);\n            }\n\n            // if currently uploading, cancel upload\n            if (item.status === ItemStatus.PROCESSING) {\n                return abort(state.options.instantUpload);\n            }\n\n            if (state.options.instantUpload) {\n                upload();\n            }\n        }, 0);\n    },\n\n    MOVE_ITEM: ({ query, index }) => {\n        const item = getItemByQuery(state.items, query);\n        if (!item) return;\n        const currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n    },\n\n    SORT: ({ compare }) => {\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n            items: query('GET_ACTIVE_ITEMS'),\n        });\n    },\n\n    ADD_ITEMS: ({ items, index, interactionMethod, success = () => {}, failure = () => {} }) => {\n        let currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n            const insertLocation = query('GET_ITEM_INSERT_LOCATION');\n            const totalItems = query('GET_TOTAL_ITEMS');\n            currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        const ignoredFiles = query('GET_IGNORED_FILES');\n        const isValidFile = source =>\n            isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        const validItems = items.filter(isValidFile);\n\n        const promises = validItems.map(\n            source =>\n                new Promise((resolve, reject) => {\n                    dispatch('ADD_ITEM', {\n                        interactionMethod,\n                        source: source.source || source,\n                        success: resolve,\n                        failure: reject,\n                        index: currentIndex++,\n                        options: source.options || {},\n                    });\n                })\n        );\n\n        Promise.all(promises)\n            .then(success)\n            .catch(failure);\n    },\n\n    /**\n     * @param source\n     * @param index\n     * @param interactionMethod\n     */\n    ADD_ITEM: ({\n        source,\n        index = -1,\n        interactionMethod,\n        success = () => {},\n        failure = () => {},\n        options = {},\n    }) => {\n        // if no source supplied\n        if (isEmpty(source)) {\n            failure({\n                error: createResponse('error', 0, 'No source'),\n                file: null,\n            });\n            return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n            // fail silently\n            return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n            // if multiple allowed, we can't replace\n            // or if only a single item is allowed but we're not allowed to replace it we exit\n            if (\n                state.options.allowMultiple ||\n                (!state.options.allowMultiple && !state.options.allowReplace)\n            ) {\n                const error = createResponse('warning', 0, 'Max files');\n\n                dispatch('DID_THROW_MAX_FILES', {\n                    source,\n                    error,\n                });\n\n                failure({ error, file: null });\n\n                return;\n            }\n\n            // let's replace the item\n            // id of first item we're about to remove\n            const item = getActiveItems(state.items)[0];\n\n            // if has been processed remove it from the server as well\n            if (\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\n            ) {\n                const forceRevert = query('GET_FORCE_REVERT');\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    forceRevert\n                )\n                    .then(() => {\n                        if (!forceRevert) return;\n\n                        // try to add now\n                        dispatch('ADD_ITEM', {\n                            source,\n                            index,\n                            interactionMethod,\n                            success,\n                            failure,\n                            options,\n                        });\n                    })\n                    .catch(() => {}); // no need to handle this catch state for now\n\n                if (forceRevert) return;\n            }\n\n            // remove first item as it will be replaced by this item\n            dispatch('REMOVE_ITEM', { query: item.id });\n        }\n\n        // where did the file originate\n        const origin =\n            options.type === 'local'\n                ? FileOrigin.LOCAL\n                : options.type === 'limbo'\n                ? FileOrigin.LIMBO\n                : FileOrigin.INPUT;\n\n        // create a new blank item\n        const item = createItem(\n            // where did this file come from\n            origin,\n\n            // an input file never has a server file reference\n            origin === FileOrigin.INPUT ? null : source,\n\n            // file mock data, if defined\n            options.file\n        );\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(key => {\n            item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, { query, dispatch });\n\n        // where to insert new items\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n            index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n            sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        const id = item.id;\n\n        // observe item events\n        item.on('init', () => {\n            dispatch('DID_INIT_ITEM', { id });\n        });\n\n        item.on('load-init', () => {\n            dispatch('DID_START_ITEM_LOAD', { id });\n        });\n\n        item.on('load-meta', () => {\n            dispatch('DID_UPDATE_ITEM_META', { id });\n        });\n\n        item.on('load-progress', progress => {\n            dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', { id, progress });\n        });\n\n        item.on('load-request-error', error => {\n            const mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);\n\n            // is client error, no way to recover\n            if (error.code >= 400 && error.code < 500) {\n                dispatch('DID_THROW_ITEM_INVALID', {\n                    id,\n                    error,\n                    status: {\n                        main: mainStatus,\n                        sub: `${error.code} (${error.body})`,\n                    },\n                });\n\n                // reject the file so can be dealt with through API\n                failure({ error, file: createItemAPI(item) });\n                return;\n            }\n\n            // is possible server error, so might be possible to retry\n            dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n                id,\n                error,\n                status: {\n                    main: mainStatus,\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('load-file-error', error => {\n            dispatch('DID_THROW_ITEM_INVALID', {\n                id,\n                error: error.status,\n                status: error.status,\n            });\n            failure({ error: error.status, file: createItemAPI(item) });\n        });\n\n        item.on('load-abort', () => {\n            dispatch('REMOVE_ITEM', { query: id });\n        });\n\n        item.on('load-skip', () => {\n            item.on('metadata-update', change => {\n                if (!isFile(item.file)) return;\n                dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\n            });\n\n            dispatch('COMPLETE_LOAD_ITEM', {\n                query: id,\n                item,\n                data: {\n                    source,\n                    success,\n                },\n            });\n        });\n\n        item.on('load', () => {\n            const handleAdd = shouldAdd => {\n                // no should not add this file\n                if (!shouldAdd) {\n                    dispatch('REMOVE_ITEM', {\n                        query: id,\n                    });\n                    return;\n                }\n\n                // now interested in metadata updates\n                item.on('metadata-update', change => {\n                    dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\n                });\n\n                // let plugins decide if the output data should be prepared at this point\n                // means we'll do this and wait for idle state\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, { item, query }).then(\n                    shouldPrepareOutput => {\n                        // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                        const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                        if (beforePrepareFile)\n                            shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                        const loadComplete = () => {\n                            dispatch('COMPLETE_LOAD_ITEM', {\n                                query: id,\n                                item,\n                                data: {\n                                    source,\n                                    success,\n                                },\n                            });\n\n                            listUpdated(dispatch, state);\n                        };\n\n                        // exit\n                        if (shouldPrepareOutput) {\n                            // wait for idle state and then run PREPARE_OUTPUT\n                            dispatch(\n                                'REQUEST_PREPARE_OUTPUT',\n                                {\n                                    query: id,\n                                    item,\n                                    success: file => {\n                                        dispatch('DID_PREPARE_OUTPUT', { id, file });\n                                        loadComplete();\n                                    },\n                                },\n                                true\n                            );\n\n                            return;\n                        }\n\n                        loadComplete();\n                    }\n                );\n            };\n\n            // item loaded, allow plugins to\n            // - read data (quickly)\n            // - add metadata\n            applyFilterChain('DID_LOAD_ITEM', item, { query, dispatch })\n                .then(() => {\n                    optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(\n                        handleAdd\n                    );\n                })\n                .catch(e => {\n                    if (!e || !e.error || !e.status) return handleAdd(false);\n                    dispatch('DID_THROW_ITEM_INVALID', {\n                        id,\n                        error: e.error,\n                        status: e.status,\n                    });\n                });\n        });\n\n        item.on('process-start', () => {\n            dispatch('DID_START_ITEM_PROCESSING', { id });\n        });\n\n        item.on('process-progress', progress => {\n            dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', { id, progress });\n        });\n\n        item.on('process-error', error => {\n            dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n                id,\n                error,\n                status: {\n                    main: dynamicLabel(state.options.labelFileProcessingError)(error),\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('process-revert-error', error => {\n            dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n                id,\n                error,\n                status: {\n                    main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('process-complete', serverFileReference => {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                id,\n                error: null,\n                serverFileReference,\n            });\n            dispatch('DID_DEFINE_VALUE', { id, value: serverFileReference });\n        });\n\n        item.on('process-abort', () => {\n            dispatch('DID_ABORT_ITEM_PROCESSING', { id });\n        });\n\n        item.on('process-revert', () => {\n            dispatch('DID_REVERT_ITEM_PROCESSING', { id });\n            dispatch('DID_DEFINE_VALUE', { id, value: null });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', { id, index, interactionMethod });\n\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        const { url, load, restore, fetch } = state.options.server || {};\n\n        item.load(\n            source,\n\n            // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n            createFileLoader(\n                origin === FileOrigin.INPUT\n                    ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\n                      isString(source) && isExternalURL(source)\n                        ? fetch\n                            ? createFetchFunction(url, fetch)\n                            : fetchBlob // remote url\n                        : fetchBlob // try to fetch url\n                    : // limbo or local\n                    origin === FileOrigin.LIMBO\n                    ? createFetchFunction(url, restore) // limbo\n                    : createFetchFunction(url, load) // local\n            ),\n\n            // called when the file is loaded so it can be piped through the filters\n            (file, success, error) => {\n                // let's process the file\n                applyFilterChain('LOAD_FILE', file, { query })\n                    .then(success)\n                    .catch(error);\n            }\n        );\n    },\n\n    REQUEST_PREPARE_OUTPUT: ({ item, success, failure = () => {} }) => {\n        // error response if item archived\n        const err = {\n            error: createResponse('error', 0, 'Item not found'),\n            file: null,\n        };\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return failure(err);\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, { query, item }).then(result => {\n            applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, { query, item }).then(result => {\n                // don't handle archived items, an item could have been archived (load aborted) while being prepared\n                if (item.archived) return failure(err);\n\n                // we done!\n                success(result);\n            });\n        });\n    },\n\n    COMPLETE_LOAD_ITEM: ({ item, data }) => {\n        const { success, source } = data;\n\n        // sort items in list\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n            sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n            id: item.id,\n            error: null,\n            serverFileReference: item.origin === FileOrigin.INPUT ? null : source,\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n            dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n            return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                id: item.id,\n                error: null,\n                serverFileReference: source,\n            });\n\n            dispatch('DID_DEFINE_VALUE', {\n                id: item.id,\n                value: item.serverId || source,\n            });\n            return;\n        }\n\n        // id we are allowed to upload the file immediately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n            dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n        }\n    },\n\n    RETRY_ITEM_LOAD: getItemByQueryFromState(state, item => {\n        // try loading the source one more time\n        item.retryLoad();\n    }),\n\n    REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, (item, success, failure) => {\n        dispatch(\n            'REQUEST_PREPARE_OUTPUT',\n            {\n                query: item.id,\n                item,\n                success: file => {\n                    dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\n                    success({\n                        file: item,\n                        output: file,\n                    });\n                },\n                failure,\n            },\n            true\n        );\n    }),\n\n    REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, (item, success, failure) => {\n        // cannot be queued (or is already queued)\n        const itemCanBeQueuedForProcessing =\n            // waiting for something\n            item.status === ItemStatus.IDLE ||\n            // processing went wrong earlier\n            item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n            const processNow = () =>\n                dispatch('REQUEST_ITEM_PROCESSING', { query: item, success, failure });\n\n            const process = () => (document.hidden ? processNow() : setTimeout(processNow, 32));\n\n            // if already done processing or tried to revert but didn't work, try again\n            if (\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\n            ) {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                )\n                    .then(process)\n                    .catch(() => {}); // don't continue with processing if something went wrong\n            } else if (item.status === ItemStatus.PROCESSING) {\n                item.abortProcessing().then(process);\n            }\n\n            return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n        item.requestProcessing();\n\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n        dispatch('PROCESS_ITEM', { query: item, success, failure }, true);\n    }),\n\n    PROCESS_ITEM: getItemByQueryFromState(state, (item, success, failure) => {\n        const maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        const totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n            // queue for later processing\n            state.processingQueue.push({\n                id: item.id,\n                success,\n                failure,\n            });\n\n            // stop it!\n            return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        const processNext = () => {\n            // process queueud items\n            const queueEntry = state.processingQueue.shift();\n\n            // no items left\n            if (!queueEntry) return;\n\n            // get item reference\n            const { id, success, failure } = queueEntry;\n            const itemReference = getItemByQuery(state.items, id);\n\n            // if item was archived while in queue, jump to next\n            if (!itemReference || itemReference.archived) {\n                processNext();\n                return;\n            }\n\n            // process queued item\n            dispatch('PROCESS_ITEM', { query: id, success, failure }, true);\n        };\n\n        // we done function\n        item.onOnce('process-complete', () => {\n            success(createItemAPI(item));\n            processNext();\n\n            // if origin is local, and we're instant uploading, trigger remove of original\n            // as revert will remove file from list\n            const server = state.options.server;\n            const instantUpload = state.options.instantUpload;\n            if (instantUpload && item.origin === FileOrigin.LOCAL && isFunction(server.remove)) {\n                const noop = () => {};\n                item.origin = FileOrigin.LIMBO;\n                state.options.server.remove(item.source, noop, noop);\n            }\n\n            // All items processed? No errors?\n            const allItemsProcessed =\n                query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length ===\n                state.items.length;\n            if (allItemsProcessed) {\n                dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n            }\n        });\n\n        // we error function\n        item.onOnce('process-error', error => {\n            failure({ error, file: createItemAPI(item) });\n            processNext();\n        });\n\n        // start file processing\n        const options = state.options;\n        item.process(\n            createFileProcessor(\n                createProcessorFunction(options.server.url, options.server.process, options.name, {\n                    chunkTransferId: item.transferId,\n                    chunkServer: options.server.patch,\n                    chunkUploads: options.chunkUploads,\n                    chunkForce: options.chunkForce,\n                    chunkSize: options.chunkSize,\n                    chunkRetryDelays: options.chunkRetryDelays,\n                }),\n                {\n                    allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION'),\n                }\n            ),\n            // called when the file is about to be processed so it can be piped through the transform filters\n            (file, success, error) => {\n                // allow plugins to alter the file data\n                applyFilterChain('PREPARE_OUTPUT', file, { query, item })\n                    .then(file => {\n                        dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\n\n                        success(file);\n                    })\n                    .catch(error);\n            }\n        );\n    }),\n\n    RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n    }),\n\n    REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, item => {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(shouldRemove => {\n            if (!shouldRemove) {\n                return;\n            }\n            dispatch('REMOVE_ITEM', { query: item });\n        });\n    }),\n\n    RELEASE_ITEM: getItemByQueryFromState(state, item => {\n        item.release();\n    }),\n\n    REMOVE_ITEM: getItemByQueryFromState(state, (item, success, failure, options) => {\n        const removeFromView = () => {\n            // get id reference\n            const id = item.id;\n\n            // archive the item, this does not remove it from the list\n            getItemById(state.items, id).archive();\n\n            // tell the view the item has been removed\n            dispatch('DID_REMOVE_ITEM', { error: null, id, item });\n\n            // now the list has been modified\n            listUpdated(dispatch, state);\n\n            // correctly removed\n            success(createItemAPI(item));\n        };\n\n        // if this is a local file and the `server.remove` function has been configured,\n        // send source there so dev can remove file from server\n        const server = state.options.server;\n        if (\n            item.origin === FileOrigin.LOCAL &&\n            server &&\n            isFunction(server.remove) &&\n            options.remove !== false\n        ) {\n            dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n            server.remove(\n                item.source,\n                () => removeFromView(),\n                status => {\n                    dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                        id: item.id,\n                        error: createResponse('error', 0, status, null),\n                        status: {\n                            main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                            sub: state.options.labelTapToRetry,\n                        },\n                    });\n                }\n            );\n        } else {\n            // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n            if (\n                (options.revert && item.origin !== FileOrigin.LOCAL && item.serverId !== null) ||\n                // if chunked uploads are enabled and we're uploading in chunks for this specific file\n                // or if the file isn't big enough for chunked uploads but chunkForce is set then call\n                // revert before removing from the view...\n                (state.options.chunkUploads && item.file.size > state.options.chunkSize) ||\n                (state.options.chunkUploads && state.options.chunkForce)\n            ) {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                );\n            }\n\n            // can now safely remove from view\n            removeFromView();\n        }\n    }),\n\n    ABORT_ITEM_LOAD: getItemByQueryFromState(state, item => {\n        item.abortLoad();\n    }),\n\n    ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        // test if is already processed\n        if (item.serverId) {\n            dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n            return;\n        }\n\n        // abort\n        item.abortProcessing().then(() => {\n            const shouldRemove = state.options.instantUpload;\n            if (shouldRemove) {\n                dispatch('REMOVE_ITEM', { query: item.id });\n            }\n        });\n    }),\n\n    REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        // not instant uploading, revert immediately\n        if (!state.options.instantUpload) {\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\n            return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        const handleRevert = shouldRevert => {\n            if (!shouldRevert) return;\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\n        };\n\n        const fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n            return handleRevert(true);\n        }\n\n        const requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n            // undefined or null\n            return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n            return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n            requestRemoveResult.then(handleRevert);\n        }\n    }),\n\n    REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        item.revert(\n            createRevertFunction(state.options.server.url, state.options.server.revert),\n            query('GET_FORCE_REVERT')\n        )\n            .then(() => {\n                const shouldRemove = state.options.instantUpload || isMockItem(item);\n                if (shouldRemove) {\n                    dispatch('REMOVE_ITEM', { query: item.id });\n                }\n            })\n            .catch(() => {});\n    }),\n\n    SET_OPTIONS: ({ options }) => {\n        // get all keys passed\n        const optionKeys = Object.keys(options);\n\n        // get prioritized keyed to include (remove once not in options object)\n        const prioritizedOptionKeys = PrioritizedOptions.filter(key => optionKeys.includes(key));\n\n        // order the keys, prioritized first, then rest\n        const orderedOptionKeys = [\n            // add prioritized first if passed to options, else remove\n            ...prioritizedOptionKeys,\n\n            // prevent duplicate keys\n            ...Object.keys(options).filter(key => !prioritizedOptionKeys.includes(key)),\n        ];\n\n        // dispatch set event for each option\n        orderedOptionKeys.forEach(key => {\n            dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\n                value: options[key],\n            });\n        });\n    },\n});\n\nconst PrioritizedOptions = [\n    'server', // must be processed before \"files\"\n];\n\nconst formatFilename = name => name;\n\nconst createElement$1 = tagName => {\n    return document.createElement(tagName);\n};\n\nconst text = (node, value) => {\n    let textNode = node.childNodes[0];\n    if (!textNode) {\n        textNode = document.createTextNode(value);\n        node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n        textNode.nodeValue = value;\n    }\n};\n\nconst polarToCartesian = (centerX, centerY, radius, angleInDegrees) => {\n    const angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n    return {\n        x: centerX + radius * Math.cos(angleInRadians),\n        y: centerY + radius * Math.sin(angleInRadians),\n    };\n};\n\nconst describeArc = (x, y, radius, startAngle, endAngle, arcSweep) => {\n    const start = polarToCartesian(x, y, radius, endAngle);\n    const end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n};\n\nconst percentageArc = (x, y, radius, from, to) => {\n    let arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n        arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n        arcSweep = 0;\n    }\n    return describeArc(\n        x,\n        y,\n        radius,\n        Math.min(0.9999, from) * 360,\n        Math.min(0.9999, to) * 360,\n        arcSweep\n    );\n};\n\nconst create = ({ root, props }) => {\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    const svg = createElement('svg');\n    root.ref.path = createElement('path', {\n        'stroke-width': 2,\n        'stroke-linecap': 'round',\n    });\n    svg.appendChild(root.ref.path);\n\n    root.ref.svg = svg;\n\n    root.appendChild(svg);\n};\n\nconst write = ({ root, props }) => {\n    if (props.opacity === 0) {\n        return;\n    }\n\n    if (props.align) {\n        root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    const ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    const size = root.rect.element.width * 0.5;\n\n    // ring state\n    let ringFrom = 0;\n    let ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n        ringFrom = 0;\n        ringTo = 0.5;\n    } else {\n        ringFrom = 0;\n        ringTo = props.progress;\n    }\n\n    // get arc path\n    const coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n};\n\nconst progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create,\n    write,\n    mixins: {\n        apis: ['progress', 'spin', 'align'],\n        styles: ['opacity'],\n        animations: {\n            opacity: { type: 'tween', duration: 500 },\n            progress: {\n                type: 'spring',\n                stiffness: 0.95,\n                damping: 0.65,\n                mass: 10,\n            },\n        },\n    },\n});\n\nconst create$1 = ({ root, props }) => {\n    root.element.innerHTML = (props.icon || '') + `<span>${props.label}</span>`;\n\n    props.isDisabled = false;\n};\n\nconst write$1 = ({ root, props }) => {\n    const { isDisabled } = props;\n    const shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n        props.isDisabled = true;\n        attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n        props.isDisabled = false;\n        root.element.removeAttribute('disabled');\n    }\n};\n\nconst fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n        type: 'button',\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n        apis: ['label'],\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            translateX: 'spring',\n            translateY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n        listeners: true,\n    },\n    create: create$1,\n    write: write$1,\n});\n\nconst toNaturalFileSize = (bytes, decimalSeparator = '.', base = 1000, options = {}) => {\n    const {\n        labelBytes = 'bytes',\n        labelKilobytes = 'KB',\n        labelMegabytes = 'MB',\n        labelGigabytes = 'GB',\n    } = options;\n\n    // no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n\n    const KB = base;\n    const MB = base * base;\n    const GB = base * base * base;\n\n    // just bytes\n    if (bytes < KB) {\n        return `${bytes} ${labelBytes}`;\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n        return `${Math.floor(bytes / KB)} ${labelKilobytes}`;\n    }\n\n    // megabytes\n    if (bytes < GB) {\n        return `${removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator)} ${labelMegabytes}`;\n    }\n\n    // gigabytes\n    return `${removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator)} ${labelGigabytes}`;\n};\n\nconst removeDecimalsWhenZero = (value, decimalCount, separator) => {\n    return value\n        .toFixed(decimalCount)\n        .split('.')\n        .filter(part => part !== '0')\n        .join(separator);\n};\n\nconst create$2 = ({ root, props }) => {\n    // filename\n    const fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    const fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst updateFile = ({ root, props }) => {\n    text(\n        root.ref.fileSize,\n        toNaturalFileSize(\n            root.query('GET_ITEM_SIZE', props.id),\n            '.',\n            root.query('GET_FILE_SIZE_BASE'),\n            root.query('GET_FILE_SIZE_LABELS', root.query)\n        )\n    );\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst updateFileSizeOnError = ({ root, props }) => {\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n        updateFile({ root, props });\n        return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n};\n\nconst fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: updateFile,\n        DID_UPDATE_ITEM_META: updateFile,\n        DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n        DID_THROW_ITEM_INVALID: updateFileSizeOnError,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    create: create$2,\n    mixins: {\n        styles: ['translateX', 'translateY'],\n        animations: {\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\nconst toPercentage = value => Math.round(value * 100);\n\nconst create$3 = ({ root }) => {\n    // main status\n    const main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    const sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n\n    didSetItemLoadProgress({ root, action: { progress: null } });\n};\n\nconst didSetItemLoadProgress = ({ root, action }) => {\n    const title =\n        action.progress === null\n            ? root.query('GET_LABEL_FILE_LOADING')\n            : `${root.query('GET_LABEL_FILE_LOADING')} ${toPercentage(action.progress)}%`;\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didSetItemProcessProgress = ({ root, action }) => {\n    const title =\n        action.progress === null\n            ? root.query('GET_LABEL_FILE_PROCESSING')\n            : `${root.query('GET_LABEL_FILE_PROCESSING')} ${toPercentage(action.progress)}%`;\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didRequestItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didAbortItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n};\n\nconst didCompleteItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n};\n\nconst clear = ({ root }) => {\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n};\n\nconst error = ({ root, action }) => {\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n};\n\nconst fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: clear,\n        DID_REVERT_ITEM_PROCESSING: clear,\n        DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n        DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n        DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n        DID_THROW_ITEM_LOAD_ERROR: error,\n        DID_THROW_ITEM_INVALID: error,\n        DID_THROW_ITEM_PROCESSING_ERROR: error,\n        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n        DID_THROW_ITEM_REMOVE_ERROR: error,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    create: create$3,\n    mixins: {\n        styles: ['translateX', 'translateY', 'opacity'],\n        animations: {\n            opacity: { type: 'tween', duration: 250 },\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\n/**\n * Button definitions for the file view\n */\n\nconst Buttons = {\n    AbortItemLoad: {\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n        action: 'ABORT_ITEM_LOAD',\n        className: 'filepond--action-abort-item-load',\n        align: 'LOAD_INDICATOR_POSITION', // right\n    },\n    RetryItemLoad: {\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n        action: 'RETRY_ITEM_LOAD',\n        icon: 'GET_ICON_RETRY',\n        className: 'filepond--action-retry-item-load',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RemoveItem: {\n        label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n        action: 'REQUEST_REMOVE_ITEM',\n        icon: 'GET_ICON_REMOVE',\n        className: 'filepond--action-remove-item',\n        align: 'BUTTON_REMOVE_ITEM_POSITION', // left\n    },\n    ProcessItem: {\n        label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n        action: 'REQUEST_ITEM_PROCESSING',\n        icon: 'GET_ICON_PROCESS',\n        className: 'filepond--action-process-item',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    AbortItemProcessing: {\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n        action: 'ABORT_ITEM_PROCESSING',\n        className: 'filepond--action-abort-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RetryItemProcessing: {\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n        action: 'RETRY_ITEM_PROCESSING',\n        icon: 'GET_ICON_RETRY',\n        className: 'filepond--action-retry-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RevertItemProcessing: {\n        label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n        action: 'REQUEST_REVERT_ITEM_PROCESSING',\n        icon: 'GET_ICON_UNDO',\n        className: 'filepond--action-revert-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n};\n\n// make a list of buttons, we can then remove buttons from this list if they're disabled\nconst ButtonKeys = [];\nforin(Buttons, key => {\n    ButtonKeys.push(key);\n});\n\nconst calculateFileInfoOffset = root => {\n    if (getRemoveIndicatorAligment(root) === 'right') return 0;\n    const buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n};\n\nconst calculateButtonWidth = root => {\n    const buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n    return buttonRect.width;\n};\n\n// Force on full pixels so text stays crips\nconst calculateFileVerticalCenterOffset = root =>\n    Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\nconst calculateFileHorizontalCenterOffset = root =>\n    Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n\nconst getLoadIndicatorAlignment = root => root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\nconst getProcessIndicatorAlignment = root => root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\nconst getRemoveIndicatorAligment = root => root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n\nconst DefaultStyle = {\n    buttonAbortItemLoad: { opacity: 0 },\n    buttonRetryItemLoad: { opacity: 0 },\n    buttonRemoveItem: { opacity: 0 },\n    buttonProcessItem: { opacity: 0 },\n    buttonAbortItemProcessing: { opacity: 0 },\n    buttonRetryItemProcessing: { opacity: 0 },\n    buttonRevertItemProcessing: { opacity: 0 },\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n    processProgressIndicator: { opacity: 0, align: getProcessIndicatorAlignment },\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n    info: { translateX: 0, translateY: 0, opacity: 0 },\n    status: { translateX: 0, translateY: 0, opacity: 0 },\n};\n\nconst IdleStyle = {\n    buttonRemoveItem: { opacity: 1 },\n    buttonProcessItem: { opacity: 1 },\n    info: { translateX: calculateFileInfoOffset },\n    status: { translateX: calculateFileInfoOffset },\n};\n\nconst ProcessingStyle = {\n    buttonAbortItemProcessing: { opacity: 1 },\n    processProgressIndicator: { opacity: 1 },\n    status: { opacity: 1 },\n};\n\nconst StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { translateX: calculateFileInfoOffset, opacity: 1 },\n    },\n    DID_START_ITEM_LOAD: {\n        buttonAbortItemLoad: { opacity: 1 },\n        loadProgressIndicator: { opacity: 1 },\n        status: { opacity: 1 },\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n        buttonRetryItemLoad: { opacity: 1 },\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1 },\n    },\n    DID_START_ITEM_REMOVE: {\n        processProgressIndicator: { opacity: 1, align: getRemoveIndicatorAligment },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 0 },\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n        processProgressIndicator: { opacity: 0, align: getRemoveIndicatorAligment },\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1, translateX: calculateFileInfoOffset },\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { translateX: calculateFileInfoOffset },\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n        buttonRevertItemProcessing: { opacity: 1 },\n        info: { opacity: 1 },\n        status: { opacity: 1 },\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n        buttonRemoveItem: { opacity: 1 },\n        buttonRetryItemProcessing: { opacity: 1 },\n        status: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n        buttonRevertItemProcessing: { opacity: 1 },\n        status: { opacity: 1 },\n        info: { opacity: 1 },\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n        buttonRemoveItem: { opacity: 1 },\n        buttonProcessItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1 },\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle,\n};\n\n// complete indicator view\nconst processingCompleteIndicatorView = createView({\n    create: ({ root }) => {\n        root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n        styles: ['scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n    },\n});\n\n/**\n * Creates the file view\n */\nconst create$4 = ({ root, props }) => {\n    // copy Buttons object\n    const LocalButtons = Object.keys(Buttons).reduce((prev, curr) => {\n        prev[curr] = { ...Buttons[curr] };\n        return prev;\n    }, {});\n\n    const { id } = props;\n\n    // allow reverting upload\n    const allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // allow remove file\n    const allowRemove = root.query('GET_ALLOW_REMOVE');\n\n    // allow processing upload\n    const allowProcess = root.query('GET_ALLOW_PROCESS');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    const instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    const isAsync = root.query('IS_ASYNC');\n\n    // should align remove item buttons\n    const alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');\n\n    // enabled buttons array\n    let buttonFilter;\n    if (isAsync) {\n        if (allowProcess && !allowRevert) {\n            // only remove revert button\n            buttonFilter = key => !/RevertItemProcessing/.test(key);\n        } else if (!allowProcess && allowRevert) {\n            // only remove process button\n            buttonFilter = key => !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\n        } else if (!allowProcess && !allowRevert) {\n            // remove all process buttons\n            buttonFilter = key => !/Process/.test(key);\n        }\n    } else {\n        // no process controls available\n        buttonFilter = key => !/Process/.test(key);\n    }\n\n    const enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n        LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n        LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n        map.info.translateX = calculateFileHorizontalCenterOffset;\n        map.info.translateY = calculateFileVerticalCenterOffset;\n        map.status.translateY = calculateFileVerticalCenterOffset;\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // should align center\n    if (isAsync && !allowProcess) {\n        [\n            'DID_START_ITEM_PROCESSING',\n            'DID_REQUEST_ITEM_PROCESSING',\n            'DID_UPDATE_ITEM_PROCESS_PROGRESS',\n            'DID_THROW_ITEM_PROCESSING_ERROR',\n        ].forEach(key => {\n            StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n        });\n        StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\n    }\n\n    // move remove button to right\n    if (alignRemoveItemButton && allowRevert) {\n        LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n        map.info.translateX = calculateFileInfoOffset;\n        map.status.translateY = calculateFileVerticalCenterOffset;\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // show/hide RemoveItem button\n    if (!allowRemove) {\n        LocalButtons['RemoveItem'].disabled = true;\n    }\n\n    // create the button views\n    forin(LocalButtons, (key, definition) => {\n        // create button\n        const buttonView = root.createChildView(fileActionButton, {\n            label: root.query(definition.label),\n            icon: root.query(definition.icon),\n            opacity: 0,\n        });\n\n        // should be appended?\n        if (enabledButtons.includes(key)) {\n            root.appendChildView(buttonView);\n        }\n\n        // toggle\n        if (definition.disabled) {\n            buttonView.element.setAttribute('disabled', 'disabled');\n            buttonView.element.setAttribute('hidden', 'hidden');\n        }\n\n        // add position attribute\n        buttonView.element.dataset.align = root.query(`GET_STYLE_${definition.align}`);\n\n        // add class\n        buttonView.element.classList.add(definition.className);\n\n        // handle interactions\n        buttonView.on('click', e => {\n            e.stopPropagation();\n            if (definition.disabled) return;\n            root.dispatch(definition.action, { query: id });\n        });\n\n        // set reference\n        root.ref[`button${key}`] = buttonView;\n    });\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(\n        root.createChildView(processingCompleteIndicatorView)\n    );\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n        `GET_STYLE_BUTTON_PROCESS_ITEM_POSITION`\n    );\n\n    // create file info view\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, { id }));\n\n    // create file status view\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, { id }));\n\n    // add progress indicators\n    const loadIndicatorView = root.appendChildView(\n        root.createChildView(progressIndicator, {\n            opacity: 0,\n            align: root.query(`GET_STYLE_LOAD_INDICATOR_POSITION`),\n        })\n    );\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n\n    const progressIndicatorView = root.appendChildView(\n        root.createChildView(progressIndicator, {\n            opacity: 0,\n            align: root.query(`GET_STYLE_PROGRESS_INDICATOR_POSITION`),\n        })\n    );\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n};\n\nconst write$2 = ({ root, actions, props }) => {\n    // route actions\n    route({ root, actions, props });\n\n    // select last state change action\n    let action = actions\n        .concat()\n        .filter(action => /^DID_/.test(action.type))\n        .reverse()\n        .find(action => StyleMap[action.type]);\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n        // define new active styles\n        root.ref.activeStyles = [];\n\n        const stylesToApply = StyleMap[action.type];\n        forin(DefaultStyle, (name, defaultStyles) => {\n            // get reference to control\n            const control = root.ref[name];\n\n            // loop over all styles for this control\n            forin(defaultStyles, (key, defaultValue) => {\n                const value =\n                    stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined'\n                        ? stylesToApply[name][key]\n                        : defaultValue;\n                root.ref.activeStyles.push({ control, key, value });\n            });\n        });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(({ control, key, value }) => {\n        control[key] = typeof value === 'function' ? value(root) : value;\n    });\n};\n\nconst route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: ({ root, action }) => {\n        root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: ({ root, action }) => {\n        root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: ({ root, action }) => {\n        root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: ({ root }) => {\n        root.ref.processProgressIndicator.spin = true;\n        root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: ({ root }) => {\n        root.ref.loadProgressIndicator.spin = true;\n        root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: ({ root }) => {\n        root.ref.processProgressIndicator.spin = true;\n        root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: ({ root, action }) => {\n        root.ref.loadProgressIndicator.spin = false;\n        root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ({ root, action }) => {\n        root.ref.processProgressIndicator.spin = false;\n        root.ref.processProgressIndicator.progress = action.progress;\n    },\n});\n\nconst file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    name: 'file',\n});\n\n/**\n * Creates the file view\n */\nconst create$5 = ({ root, props }) => {\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(root.createChildView(file, { id: props.id }));\n\n    // data has moved to data.js\n    root.ref.data = false;\n};\n\n/**\n * Data storage\n */\nconst didLoadItem = ({ root, props }) => {\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n        DID_LOAD_ITEM: didLoadItem,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper',\n});\n\nconst PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\nconst create$6 = ({ root, props }) => {\n    [\n        {\n            name: 'top',\n        },\n        {\n            name: 'center',\n            props: {\n                translateY: null,\n                scaleY: null,\n            },\n            mixins: {\n                animations: {\n                    scaleY: PANEL_SPRING_PROPS,\n                },\n                styles: ['translateY', 'scaleY'],\n            },\n        },\n        {\n            name: 'bottom',\n            props: {\n                translateY: null,\n            },\n            mixins: {\n                animations: {\n                    translateY: PANEL_SPRING_PROPS,\n                },\n                styles: ['translateY'],\n            },\n        },\n    ].forEach(section => {\n        createSection(root, section, props.name);\n    });\n\n    root.element.classList.add(`filepond--${props.name}`);\n\n    root.ref.scalable = null;\n};\n\nconst createSection = (root, section, className) => {\n    const viewConstructor = createView({\n        name: `panel-${section.name} filepond--${className}`,\n        mixins: section.mixins,\n        ignoreRectUpdate: true,\n    });\n\n    const view = root.createChildView(viewConstructor, section.props);\n\n    root.ref[section.name] = root.appendChildView(view);\n};\n\nconst write$3 = ({ root, props }) => {\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n        root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n        root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    const topRect = root.ref.top.rect.element;\n    const bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    const height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n};\n\nconst panel = createView({\n    name: 'panel',\n    read: ({ root, props }) => (props.heightCurrent = root.ref.bottom.translateY),\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n        apis: ['height', 'heightCurrent', 'scalable'],\n    },\n});\n\nconst createDragHelper = items => {\n    const itemIds = items.map(item => item.id);\n    let prevIndex = undefined;\n    return {\n        setIndex: index => {\n            prevIndex = index;\n        },\n        getIndex: () => prevIndex,\n        getItemIndex: item => itemIds.indexOf(item.id),\n    };\n};\n\nconst ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10,\n};\n\nconst ITEM_SCALE_SPRING = 'spring';\n\nconst StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy processing',\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle',\n};\n\n/**\n * Creates the file view\n */\nconst create$7 = ({ root, props }) => {\n    // select\n    root.ref.handleClick = e => root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n\n    // set id\n    root.element.id = `filepond--item-${props.id}`;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, { id: props.id }));\n\n    // file panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'item-panel' }));\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n\n    // if not allowed to reorder file items, exit here\n    if (!root.query('GET_ALLOW_REORDER')) return;\n\n    // set to idle so shows grab cursor\n    root.element.dataset.dragState = 'idle';\n\n    const grab = e => {\n        if (!e.isPrimary) return;\n\n        let removedActivateListener = false;\n\n        const origin = {\n            x: e.pageX,\n            y: e.pageY,\n        };\n\n        props.dragOrigin = {\n            x: root.translateX,\n            y: root.translateY,\n        };\n\n        props.dragCenter = {\n            x: e.offsetX,\n            y: e.offsetY,\n        };\n\n        const dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n\n        root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState });\n\n        const drag = e => {\n            if (!e.isPrimary) return;\n\n            e.stopPropagation();\n            e.preventDefault();\n\n            props.dragOffset = {\n                x: e.pageX - origin.x,\n                y: e.pageY - origin.y,\n            };\n\n            // if dragged stop listening to clicks, will re-add when done dragging\n            const dist =\n                props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\n            if (dist > 16 && !removedActivateListener) {\n                removedActivateListener = true;\n                root.element.removeEventListener('click', root.ref.handleClick);\n            }\n\n            root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState });\n        };\n\n        const drop = e => {\n            if (!e.isPrimary) return;\n\n            props.dragOffset = {\n                x: e.pageX - origin.x,\n                y: e.pageY - origin.y,\n            };\n\n            reset();\n        };\n\n        const cancel = () => {\n            reset();\n        };\n\n        const reset = () => {\n            document.removeEventListener('pointercancel', cancel);\n            document.removeEventListener('pointermove', drag);\n            document.removeEventListener('pointerup', drop);\n\n            root.dispatch('DID_DROP_ITEM', { id: props.id, dragState });\n\n            // start listening to clicks again\n            if (removedActivateListener) {\n                setTimeout(() => root.element.addEventListener('click', root.ref.handleClick), 0);\n            }\n        };\n\n        document.addEventListener('pointercancel', cancel);\n        document.addEventListener('pointermove', drag);\n        document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n};\n\nconst route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: ({ root, action }) => {\n        root.height = action.height;\n    },\n});\n\nconst write$4 = createRoute(\n    {\n        DID_GRAB_ITEM: ({ root, props }) => {\n            props.dragOrigin = {\n                x: root.translateX,\n                y: root.translateY,\n            };\n        },\n        DID_DRAG_ITEM: ({ root }) => {\n            root.element.dataset.dragState = 'drag';\n        },\n        DID_DROP_ITEM: ({ root, props }) => {\n            props.dragOffset = null;\n            props.dragOrigin = null;\n            root.element.dataset.dragState = 'drop';\n        },\n    },\n    ({ root, actions, props, shouldOptimize }) => {\n        if (root.element.dataset.dragState === 'drop') {\n            if (root.scaleX <= 1) {\n                root.element.dataset.dragState = 'idle';\n            }\n        }\n\n        // select last state change action\n        let action = actions\n            .concat()\n            .filter(action => /^DID_/.test(action.type))\n            .reverse()\n            .find(action => StateMap[action.type]);\n\n        // no need to set same state twice\n        if (action && action.type !== props.currentState) {\n            // set current state\n            props.currentState = action.type;\n\n            // set state\n            root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n        }\n\n        // route actions\n        const aspectRatio =\n            root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n        if (!aspectRatio) {\n            route$1({ root, actions, props });\n            if (!root.height && root.ref.container.rect.element.height > 0) {\n                root.height = root.ref.container.rect.element.height;\n            }\n        } else if (!shouldOptimize) {\n            root.height = root.rect.element.width * aspectRatio;\n        }\n\n        // sync panel height with item height\n        if (shouldOptimize) {\n            root.ref.panel.height = null;\n        }\n\n        root.ref.panel.height = root.height;\n    }\n);\n\nconst item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: ({ root, props }) => {\n        root.element.removeEventListener('click', root.ref.handleClick);\n        root.dispatch('RELEASE_ITEM', { query: props.id });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n        apis: [\n            'id',\n            'interactionMethod',\n            'markedForRemoval',\n            'spawnDate',\n            'dragCenter',\n            'dragOrigin',\n            'dragOffset',\n        ],\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n        animations: {\n            scaleX: ITEM_SCALE_SPRING,\n            scaleY: ITEM_SCALE_SPRING,\n            translateX: ITEM_TRANSLATE_SPRING,\n            translateY: ITEM_TRANSLATE_SPRING,\n            opacity: { type: 'tween', duration: 150 },\n        },\n    },\n});\n\nvar getItemsPerRow = (horizontalSpace, itemWidth) => {\n    // add one pixel leeway, when using percentages for item width total items can be 1.99 per row\n\n    return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));\n};\n\nconst getItemIndexByPosition = (view, children, positionInView) => {\n    if (!positionInView) return;\n\n    const horizontalSpace = view.rect.element.width;\n    // const children = view.childViews;\n    const l = children.length;\n    let last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    const item = children[0];\n    const itemRect = item.rect.element;\n    const itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    const itemWidth = itemRect.width + itemHorizontalMargin;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        for (let index = 0; index < l; index++) {\n            const child = children[index];\n            const childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n            if (positionInView.top < childMid) {\n                return index;\n            }\n        }\n        return l;\n    }\n\n    // grid\n    const itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    const itemHeight = itemRect.height + itemVerticalMargin;\n    for (let index = 0; index < l; index++) {\n        const indexX = index % itemsPerRow;\n        const indexY = Math.floor(index / itemsPerRow);\n\n        const offsetX = indexX * itemWidth;\n        const offsetY = indexY * itemHeight;\n\n        const itemTop = offsetY - itemRect.marginTop;\n        const itemRight = offsetX + itemWidth;\n        const itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n        if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n            if (positionInView.left < itemRight) {\n                return index;\n            } else if (index !== l - 1) {\n                last = index;\n            } else {\n                last = null;\n            }\n        }\n    }\n\n    if (last !== null) {\n        return last;\n    }\n\n    return l;\n};\n\nconst dropAreaDimensions = {\n    height: 0,\n    width: 0,\n    get getHeight() {\n        return this.height;\n    },\n    set setHeight(val) {\n        if (this.height === 0 || val === 0) this.height = val;\n    },\n    get getWidth() {\n        return this.width;\n    },\n    set setWidth(val) {\n        if (this.width === 0 || val === 0) this.width = val;\n    },\n    setDimensions: function(height, width) {\n        if (this.height === 0 || height === 0) this.height = height;\n        if (this.width === 0 || width === 0) this.width = width;\n    },\n};\n\nconst create$8 = ({ root }) => {\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n\n    root.ref.lastItemSpanwDate = Date.now();\n};\n\n/**\n * Inserts a new item\n * @param root\n * @param action\n */\nconst addItemView = ({ root, action }) => {\n    const { id, index, interactionMethod } = action;\n\n    root.ref.addIndex = index;\n\n    const now = Date.now();\n    let spawnDate = now;\n    let opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n        opacity = 0;\n        const cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n        const dist = now - root.ref.lastItemSpanwDate;\n        spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n\n    root.appendChildView(\n        root.createChildView(\n            // view type\n            item,\n\n            // props\n            {\n                spawnDate,\n                id,\n                opacity,\n                interactionMethod,\n            }\n        ),\n        index\n    );\n};\n\nconst moveItem = (item, x, y, vx = 0, vy = 1) => {\n    // set to null to remove animation while dragging\n    if (item.dragOffset) {\n        item.translateX = null;\n        item.translateY = null;\n        item.translateX = item.dragOrigin.x + item.dragOffset.x;\n        item.translateY = item.dragOrigin.y + item.dragOffset.y;\n        item.scaleX = 1.025;\n        item.scaleY = 1.025;\n    } else {\n        item.translateX = x;\n        item.translateY = y;\n\n        if (Date.now() > item.spawnDate) {\n            // reveal element\n            if (item.opacity === 0) {\n                introItemView(item, x, y, vx, vy);\n            }\n\n            // make sure is default scale every frame\n            item.scaleX = 1;\n            item.scaleY = 1;\n            item.opacity = 1;\n        }\n    }\n};\n\nconst introItemView = (item, x, y, vx, vy) => {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n        item.translateX = null;\n        item.translateX = x;\n        item.translateY = null;\n        item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n        item.translateX = null;\n        item.translateX = x - vx * 20;\n\n        item.translateY = null;\n        item.translateY = y - vy * 10;\n\n        item.scaleX = 0.8;\n        item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n        item.translateY = null;\n        item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n        item.translateX = null;\n        item.translateX = x - 30;\n        item.translateY = null;\n    }\n};\n\n/**\n * Removes an existing item\n * @param root\n * @param action\n */\nconst removeItemView = ({ root, action }) => {\n    const { id } = action;\n\n    // get the view matching the given id\n    const view = root.childViews.find(child => child.id === id);\n\n    // if no view found, exit\n    if (!view) {\n        return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n};\n\nconst getItemHeight = child =>\n    child.rect.element.height + child.rect.element.marginBottom + child.rect.element.marginTop;\nconst getItemWidth = child =>\n    child.rect.element.width +\n    child.rect.element.marginLeft * 0.5 +\n    child.rect.element.marginRight * 0.5;\n\nconst dragItem = ({ root, action }) => {\n    const { id, dragState } = action;\n\n    // reference to item\n    const item = root.query('GET_ITEM', { id });\n\n    // get the view matching the given id\n    const view = root.childViews.find(child => child.id === id);\n\n    const numItems = root.childViews.length;\n    const oldIndex = dragState.getItemIndex(item);\n\n    // if no view found, exit\n    if (!view) return;\n\n    const dragPosition = {\n        x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n        y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y,\n    };\n\n    // get drag area dimensions\n    const dragHeight = getItemHeight(view);\n    const dragWidth = getItemWidth(view);\n\n    // get rows and columns (There will always be at least one row and one column if a file is present)\n    let cols = Math.floor(root.rect.outer.width / dragWidth);\n    if (cols > numItems) cols = numItems;\n\n    // rows are used to find when we have left the preview area bounding box\n    const rows = Math.floor(numItems / cols + 1);\n\n    dropAreaDimensions.setHeight = dragHeight * rows;\n    dropAreaDimensions.setWidth = dragWidth * cols;\n\n    // get new index of dragged item\n    var location = {\n        y: Math.floor(dragPosition.y / dragHeight),\n        x: Math.floor(dragPosition.x / dragWidth),\n        getGridIndex: function getGridIndex() {\n            if (\n                dragPosition.y > dropAreaDimensions.getHeight ||\n                dragPosition.y < 0 ||\n                dragPosition.x > dropAreaDimensions.getWidth ||\n                dragPosition.x < 0\n            )\n                return oldIndex;\n            return this.y * cols + this.x;\n        },\n        getColIndex: function getColIndex() {\n            const items = root.query('GET_ACTIVE_ITEMS');\n            const visibleChildren = root.childViews.filter(child => child.rect.element.height);\n            const children = items.map(item =>\n                visibleChildren.find(childView => childView.id === item.id)\n            );\n            const currentIndex = children.findIndex(child => child === view);\n            const dragHeight = getItemHeight(view);\n            const l = children.length;\n            let idx = l;\n            let childHeight = 0;\n            let childBottom = 0;\n            let childTop = 0;\n            for (let i = 0; i < l; i++) {\n                childHeight = getItemHeight(children[i]);\n                childTop = childBottom;\n                childBottom = childTop + childHeight;\n                if (dragPosition.y < childBottom) {\n                    if (currentIndex > i) {\n                        if (dragPosition.y < childTop + dragHeight) {\n                            idx = i;\n                            break;\n                        }\n                        continue;\n                    }\n                    idx = i;\n                    break;\n                }\n            }\n            return idx;\n        },\n    };\n\n    // get new index\n    const index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n    root.dispatch('MOVE_ITEM', { query: view, index });\n\n    // if the index of the item changed, dispatch reorder action\n    const currentIndex = dragState.getIndex();\n\n    if (currentIndex === undefined || currentIndex !== index) {\n        dragState.setIndex(index);\n\n        if (currentIndex === undefined) return;\n\n        root.dispatch('DID_REORDER_ITEMS', {\n            items: root.query('GET_ACTIVE_ITEMS'),\n            origin: oldIndex,\n            target: index,\n        });\n    }\n};\n\n/**\n * Setup action routes\n */\nconst route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem,\n});\n\n/**\n * Write to view\n * @param root\n * @param actions\n * @param props\n */\nconst write$5 = ({ root, props, actions, shouldOptimize }) => {\n    // route actions\n    route$2({ root, props, actions });\n\n    const { dragCoordinates } = props;\n\n    // available space on horizontal axis\n    const horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    const visibleChildren = root.childViews.filter(child => child.rect.element.height);\n\n    // sort based on current active items\n    const children = root\n        .query('GET_ACTIVE_ITEMS')\n        .map(item => visibleChildren.find(child => child.id === item.id))\n        .filter(item => item);\n\n    // get index\n    const dragIndex = dragCoordinates\n        ? getItemIndexByPosition(root, children, dragCoordinates)\n        : null;\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    const addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n\n    let dragIndexOffset = 0;\n    let removeIndexOffset = 0;\n    let addIndexOffset = 0;\n\n    if (children.length === 0) return;\n\n    const childRect = children[0].rect.element;\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    const itemWidth = childRect.width + itemHorizontalMargin;\n    const itemHeight = childRect.height + itemVerticalMargin;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        let offsetY = 0;\n        let dragOffset = 0;\n\n        children.forEach((child, index) => {\n            if (dragIndex) {\n                let dist = index - dragIndex;\n                if (dist === -2) {\n                    dragOffset = -itemVerticalMargin * 0.25;\n                } else if (dist === -1) {\n                    dragOffset = -itemVerticalMargin * 0.75;\n                } else if (dist === 0) {\n                    dragOffset = itemVerticalMargin * 0.75;\n                } else if (dist === 1) {\n                    dragOffset = itemVerticalMargin * 0.25;\n                } else {\n                    dragOffset = 0;\n                }\n            }\n\n            if (shouldOptimize) {\n                child.translateX = null;\n                child.translateY = null;\n            }\n\n            if (!child.markedForRemoval) {\n                moveItem(child, 0, offsetY + dragOffset);\n            }\n\n            let itemHeight = child.rect.element.height + itemVerticalMargin;\n\n            let visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n            offsetY += visualHeight;\n        });\n    }\n    // grid\n    else {\n        let prevX = 0;\n        let prevY = 0;\n\n        children.forEach((child, index) => {\n            if (index === dragIndex) {\n                dragIndexOffset = 1;\n            }\n\n            if (index === addIndex) {\n                addIndexOffset += 1;\n            }\n\n            if (child.markedForRemoval && child.opacity < 0.5) {\n                removeIndexOffset -= 1;\n            }\n\n            const visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n            const indexX = visualIndex % itemsPerRow;\n            const indexY = Math.floor(visualIndex / itemsPerRow);\n\n            const offsetX = indexX * itemWidth;\n            const offsetY = indexY * itemHeight;\n\n            const vectorX = Math.sign(offsetX - prevX);\n            const vectorY = Math.sign(offsetY - prevY);\n\n            prevX = offsetX;\n            prevY = offsetY;\n\n            if (child.markedForRemoval) return;\n\n            if (shouldOptimize) {\n                child.translateX = null;\n                child.translateY = null;\n            }\n\n            moveItem(child, offsetX, offsetY, vectorX, vectorY);\n        });\n    }\n};\n\n/**\n * Filters actions that are meant specifically for a certain child of the list\n * @param child\n * @param actions\n */\nconst filterSetItemActions = (child, actions) =>\n    actions.filter(action => {\n        // if action has an id, filter out actions that don't have this child id\n        if (action.data && action.data.id) {\n            return child.id === action.data.id;\n        }\n\n        // allow all other actions\n        return true;\n    });\n\nconst list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: ({ root }) => {\n        root.childViews\n            .filter(view => view.markedForRemoval && view.opacity === 0 && view.resting)\n            .forEach(view => {\n                view._destroy();\n                root.removeChildView(view);\n            });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n        apis: ['dragCoordinates'],\n    },\n});\n\nconst create$9 = ({ root, props }) => {\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n};\n\nconst storeDragCoordinates = ({ root, props, action }) => {\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n        left: action.position.scopeLeft - root.ref.list.rect.element.left,\n        top:\n            action.position.scopeTop -\n            (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop),\n    };\n};\n\nconst clearDragCoordinates = ({ props }) => {\n    props.dragCoordinates = null;\n};\n\nconst route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates,\n});\n\nconst write$6 = ({ root, props, actions }) => {\n    // route actions\n    route$3({ root, props, actions });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n        props.overflowing = false;\n\n        // reset overflow state\n        root.element.dataset.state = '';\n        root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n        const newHeight = Math.round(props.overflow);\n        if (newHeight !== root.height) {\n            props.overflowing = true;\n            root.element.dataset.state = 'overflow';\n            root.height = newHeight;\n        }\n    }\n};\n\nconst listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n        apis: ['overflow', 'dragCoordinates'],\n        styles: ['height', 'translateY'],\n        animations: {\n            translateY: 'spring',\n        },\n    },\n});\n\nconst attrToggle = (element, name, state, enabledValue = '') => {\n    if (state) {\n        attr(element, name, enabledValue);\n    } else {\n        element.removeAttribute(name);\n    }\n};\n\nconst resetFileInput = input => {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n        return;\n    }\n\n    try {\n        // for modern browsers\n        input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n        // quickly append input to temp form and reset form\n        const form = createElement$1('form');\n        const parentNode = input.parentNode;\n        const ref = input.nextSibling;\n        form.appendChild(input);\n        form.reset();\n\n        // re-inject input where it originally was\n        if (ref) {\n            parentNode.insertBefore(input, ref);\n        } else {\n            parentNode.appendChild(input);\n        }\n    }\n};\n\nconst create$a = ({ root, props }) => {\n    // set id so can be referenced from outside labels\n    root.element.id = `filepond--browser-${props.id}`;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', `filepond--assistant-${props.id}`);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', `filepond--drop-label-${props.id}`);\n\n    // set configurable props\n    setAcceptedFileTypes({ root, action: { value: root.query('GET_ACCEPTED_FILE_TYPES') } });\n    toggleAllowMultiple({ root, action: { value: root.query('GET_ALLOW_MULTIPLE') } });\n    toggleDirectoryFilter({ root, action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') } });\n    toggleDisabled({ root });\n    toggleRequired({ root, action: { value: root.query('GET_REQUIRED') } });\n    setCaptureMethod({ root, action: { value: root.query('GET_CAPTURE_METHOD') } });\n\n    // handle changes to the input field\n    root.ref.handleChange = e => {\n        if (!root.element.value) {\n            return;\n        }\n\n        // extract files and move value of webkitRelativePath path to _relativePath\n        const files = Array.from(root.element.files).map(file => {\n            file._relativePath = file.webkitRelativePath;\n            return file;\n        });\n\n        // we add a little delay so the OS file select window can move out of the way before we add our file\n        setTimeout(() => {\n            // load files\n            props.onload(files);\n\n            // reset input, it's just for exposing a method to drop files, should not retain any state\n            resetFileInput(root.element);\n        }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n};\n\nconst setAcceptedFileTypes = ({ root, action }) => {\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n};\n\nconst toggleAllowMultiple = ({ root, action }) => {\n    attrToggle(root.element, 'multiple', action.value);\n};\n\nconst toggleDirectoryFilter = ({ root, action }) => {\n    attrToggle(root.element, 'webkitdirectory', action.value);\n};\n\nconst toggleDisabled = ({ root }) => {\n    const isDisabled = root.query('GET_DISABLED');\n    const doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    const disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n};\n\nconst toggleRequired = ({ root, action }) => {\n    // want to remove required, always possible\n    if (!action.value) {\n        attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n        attrToggle(root.element, 'required', true);\n    }\n};\n\nconst setCaptureMethod = ({ root, action }) => {\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n};\n\nconst updateRequiredStatus = ({ root }) => {\n    const { element } = root;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n        attrToggle(element, 'required', false);\n        attrToggle(element, 'name', false);\n\n        // still has items\n        const activeItems = root.query('GET_ACTIVE_ITEMS');\n        let hasInvalidField = false;\n        for (let i = 0; i < activeItems.length; i++) {\n            if (activeItems[i].status === ItemStatus.LOAD_ERROR) {\n                hasInvalidField = true;\n            }\n        }\n        // set validity status\n        root.element.setCustomValidity(\n            hasInvalidField ? root.query('GET_LABEL_INVALID_FIELD') : ''\n        );\n    } else {\n        // add name attribute\n        attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n        // remove any validation messages\n        const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n        if (shouldCheckValidity) {\n            element.setCustomValidity('');\n        }\n\n        // we only add required if the field has been deemed required\n        if (root.query('GET_REQUIRED')) {\n            attrToggle(element, 'required', true);\n        }\n    }\n};\n\nconst updateFieldValidityStatus = ({ root }) => {\n    const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n};\n\nconst browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n        type: 'file',\n    },\n    create: create$a,\n    destroy: ({ root }) => {\n        root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n        DID_LOAD_ITEM: updateRequiredStatus,\n        DID_REMOVE_ITEM: updateRequiredStatus,\n        DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n        DID_SET_DISABLED: toggleDisabled,\n        DID_SET_ALLOW_BROWSE: toggleDisabled,\n        DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n        DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n        DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n        DID_SET_CAPTURE_METHOD: setCaptureMethod,\n        DID_SET_REQUIRED: toggleRequired,\n    }),\n});\n\nconst Key = {\n    ENTER: 13,\n    SPACE: 32,\n};\n\nconst create$b = ({ root, props }) => {\n    // create the label and link it to the file browser\n    const label = createElement$1('label');\n    attr(label, 'for', `filepond--browser-${props.id}`);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', `filepond--drop-label-${props.id}`);\n\n    // handle keys\n    root.ref.handleKeyDown = e => {\n        const isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n        if (!isActivationKey) return;\n        // stops from triggering the element a second time\n        e.preventDefault();\n\n        // click link (will then in turn activate file input)\n        root.ref.label.click();\n    };\n\n    root.ref.handleClick = e => {\n        const isLabelClick = e.target === label || label.contains(e.target);\n\n        // don't want to click twice\n        if (isLabelClick) return;\n\n        // click link (will then in turn activate file input)\n        root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n};\n\nconst updateLabelValue = (label, value) => {\n    label.innerHTML = value;\n    const clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n        attr(clickable, 'tabindex', '0');\n    }\n    return value;\n};\n\nconst dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: ({ root }) => {\n        root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n        root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n        DID_SET_LABEL_IDLE: ({ root, action }) => {\n            updateLabelValue(root.ref.label, action.value);\n        },\n    }),\n    mixins: {\n        styles: ['opacity', 'translateX', 'translateY'],\n        animations: {\n            opacity: { type: 'tween', duration: 150 },\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\nconst blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            translateX: 'spring',\n            translateY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n    },\n});\n\nconst addBlob = ({ root }) => {\n    const centerX = root.rect.element.width * 0.5;\n    const centerY = root.rect.element.height * 0.5;\n\n    root.ref.blob = root.appendChildView(\n        root.createChildView(blob, {\n            opacity: 0,\n            scaleX: 2.5,\n            scaleY: 2.5,\n            translateX: centerX,\n            translateY: centerY,\n        })\n    );\n};\n\nconst moveBlob = ({ root, action }) => {\n    if (!root.ref.blob) {\n        addBlob({ root });\n        return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n};\n\nconst hideBlob = ({ root }) => {\n    if (!root.ref.blob) {\n        return;\n    }\n    root.ref.blob.opacity = 0;\n};\n\nconst explodeBlob = ({ root }) => {\n    if (!root.ref.blob) {\n        return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n};\n\nconst write$7 = ({ root, props, actions }) => {\n    route$4({ root, props, actions });\n\n    const { blob } = root.ref;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n        root.removeChildView(blob);\n        root.ref.blob = null;\n    }\n};\n\nconst route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob,\n});\n\nconst drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7,\n});\n\nconst setInputFiles = (element, files) => {\n    try {\n        // Create a DataTransfer instance and add a newly created file\n        const dataTransfer = new DataTransfer();\n        files.forEach(file => {\n            if (file instanceof File) {\n                dataTransfer.items.add(file);\n            } else {\n                dataTransfer.items.add(\n                    new File([file], file.name, {\n                        type: file.type,\n                    })\n                );\n            }\n        });\n\n        // Assign the DataTransfer files list to the file input\n        element.files = dataTransfer.files;\n    } catch (err) {\n        return false;\n    }\n    return true;\n};\n\nconst create$c = ({ root }) => {\n    root.ref.fields = {};\n    const legend = document.createElement('legend');\n    legend.textContent = 'Files';\n    root.element.appendChild(legend);\n};\n\nconst getField = (root, id) => root.ref.fields[id];\n\nconst syncFieldPositionsWithItems = root => {\n    root.query('GET_ACTIVE_ITEMS').forEach(item => {\n        if (!root.ref.fields[item.id]) return;\n        root.element.appendChild(root.ref.fields[item.id]);\n    });\n};\n\nconst didReorderItems = ({ root }) => syncFieldPositionsWithItems(root);\n\nconst didAddItem = ({ root, action }) => {\n    const fileItem = root.query('GET_ITEM', action.id);\n    const isLocalFile = fileItem.origin === FileOrigin.LOCAL;\n    const shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');\n    const dataContainer = createElement$1('input');\n    dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    root.ref.fields[action.id] = dataContainer;\n    syncFieldPositionsWithItems(root);\n};\n\nconst didLoadItem$1 = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n\n    // store server ref in hidden input\n    if (action.serverFileReference !== null) field.value = action.serverFileReference;\n\n    // store file item in file input\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n\n    const fileItem = root.query('GET_ITEM', action.id);\n    setInputFiles(field, [fileItem.file]);\n};\n\nconst didPrepareOutput = ({ root, action }) => {\n    // this timeout pushes the handler after 'load'\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n    setTimeout(() => {\n        const field = getField(root, action.id);\n        if (!field) return;\n        setInputFiles(field, [action.file]);\n    }, 0);\n};\n\nconst didSetDisabled = ({ root }) => {\n    root.element.disabled = root.query('GET_DISABLED');\n};\n\nconst didRemoveItem = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n    if (field.parentNode) field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n};\n\n// only runs for server files. will refuse to update the value if the field\n// is a file field\nconst didDefineValue = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n    if (action.value === null) {\n        // clear field value\n        field.removeAttribute('value');\n    } else {\n        // set field value\n        if (field.type != 'file') {\n            field.value = action.value;\n        }\n    }\n    syncFieldPositionsWithItems(root);\n};\n\nconst write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_PREPARE_OUTPUT: didPrepareOutput,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems,\n});\n\nconst data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true,\n});\n\nconst getRootNode = element => ('getRootNode' in element ? element.getRootNode() : document);\n\nconst images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\nconst text$1 = ['css', 'csv', 'html', 'txt'];\nconst map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip',\n};\n\nconst guesstimateMimeType = (extension = '') => {\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n        return (\n            'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension)\n        );\n    }\n    if (text$1.includes(extension)) {\n        return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n};\n\nconst requestDataTransferItems = dataTransfer =>\n    new Promise((resolve, reject) => {\n        // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n        const links = getLinks(dataTransfer);\n        if (links.length && !hasFiles(dataTransfer)) {\n            return resolve(links);\n        }\n        // try to get files from the transfer\n        getFiles(dataTransfer).then(resolve);\n    });\n\n/**\n * Test if datatransfer has files\n */\nconst hasFiles = dataTransfer => {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n};\n\n/**\n * Extracts files from a DataTransfer object\n */\nconst getFiles = dataTransfer =>\n    new Promise((resolve, reject) => {\n        // get the transfer items as promises\n        const promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : [])\n\n            // only keep file system items (files and directories)\n            .filter(item => isFileSystemItem(item))\n\n            // map each item to promise\n            .map(item => getFilesFromItem(item));\n\n        // if is empty, see if we can extract some info from the files property as a fallback\n        if (!promisedFiles.length) {\n            // TODO: test for directories (should not be allowed)\n            // Use FileReader, problem is that the files property gets lost in the process\n            resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n            return;\n        }\n\n        // done!\n        Promise.all(promisedFiles)\n            .then(returnedFileGroups => {\n                // flatten groups\n                const files = [];\n                returnedFileGroups.forEach(group => {\n                    files.push.apply(files, group);\n                });\n\n                // done (filter out empty files)!\n                resolve(\n                    files\n                        .filter(file => file)\n                        .map(file => {\n                            if (!file._relativePath) file._relativePath = file.webkitRelativePath;\n                            return file;\n                        })\n                );\n            })\n            .catch(console.error);\n    });\n\nconst isFileSystemItem = item => {\n    if (isEntry(item)) {\n        const entry = getAsEntry(item);\n        if (entry) {\n            return entry.isFile || entry.isDirectory;\n        }\n    }\n    return item.kind === 'file';\n};\n\nconst getFilesFromItem = item =>\n    new Promise((resolve, reject) => {\n        if (isDirectoryEntry(item)) {\n            getFilesInDirectory(getAsEntry(item))\n                .then(resolve)\n                .catch(reject);\n            return;\n        }\n\n        resolve([item.getAsFile()]);\n    });\n\nconst getFilesInDirectory = entry =>\n    new Promise((resolve, reject) => {\n        const files = [];\n\n        // the total entries to read\n        let dirCounter = 0;\n        let fileCounter = 0;\n\n        const resolveIfDone = () => {\n            if (fileCounter === 0 && dirCounter === 0) {\n                resolve(files);\n            }\n        };\n\n        // the recursive function\n        const readEntries = dirEntry => {\n            dirCounter++;\n\n            const directoryReader = dirEntry.createReader();\n\n            // directories are returned in batches, we need to process all batches before we're done\n            const readBatch = () => {\n                directoryReader.readEntries(entries => {\n                    if (entries.length === 0) {\n                        dirCounter--;\n                        resolveIfDone();\n                        return;\n                    }\n\n                    entries.forEach(entry => {\n                        // recursively read more directories\n                        if (entry.isDirectory) {\n                            readEntries(entry);\n                        } else {\n                            // read as file\n                            fileCounter++;\n\n                            entry.file(file => {\n                                const correctedFile = correctMissingFileType(file);\n                                if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\n                                files.push(correctedFile);\n                                fileCounter--;\n                                resolveIfDone();\n                            });\n                        }\n                    });\n\n                    // try to get next batch of files\n                    readBatch();\n                }, reject);\n            };\n\n            // read first batch of files\n            readBatch();\n        };\n\n        // go!\n        readEntries(entry);\n    });\n\nconst correctMissingFileType = file => {\n    if (file.type.length) return file;\n    const date = file.lastModifiedDate;\n    const name = file.name;\n    const type = guesstimateMimeType(getExtensionFromFilename(file.name));\n    if (!type.length) return file;\n    file = file.slice(0, file.size, type);\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n};\n\nconst isDirectoryEntry = item => isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n\nconst isEntry = item => 'webkitGetAsEntry' in item;\n\nconst getAsEntry = item => item.webkitGetAsEntry();\n\n/**\n * Extracts links from a DataTransfer object\n */\nconst getLinks = dataTransfer => {\n    let links = [];\n    try {\n        // look in meta data property\n        links = getLinksFromTransferMetaData(dataTransfer);\n        if (links.length) {\n            return links;\n        }\n        links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n        // nope nope nope (probably IE trouble)\n    }\n    return links;\n};\n\nconst getLinksFromTransferURLData = dataTransfer => {\n    let data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n        return [data];\n    }\n    return [];\n};\n\nconst getLinksFromTransferMetaData = dataTransfer => {\n    let data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n        const matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n        if (matches) {\n            return [matches[1]];\n        }\n    }\n    return [];\n};\n\nconst dragNDropObservers = [];\n\nconst eventPosition = e => ({\n    pageLeft: e.pageX,\n    pageTop: e.pageY,\n    scopeLeft: e.offsetX || e.layerX,\n    scopeTop: e.offsetY || e.layerY,\n});\n\nconst createDragNDropClient = (element, scopeToObserve, filterElement) => {\n    const observer = getDragNDropObserver(scopeToObserve);\n\n    const client = {\n        element,\n        filterElement,\n        state: null,\n        ondrop: () => {},\n        onenter: () => {},\n        ondrag: () => {},\n        onexit: () => {},\n        onload: () => {},\n        allowdrop: () => {},\n    };\n\n    client.destroy = observer.addListener(client);\n\n    return client;\n};\n\nconst getDragNDropObserver = element => {\n    // see if already exists, if so, return\n    const observer = dragNDropObservers.find(item => item.element === element);\n    if (observer) {\n        return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    const newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n};\n\nconst createDragNDropObserver = element => {\n    const clients = [];\n\n    const routes = {\n        dragenter,\n        dragover,\n        dragleave,\n        drop,\n    };\n\n    const handlers = {};\n\n    forin(routes, (event, createHandler) => {\n        handlers[event] = createHandler(element, clients);\n        element.addEventListener(event, handlers[event], false);\n    });\n\n    const observer = {\n        element,\n        addListener: client => {\n            // add as client\n            clients.push(client);\n\n            // return removeListener function\n            return () => {\n                // remove client\n                clients.splice(clients.indexOf(client), 1);\n\n                // if no more clients, clean up observer\n                if (clients.length === 0) {\n                    dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n                    forin(routes, event => {\n                        element.removeEventListener(event, handlers[event], false);\n                    });\n                }\n            };\n        },\n    };\n\n    return observer;\n};\n\nconst elementFromPoint = (root, point) => {\n    if (!('elementFromPoint' in root)) {\n        root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n};\n\nconst isEventTarget = (e, target) => {\n    // get root\n    const root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    const elementAtPosition = elementFromPoint(root, {\n        x: e.pageX - window.pageXOffset,\n        y: e.pageY - window.pageYOffset,\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n};\n\nlet initialTarget = null;\n\nconst setDropEffect = (dataTransfer, effect) => {\n    // is in try catch as IE11 will throw error if not\n    try {\n        dataTransfer.dropEffect = effect;\n    } catch (e) {}\n};\n\nconst dragenter = (root, clients) => e => {\n    e.preventDefault();\n\n    initialTarget = e.target;\n\n    clients.forEach(client => {\n        const { element, onenter } = client;\n\n        if (isEventTarget(e, element)) {\n            client.state = 'enter';\n\n            // fire enter event\n            onenter(eventPosition(e));\n        }\n    });\n};\n\nconst dragover = (root, clients) => e => {\n    e.preventDefault();\n\n    const dataTransfer = e.dataTransfer;\n\n    requestDataTransferItems(dataTransfer).then(items => {\n        let overDropTarget = false;\n\n        clients.some(client => {\n            const { filterElement, element, onenter, onexit, ondrag, allowdrop } = client;\n\n            // by default we can drop\n            setDropEffect(dataTransfer, 'copy');\n\n            // allow transfer of these items\n            const allowsTransfer = allowdrop(items);\n\n            // only used when can be dropped on page\n            if (!allowsTransfer) {\n                setDropEffect(dataTransfer, 'none');\n                return;\n            }\n\n            // targetting this client\n            if (isEventTarget(e, element)) {\n                overDropTarget = true;\n\n                // had no previous state, means we are entering this client\n                if (client.state === null) {\n                    client.state = 'enter';\n                    onenter(eventPosition(e));\n                    return;\n                }\n\n                // now over element (no matter if it allows the drop or not)\n                client.state = 'over';\n\n                // needs to allow transfer\n                if (filterElement && !allowsTransfer) {\n                    setDropEffect(dataTransfer, 'none');\n                    return;\n                }\n\n                // dragging\n                ondrag(eventPosition(e));\n            } else {\n                // should be over an element to drop\n                if (filterElement && !overDropTarget) {\n                    setDropEffect(dataTransfer, 'none');\n                }\n\n                // might have just left this client?\n                if (client.state) {\n                    client.state = null;\n                    onexit(eventPosition(e));\n                }\n            }\n        });\n    });\n};\n\nconst drop = (root, clients) => e => {\n    e.preventDefault();\n\n    const dataTransfer = e.dataTransfer;\n\n    requestDataTransferItems(dataTransfer).then(items => {\n        clients.forEach(client => {\n            const { filterElement, element, ondrop, onexit, allowdrop } = client;\n\n            client.state = null;\n\n            // if we're filtering on element we need to be over the element to drop\n            if (filterElement && !isEventTarget(e, element)) return;\n\n            // no transfer for this client\n            if (!allowdrop(items)) return onexit(eventPosition(e));\n\n            // we can drop these items on this client\n            ondrop(eventPosition(e), items);\n        });\n    });\n};\n\nconst dragleave = (root, clients) => e => {\n    if (initialTarget !== e.target) {\n        return;\n    }\n\n    clients.forEach(client => {\n        const { onexit } = client;\n\n        client.state = null;\n\n        onexit(eventPosition(e));\n    });\n};\n\nconst createHopper = (scope, validateItems, options) => {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    const { catchesDropsOnPage, requiresDropOnElement, filterItems = items => items } = options;\n\n    // create a dnd client\n    const client = createDragNDropClient(\n        scope,\n        catchesDropsOnPage ? document.documentElement : scope,\n        requiresDropOnElement\n    );\n\n    // current client state\n    let lastState = '';\n    let currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = items => {\n        // TODO: if we can, throw error to indicate the items cannot by dropped\n\n        return validateItems(filterItems(items));\n    };\n\n    client.ondrop = (position, items) => {\n        const filteredItems = filterItems(items);\n\n        if (!validateItems(filteredItems)) {\n            api.ondragend(position);\n            return;\n        }\n\n        currentState = 'drag-drop';\n\n        api.onload(filteredItems, position);\n    };\n\n    client.ondrag = position => {\n        api.ondrag(position);\n    };\n\n    client.onenter = position => {\n        currentState = 'drag-over';\n\n        api.ondragstart(position);\n    };\n\n    client.onexit = position => {\n        currentState = 'drag-exit';\n\n        api.ondragend(position);\n    };\n\n    const api = {\n        updateHopperState: () => {\n            if (lastState !== currentState) {\n                scope.dataset.hopperState = currentState;\n                lastState = currentState;\n            }\n        },\n        onload: () => {},\n        ondragstart: () => {},\n        ondrag: () => {},\n        ondragend: () => {},\n        destroy: () => {\n            // destroy client\n            client.destroy();\n        },\n    };\n\n    return api;\n};\n\nlet listening = false;\nconst listeners$1 = [];\n\nconst handlePaste = e => {\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n    const activeEl = document.activeElement;\n    const isActiveElementEditable =\n        activeEl &&\n        (/textarea|input/i.test(activeEl.nodeName) ||\n            activeEl.getAttribute('contenteditable') === 'true' ||\n            activeEl.getAttribute('contenteditable') === '');\n\n    if (isActiveElementEditable) {\n        // test textarea or input is contained in filepond root\n        let inScope = false;\n        let element = activeEl;\n        while (element !== document.body) {\n            if (element.classList.contains('filepond--root')) {\n                inScope = true;\n                break;\n            }\n            element = element.parentNode;\n        }\n\n        if (!inScope) return;\n    }\n\n    requestDataTransferItems(e.clipboardData).then(files => {\n        // no files received\n        if (!files.length) {\n            return;\n        }\n\n        // notify listeners of received files\n        listeners$1.forEach(listener => listener(files));\n    });\n};\n\nconst listen = cb => {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n        return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n        return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n};\n\nconst unlisten = listener => {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n        document.removeEventListener('paste', handlePaste);\n        listening = false;\n    }\n};\n\nconst createPaster = () => {\n    const cb = files => {\n        api.onload(files);\n    };\n\n    const api = {\n        destroy: () => {\n            unlisten(cb);\n        },\n        onload: () => {},\n    };\n\n    listen(cb);\n\n    return api;\n};\n\n/**\n * Creates the file view\n */\nconst create$d = ({ root, props }) => {\n    root.element.id = `filepond--assistant-${props.id}`;\n    attr(root.element, 'role', 'alert');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n};\n\nlet addFilesNotificationTimeout = null;\nlet notificationClearTimeout = null;\n\nconst filenames = [];\n\nconst assist = (root, message) => {\n    root.element.textContent = message;\n};\n\nconst clear$1 = root => {\n    root.element.textContent = '';\n};\n\nconst listModified = (root, filename, label) => {\n    const total = root.query('GET_TOTAL_ITEMS');\n    assist(\n        root,\n        `${label} ${filename}, ${total} ${\n            total === 1\n                ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n                : root.query('GET_LABEL_FILE_COUNT_PLURAL')\n        }`\n    );\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(() => {\n        clear$1(root);\n    }, 1500);\n};\n\nconst isUsingFilePond = root => root.element.parentNode.contains(document.activeElement);\n\nconst itemAdded = ({ root, action }) => {\n    if (!isUsingFilePond(root)) {\n        return;\n    }\n\n    root.element.textContent = '';\n    const item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(() => {\n        listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n        filenames.length = 0;\n    }, 750);\n};\n\nconst itemRemoved = ({ root, action }) => {\n    if (!isUsingFilePond(root)) {\n        return;\n    }\n\n    const item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n};\n\nconst itemProcessed = ({ root, action }) => {\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n    const label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n    assist(root, `${filename} ${label}`);\n};\n\nconst itemProcessedUndo = ({ root, action }) => {\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n    const label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n    assist(root, `${filename} ${label}`);\n};\n\nconst itemError = ({ root, action }) => {\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, `${action.status.main} ${filename} ${action.status.sub}`);\n};\n\nconst assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: itemAdded,\n        DID_REMOVE_ITEM: itemRemoved,\n        DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n        DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n        DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n        DID_THROW_ITEM_REMOVE_ERROR: itemError,\n        DID_THROW_ITEM_LOAD_ERROR: itemError,\n        DID_THROW_ITEM_INVALID: itemError,\n        DID_THROW_ITEM_PROCESSING_ERROR: itemError,\n    }),\n    tag: 'span',\n    name: 'assistant',\n});\n\nconst toCamels = (string, separator = '-') =>\n    string.replace(new RegExp(`${separator}.`, 'g'), sub => sub.charAt(1).toUpperCase());\n\nconst debounce = (func, interval = 16, immidiateOnly = true) => {\n    let last = Date.now();\n    let timeout = null;\n\n    return (...args) => {\n        clearTimeout(timeout);\n\n        const dist = Date.now() - last;\n\n        const fn = () => {\n            last = Date.now();\n            func(...args);\n        };\n\n        if (dist < interval) {\n            // we need to delay by the difference between interval and dist\n            // for example: if distance is 10 ms and interval is 16 ms,\n            // we need to wait an additional 6ms before calling the function)\n            if (!immidiateOnly) {\n                timeout = setTimeout(fn, interval - dist);\n            }\n        } else {\n            // go!\n            fn();\n        }\n    };\n};\n\nconst MAX_FILES_LIMIT = 1000000;\n\nconst prevent = e => e.preventDefault();\n\nconst create$e = ({ root, props }) => {\n    // Add id\n    const id = root.query('GET_ID');\n    if (id) {\n        root.element.id = id;\n    }\n\n    // Add className\n    const className = root.query('GET_CLASS_NAME');\n    if (className) {\n        className\n            .split(' ')\n            .filter(name => name.length)\n            .forEach(name => {\n                root.element.classList.add(name);\n            });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(\n        root.createChildView(dropLabel, {\n            ...props,\n            translateY: null,\n            caption: root.query('GET_LABEL_IDLE'),\n        })\n    );\n\n    // List of items\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, { translateY: null }));\n\n    // Background panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'panel-root' }));\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, { ...props }));\n\n    // Data\n    root.ref.data = root.appendChildView(root.createChildView(data, { ...props }));\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root.query('GET_STYLES')\n        .filter(style => !isEmpty(style.value))\n        .map(({ name, value }) => {\n            root.element.dataset[name] = value;\n        });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(() => {\n        root.ref.updateHistory = [];\n        root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n    const canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n    const hasPointerEvents = 'PointerEvent' in window;\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n        root.element.addEventListener('touchmove', prevent, { passive: false });\n        root.element.addEventListener('gesturestart', prevent);\n    }\n\n    // add credits\n    const credits = root.query('GET_CREDITS');\n    const hasCredits = credits.length === 2;\n    if (hasCredits) {\n        const frag = document.createElement('a');\n        frag.className = 'filepond--credits';\n        frag.href = credits[0];\n        frag.tabIndex = -1;\n        frag.target = '_blank';\n        frag.rel = 'noopener noreferrer nofollow';\n        frag.textContent = credits[1];\n        root.element.appendChild(frag);\n        root.ref.credits = frag;\n    }\n};\n\nconst write$9 = ({ root, props, actions }) => {\n    // route actions\n    route$5({ root, props, actions });\n\n    // apply style properties\n    actions\n        .filter(action => /^DID_SET_STYLE_/.test(action.type))\n        .filter(action => !isEmpty(action.data.value))\n        .map(({ type, data }) => {\n            const name = toCamels(type.substring(8).toLowerCase(), '_');\n            root.element.dataset[name] = data.value;\n            root.invalidateLayout();\n        });\n\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n        root.ref.widthPrevious = root.rect.element.width;\n        root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    let bounds = root.ref.bounds;\n    if (!bounds) {\n        bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n        // destroy measure element\n        root.element.removeChild(root.ref.measure);\n        root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    const { hopper, label, list, panel } = root.ref;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n        hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    const aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    const isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    const totalItems = root.query('GET_TOTAL_ITEMS');\n    const maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    const atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    const addAction = actions.find(action => action.type === 'DID_ADD_ITEM');\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n        // get interaction type\n        const interactionMethod = addAction.data.interactionMethod;\n\n        // hide label\n        label.opacity = 0;\n\n        if (isMultiItem) {\n            label.translateY = -40;\n        } else {\n            if (interactionMethod === InteractionMethod.API) {\n                label.translateX = 40;\n            } else if (interactionMethod === InteractionMethod.BROWSE) {\n                label.translateY = 40;\n            } else {\n                label.translateY = 30;\n            }\n        }\n    } else if (!atMaxCapacity) {\n        label.opacity = 1;\n        label.translateX = 0;\n        label.translateY = 0;\n    }\n\n    const listItemMargin = calculateListItemMargin(root);\n\n    const listHeight = calculateListHeight(root);\n\n    const labelHeight = label.rect.element.height;\n    const currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n    const listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    const listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n    const visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    const boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY =\n        Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n    if (aspectRatio) {\n        // fixed aspect ratio\n\n        // calculate height based on width\n        const width = root.rect.element.width;\n        const height = width * aspectRatio;\n\n        // clear history if aspect ratio has changed\n        if (aspectRatio !== root.ref.previousAspectRatio) {\n            root.ref.previousAspectRatio = aspectRatio;\n            root.ref.updateHistory = [];\n        }\n\n        // remember this width\n        const history = root.ref.updateHistory;\n        history.push(width);\n\n        const MAX_BOUNCES = 2;\n        if (history.length > MAX_BOUNCES * 2) {\n            const l = history.length;\n            const bottom = l - 10;\n            let bounces = 0;\n            for (let i = l; i >= bottom; i--) {\n                if (history[i] === history[i - 2]) {\n                    bounces++;\n                }\n\n                if (bounces >= MAX_BOUNCES) {\n                    // dont adjust height\n                    return;\n                }\n            }\n        }\n\n        // fix height of panel so it adheres to aspect ratio\n        panel.scalable = false;\n        panel.height = height;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            height -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        if (listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = height;\n    } else if (bounds.fixedHeight) {\n        // fixed height\n\n        // fix height of panel\n        panel.scalable = false;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            bounds.fixedHeight -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        // set list height\n        if (listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n        // max-height\n\n        // not a fixed height panel\n        const isCappedHeight = visualHeight >= bounds.cappedHeight;\n        const panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n        panel.scalable = true;\n        panel.height = isCappedHeight\n            ? panelHeight\n            : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            panelHeight -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        // set list height (if is overflowing)\n        if (visualHeight > bounds.cappedHeight && listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = Math.min(\n            bounds.cappedHeight,\n            boundsHeight - listItemMargin.top - listItemMargin.bottom\n        );\n    } else {\n        // flexible height\n\n        // not a fixed height panel\n        const itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n        panel.scalable = true;\n        panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n\n    // move credits to bottom\n    if (root.ref.credits && panel.heightCurrent)\n        root.ref.credits.style.transform = `translateY(${panel.heightCurrent}px)`;\n};\n\nconst calculateListItemMargin = root => {\n    const item = root.ref.list.childViews[0].childViews[0];\n    return item\n        ? {\n              top: item.rect.element.marginTop,\n              bottom: item.rect.element.marginBottom,\n          }\n        : {\n              top: 0,\n              bottom: 0,\n          };\n};\n\nconst calculateListHeight = root => {\n    let visual = 0;\n    let bounds = 0;\n\n    // get file list reference\n    const scrollList = root.ref.list;\n    const itemList = scrollList.childViews[0];\n    const visibleChildren = itemList.childViews.filter(child => child.rect.element.height);\n    const children = root\n        .query('GET_ACTIVE_ITEMS')\n        .map(item => visibleChildren.find(child => child.id === item.id))\n        .filter(item => item);\n\n    // no children, done!\n    if (children.length === 0) return { visual, bounds };\n\n    const horizontalSpace = itemList.rect.element.width;\n    const dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n\n    const childRect = children[0].rect.element;\n\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n    const itemWidth = childRect.width + itemHorizontalMargin;\n    const itemHeight = childRect.height + itemVerticalMargin;\n\n    const newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    const removedItem = children.find(child => child.markedForRemoval && child.opacity < 0.45)\n        ? -1\n        : 0;\n    const verticalItemCount = children.length + newItem + removedItem;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        children.forEach(item => {\n            const height = item.rect.element.height + itemVerticalMargin;\n            bounds += height;\n            visual += height * item.opacity;\n        });\n    }\n    // grid\n    else {\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n        visual = bounds;\n    }\n\n    return { visual, bounds };\n};\n\nconst calculateRootBoundingBoxHeight = root => {\n    const height = root.ref.measureHeight || null;\n    const cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    const fixedHeight = height === 0 ? null : height;\n\n    return {\n        cappedHeight,\n        fixedHeight,\n    };\n};\n\nconst exceedsMaxFiles = (root, items) => {\n    const allowReplace = root.query('GET_ALLOW_REPLACE');\n    const allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    const totalItems = root.query('GET_TOTAL_ITEMS');\n    let maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    const totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n        root.dispatch('DID_THROW_MAX_FILES', {\n            source: items,\n            error: createResponse('warning', 0, 'Max files'),\n        });\n        return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : 1;\n\n    if (!allowMultiple && allowReplace) {\n        // There is only one item, so there is room to replace or add an item\n        return false;\n    }\n\n    // no more room?\n    const hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n        root.dispatch('DID_THROW_MAX_FILES', {\n            source: items,\n            error: createResponse('warning', 0, 'Max files'),\n        });\n        return true;\n    }\n\n    return false;\n};\n\nconst getDragIndex = (list, children, position) => {\n    const itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n        left: position.scopeLeft - itemList.rect.element.left,\n        top:\n            position.scopeTop -\n            (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop),\n    });\n};\n\n/**\n * Enable or disable file drop functionality\n */\nconst toggleDrop = root => {\n    const isAllowed = root.query('GET_ALLOW_DROP');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n        const hopper = createHopper(\n            root.element,\n            items => {\n                // allow quick validation of dropped items\n                const beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || (() => true);\n\n                // all items should be validated by all filters as valid\n                const dropValidation = root.query('GET_DROP_VALIDATION');\n                return dropValidation\n                    ? items.every(\n                          item =>\n                              applyFilters('ALLOW_HOPPER_ITEM', item, {\n                                  query: root.query,\n                              }).every(result => result === true) && beforeDropFile(item)\n                      )\n                    : true;\n            },\n            {\n                filterItems: items => {\n                    const ignoredFiles = root.query('GET_IGNORED_FILES');\n                    return items.filter(item => {\n                        if (isFile(item)) {\n                            return !ignoredFiles.includes(item.name.toLowerCase());\n                        }\n                        return true;\n                    });\n                },\n                catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n                requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT'),\n            }\n        );\n\n        hopper.onload = (items, position) => {\n            // get item children elements and sort based on list sort\n            const list = root.ref.list.childViews[0];\n            const visibleChildren = list.childViews.filter(child => child.rect.element.height);\n            const children = root\n                .query('GET_ACTIVE_ITEMS')\n                .map(item => visibleChildren.find(child => child.id === item.id))\n                .filter(item => item);\n\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\n                // these files don't fit so stop here\n                if (exceedsMaxFiles(root, queue)) return false;\n\n                // go\n                root.dispatch('ADD_ITEMS', {\n                    items: queue,\n                    index: getDragIndex(root.ref.list, children, position),\n                    interactionMethod: InteractionMethod.DROP,\n                });\n            });\n\n            root.dispatch('DID_DROP', { position });\n\n            root.dispatch('DID_END_DRAG', { position });\n        };\n\n        hopper.ondragstart = position => {\n            root.dispatch('DID_START_DRAG', { position });\n        };\n\n        hopper.ondrag = debounce(position => {\n            root.dispatch('DID_DRAG', { position });\n        });\n\n        hopper.ondragend = position => {\n            root.dispatch('DID_END_DRAG', { position });\n        };\n\n        root.ref.hopper = hopper;\n\n        root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n        root.ref.hopper.destroy();\n        root.ref.hopper = null;\n        root.removeChildView(root.ref.drip);\n    }\n};\n\n/**\n * Enable or disable browse functionality\n */\nconst toggleBrowse = (root, props) => {\n    const isAllowed = root.query('GET_ALLOW_BROWSE');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n        root.ref.browser = root.appendChildView(\n            root.createChildView(browser, {\n                ...props,\n                onload: items => {\n                    applyFilterChain('ADD_ITEMS', items, {\n                        dispatch: root.dispatch,\n                    }).then(queue => {\n                        // these files don't fit so stop here\n                        if (exceedsMaxFiles(root, queue)) return false;\n\n                        // add items!\n                        root.dispatch('ADD_ITEMS', {\n                            items: queue,\n                            index: -1,\n                            interactionMethod: InteractionMethod.BROWSE,\n                        });\n                    });\n                },\n            }),\n            0\n        );\n    } else if (!enabled && root.ref.browser) {\n        root.removeChildView(root.ref.browser);\n        root.ref.browser = null;\n    }\n};\n\n/**\n * Enable or disable paste functionality\n */\nconst togglePaste = root => {\n    const isAllowed = root.query('GET_ALLOW_PASTE');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n        root.ref.paster = createPaster();\n        root.ref.paster.onload = items => {\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\n                // these files don't fit so stop here\n                if (exceedsMaxFiles(root, queue)) return false;\n\n                // add items!\n                root.dispatch('ADD_ITEMS', {\n                    items: queue,\n                    index: -1,\n                    interactionMethod: InteractionMethod.PASTE,\n                });\n            });\n        };\n    } else if (!enabled && root.ref.paster) {\n        root.ref.paster.destroy();\n        root.ref.paster = null;\n    }\n};\n\n/**\n * Route actions\n */\nconst route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: ({ root, props }) => {\n        toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: ({ root }) => {\n        toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: ({ root }) => {\n        togglePaste(root);\n    },\n    DID_SET_DISABLED: ({ root, props }) => {\n        toggleDrop(root);\n        togglePaste(root);\n        toggleBrowse(root, props);\n        const isDisabled = root.query('GET_DISABLED');\n        if (isDisabled) {\n            root.element.dataset.disabled = 'disabled';\n        } else {\n            // delete root.element.dataset.disabled; <= this does not work on iOS 10\n            root.element.removeAttribute('data-disabled');\n        }\n    },\n});\n\nconst root = createView({\n    name: 'root',\n    read: ({ root }) => {\n        if (root.ref.measure) {\n            root.ref.measureHeight = root.ref.measure.offsetHeight;\n        }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: ({ root }) => {\n        if (root.ref.paster) {\n            root.ref.paster.destroy();\n        }\n        if (root.ref.hopper) {\n            root.ref.hopper.destroy();\n        }\n        root.element.removeEventListener('touchmove', prevent);\n        root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n        styles: ['height'],\n    },\n});\n\n// creates the app\nconst createApp = (initialOptions = {}) => {\n    // let element\n    let originalElement = null;\n\n    // get default options\n    const defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    const store = createStore(\n        // initial state (should be serializable)\n        createInitialState(defaultOptions),\n\n        // queries\n        [queries, createOptionQueries(defaultOptions)],\n\n        // action handlers\n        [actions, createOptionActions(defaultOptions)]\n    );\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n    // kick thread if visibility changes\n    const visibilityHandler = () => {\n        if (document.hidden) return;\n        store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    let resizeDoneTimer = null;\n    let isResizing = false;\n    let isResizingHorizontally = false;\n    let initialWindowWidth = null;\n    let currentWindowWidth = null;\n    const resizeHandler = () => {\n        if (!isResizing) {\n            isResizing = true;\n        }\n        clearTimeout(resizeDoneTimer);\n        resizeDoneTimer = setTimeout(() => {\n            isResizing = false;\n            initialWindowWidth = null;\n            currentWindowWidth = null;\n            if (isResizingHorizontally) {\n                isResizingHorizontally = false;\n                store.dispatch('DID_STOP_RESIZE');\n            }\n        }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    const view = root(store, { id: getUniqueId() });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    let isResting = false;\n    let isHidden = false;\n\n    const readWriteApi = {\n        // necessary for update loop\n\n        /**\n         * Reads from dom (never call manually)\n         * @private\n         */\n        _read: () => {\n            // test if we're resizing horizontally\n            // TODO: see if we can optimize this by measuring root rect\n            if (isResizing) {\n                currentWindowWidth = window.innerWidth;\n                if (!initialWindowWidth) {\n                    initialWindowWidth = currentWindowWidth;\n                }\n\n                if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n                    store.dispatch('DID_START_RESIZE');\n                    isResizingHorizontally = true;\n                }\n            }\n\n            if (isHidden && isResting) {\n                // test if is no longer hidden\n                isResting = view.element.offsetParent === null;\n            }\n\n            // if resting, no need to read as numbers will still all be correct\n            if (isResting) return;\n\n            // read view data\n            view._read();\n\n            // if is hidden we need to know so we exit rest mode when revealed\n            isHidden = view.rect.element.hidden;\n        },\n\n        /**\n         * Writes to dom (never call manually)\n         * @private\n         */\n        _write: ts => {\n            // get all actions from store\n            const actions = store\n                .processActionQueue()\n\n                // filter out set actions (these will automatically trigger DID_SET)\n                .filter(action => !/^SET_/.test(action.type));\n\n            // if was idling and no actions stop here\n            if (isResting && !actions.length) return;\n\n            // some actions might trigger events\n            routeActionsToEvents(actions);\n\n            // update the view\n            isResting = view._write(ts, actions, isResizingHorizontally);\n\n            // will clean up all archived items\n            removeReleasedItems(store.query('GET_ITEMS'));\n\n            // now idling\n            if (isResting) {\n                store.processDispatchQueue();\n            }\n        },\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    const createEvent = name => data => {\n        // create default event\n        const event = {\n            type: name,\n        };\n\n        // no data to add\n        if (!data) {\n            return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n            event.error = data.error ? { ...data.error } : null;\n        }\n\n        if (data.status) {\n            event.status = { ...data.status };\n        }\n\n        if (data.file) {\n            event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n            event.file = data.source;\n        } else if (data.item || data.id) {\n            const item = data.item ? data.item : store.query('GET_ITEM', data.id);\n            event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n            event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n            event.progress = data.progress;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n            event.origin = data.origin;\n            event.target = data.target;\n        }\n\n        return event;\n    };\n\n    const eventRoutes = {\n        DID_DESTROY: createEvent('destroy'),\n\n        DID_INIT: createEvent('init'),\n\n        DID_THROW_MAX_FILES: createEvent('warning'),\n\n        DID_INIT_ITEM: createEvent('initfile'),\n        DID_START_ITEM_LOAD: createEvent('addfilestart'),\n        DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n        DID_LOAD_ITEM: createEvent('addfile'),\n\n        DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n        DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n        DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n\n        DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n        DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n        DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n        DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n        DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n        DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n        DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n\n        DID_REMOVE_ITEM: createEvent('removefile'),\n\n        DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n        DID_ACTIVATE_ITEM: createEvent('activatefile'),\n\n        DID_REORDER_ITEMS: createEvent('reorderfiles'),\n    };\n\n    const exposeEvent = event => {\n        // create event object to be dispatched\n        const detail = { pond: exports, ...event };\n        delete detail.type;\n        view.element.dispatchEvent(\n            new CustomEvent(`FilePond:${event.type}`, {\n                // event info\n                detail,\n\n                // event behaviour\n                bubbles: true,\n                cancelable: true,\n                composed: true, // triggers listeners outside of shadow root\n            })\n        );\n\n        // event object to params used for `on()` event handlers and callbacks `oninit()`\n        const params = [];\n\n        // if is possible error event, make it the first param\n        if (event.hasOwnProperty('error')) {\n            params.push(event.error);\n        }\n\n        // file is always section\n        if (event.hasOwnProperty('file')) {\n            params.push(event.file);\n        }\n\n        // append other props\n        const filtered = ['type', 'error', 'file'];\n        Object.keys(event)\n            .filter(key => !filtered.includes(key))\n            .forEach(key => params.push(event[key]));\n\n        // on(type, () => { })\n        exports.fire(event.type, ...params);\n\n        // oninit = () => {}\n        const handler = store.query(`GET_ON${event.type.toUpperCase()}`);\n        if (handler) {\n            handler(...params);\n        }\n    };\n\n    const routeActionsToEvents = actions => {\n        if (!actions.length) return;\n        actions\n            .filter(action => eventRoutes[action.type])\n            .forEach(action => {\n                const routes = eventRoutes[action.type];\n                (Array.isArray(routes) ? routes : [routes]).forEach(route => {\n                    // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n                    if (action.type === 'DID_INIT_ITEM') {\n                        exposeEvent(route(action.data));\n                    } else {\n                        setTimeout(() => {\n                            exposeEvent(route(action.data));\n                        }, 0);\n                    }\n                });\n            });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    const setOptions = options => store.dispatch('SET_OPTIONS', { options });\n\n    const getFile = query => store.query('GET_ACTIVE_ITEM', query);\n\n    const prepareFile = query =>\n        new Promise((resolve, reject) => {\n            store.dispatch('REQUEST_ITEM_PREPARE', {\n                query,\n                success: item => {\n                    resolve(item);\n                },\n                failure: error => {\n                    reject(error);\n                },\n            });\n        });\n\n    const addFile = (source, options = {}) =>\n        new Promise((resolve, reject) => {\n            addFiles([{ source, options }], { index: options.index })\n                .then(items => resolve(items && items[0]))\n                .catch(reject);\n        });\n\n    const isFilePondFile = obj => obj.file && obj.id;\n\n    const removeFile = (query, options) => {\n        // if only passed options\n        if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n            options = query;\n            query = undefined;\n        }\n\n        // request item removal\n        store.dispatch('REMOVE_ITEM', { ...options, query });\n\n        // see if item has been removed\n        return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    const addFiles = (...args) =>\n        new Promise((resolve, reject) => {\n            const sources = [];\n            const options = {};\n\n            // user passed a sources array\n            if (isArray(args[0])) {\n                sources.push.apply(sources, args[0]);\n                Object.assign(options, args[1] || {});\n            } else {\n                // user passed sources as arguments, last one might be options object\n                const lastArgument = args[args.length - 1];\n                if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n                    Object.assign(options, args.pop());\n                }\n\n                // add rest to sources\n                sources.push(...args);\n            }\n\n            store.dispatch('ADD_ITEMS', {\n                items: sources,\n                index: options.index,\n                interactionMethod: InteractionMethod.API,\n                success: resolve,\n                failure: reject,\n            });\n        });\n\n    const getFiles = () => store.query('GET_ACTIVE_ITEMS');\n\n    const processFile = query =>\n        new Promise((resolve, reject) => {\n            store.dispatch('REQUEST_ITEM_PROCESSING', {\n                query,\n                success: item => {\n                    resolve(item);\n                },\n                failure: error => {\n                    reject(error);\n                },\n            });\n        });\n\n    const prepareFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n        const items = queries.length ? queries : getFiles();\n        return Promise.all(items.map(prepareFile));\n    };\n\n    const processFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n        if (!queries.length) {\n            const files = getFiles().filter(\n                item =>\n                    !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) &&\n                    item.status !== ItemStatus.PROCESSING &&\n                    item.status !== ItemStatus.PROCESSING_COMPLETE &&\n                    item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n            );\n            return Promise.all(files.map(processFile));\n        }\n        return Promise.all(queries.map(processFile));\n    };\n\n    const removeFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n\n        let options;\n        if (typeof queries[queries.length - 1] === 'object') {\n            options = queries.pop();\n        } else if (Array.isArray(args[0])) {\n            options = args[1];\n        }\n\n        const files = getFiles();\n\n        if (!queries.length) return Promise.all(files.map(file => removeFile(file, options)));\n\n        // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n        const mappedQueries = queries\n            .map(query => (isNumber(query) ? (files[query] ? files[query].id : null) : query))\n            .filter(query => query);\n\n        return mappedQueries.map(q => removeFile(q, options));\n    };\n\n    const exports = {\n        // supports events\n        ...on(),\n\n        // inject private api methods\n        ...readWriteApi,\n\n        // inject all getters and setters\n        ...createOptionAPI(store, defaultOptions),\n\n        /**\n         * Override options defined in options object\n         * @param options\n         */\n        setOptions,\n\n        /**\n         * Load the given file\n         * @param source - the source of the file (either a File, base64 data uri or url)\n         * @param options - object, { index: 0 }\n         */\n        addFile,\n\n        /**\n         * Load the given files\n         * @param sources - the sources of the files to load\n         * @param options - object, { index: 0 }\n         */\n        addFiles,\n\n        /**\n         * Returns the file objects matching the given query\n         * @param query { string, number, null }\n         */\n        getFile,\n\n        /**\n         * Upload file with given name\n         * @param query { string, number, null  }\n         */\n        processFile,\n\n        /**\n         * Request prepare output for file with given name\n         * @param query { string, number, null  }\n         */\n        prepareFile,\n\n        /**\n         * Removes a file by its name\n         * @param query { string, number, null  }\n         */\n        removeFile,\n\n        /**\n         * Moves a file to a new location in the files list\n         */\n        moveFile: (query, index) => store.dispatch('MOVE_ITEM', { query, index }),\n\n        /**\n         * Returns all files (wrapped in public api)\n         */\n        getFiles,\n\n        /**\n         * Starts uploading all files\n         */\n        processFiles,\n\n        /**\n         * Clears all files from the files list\n         */\n        removeFiles,\n\n        /**\n         * Starts preparing output of all files\n         */\n        prepareFiles,\n\n        /**\n         * Sort list of files\n         */\n        sort: compare => store.dispatch('SORT', { compare }),\n\n        /**\n         * Browse the file system for a file\n         */\n        browse: () => {\n            // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n            var input = view.element.querySelector('input[type=file]');\n            if (input) {\n                input.click();\n            }\n        },\n\n        /**\n         * Destroys the app\n         */\n        destroy: () => {\n            // request destruction\n            exports.fire('destroy', view.element);\n\n            // stop active processes (file uploads, fetches, stuff like that)\n            // loop over items and depending on states call abort for ongoing processes\n            store.dispatch('ABORT_ALL');\n\n            // destroy view\n            view._destroy();\n\n            // stop listening to resize\n            window.removeEventListener('resize', resizeHandler);\n\n            // stop listening to the visiblitychange event\n            document.removeEventListener('visibilitychange', visibilityHandler);\n\n            // dispatch destroy\n            store.dispatch('DID_DESTROY');\n        },\n\n        /**\n         * Inserts the plugin before the target element\n         */\n        insertBefore: element => insertBefore(view.element, element),\n\n        /**\n         * Inserts the plugin after the target element\n         */\n        insertAfter: element => insertAfter(view.element, element),\n\n        /**\n         * Appends the plugin to the target element\n         */\n        appendTo: element => element.appendChild(view.element),\n\n        /**\n         * Replaces an element with the app\n         */\n        replaceElement: element => {\n            // insert the app before the element\n            insertBefore(view.element, element);\n\n            // remove the original element\n            element.parentNode.removeChild(element);\n\n            // remember original element\n            originalElement = element;\n        },\n\n        /**\n         * Restores the original element\n         */\n        restoreElement: () => {\n            if (!originalElement) {\n                return; // no element to restore\n            }\n\n            // restore original element\n            insertAfter(originalElement, view.element);\n\n            // remove our element\n            view.element.parentNode.removeChild(view.element);\n\n            // remove reference\n            originalElement = null;\n        },\n\n        /**\n         * Returns true if the app root is attached to given element\n         * @param element\n         */\n        isAttachedTo: element => view.element === element || originalElement === element,\n\n        /**\n         * Returns the root element\n         */\n        element: {\n            get: () => view.element,\n        },\n\n        /**\n         * Returns the current pond status\n         */\n        status: {\n            get: () => store.query('GET_STATUS'),\n        },\n    };\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n};\n\nconst createAppObject = (customOptions = {}) => {\n    // default options\n    const defaultOptions = {};\n    forin(getOptions(), (key, value) => {\n        defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    const app = createApp({\n        // default options\n        ...defaultOptions,\n\n        // custom options\n        ...customOptions,\n    });\n\n    // return the plugin instance\n    return app;\n};\n\nconst lowerCaseFirstLetter = string => string.charAt(0).toLowerCase() + string.slice(1);\n\nconst attributeNameToPropertyName = attributeName => toCamels(attributeName.replace(/^data-/, ''));\n\nconst mapObject = (object, propertyMap) => {\n    // remove unwanted\n    forin(propertyMap, (selector, mapping) => {\n        forin(object, (property, value) => {\n            // create regexp shortcut\n            const selectorRegExp = new RegExp(selector);\n\n            // tests if\n            const matches = selectorRegExp.test(property);\n\n            // no match, skip\n            if (!matches) {\n                return;\n            }\n\n            // if there's a mapping, the original property is always removed\n            delete object[property];\n\n            // should only remove, we done!\n            if (mapping === false) {\n                return;\n            }\n\n            // move value to new property\n            if (isString(mapping)) {\n                object[mapping] = value;\n                return;\n            }\n\n            // move to group\n            const group = mapping.group;\n            if (isObject(mapping) && !object[group]) {\n                object[group] = {};\n            }\n\n            object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n        });\n\n        // do submapping\n        if (mapping.mapping) {\n            mapObject(object[mapping.group], mapping.mapping);\n        }\n    });\n};\n\nconst getAttributesAsObject = (node, attributeMapping = {}) => {\n    // turn attributes into object\n    const attributes = [];\n    forin(node.attributes, index => {\n        attributes.push(node.attributes[index]);\n    });\n\n    const output = attributes\n        .filter(attribute => attribute.name)\n        .reduce((obj, attribute) => {\n            const value = attr(node, attribute.name);\n\n            obj[attributeNameToPropertyName(attribute.name)] =\n                value === attribute.name ? true : value;\n            return obj;\n        }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n\n    return output;\n};\n\nconst createAppAtElement = (element, options = {}) => {\n    // how attributes of the input element are mapped to the options for the plugin\n    const attributeMapping = {\n        // translate to other name\n        '^class$': 'className',\n        '^multiple$': 'allowMultiple',\n        '^capture$': 'captureMethod',\n        '^webkitdirectory$': 'allowDirectoriesOnly',\n\n        // group under single property\n        '^server': {\n            group: 'server',\n            mapping: {\n                '^process': {\n                    group: 'process',\n                },\n                '^revert': {\n                    group: 'revert',\n                },\n                '^fetch': {\n                    group: 'fetch',\n                },\n                '^restore': {\n                    group: 'restore',\n                },\n                '^load': {\n                    group: 'load',\n                },\n            },\n        },\n\n        // don't include in object\n        '^type$': false,\n        '^files$': false,\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    const mergedOptions = {\n        ...options,\n    };\n\n    const attributeOptions = getAttributesAsObject(\n        element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element,\n        attributeMapping\n    );\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(key => {\n        if (isObject(attributeOptions[key])) {\n            if (!isObject(mergedOptions[key])) {\n                mergedOptions[key] = {};\n            }\n            Object.assign(mergedOptions[key], attributeOptions[key]);\n        } else {\n            mergedOptions[key] = attributeOptions[key];\n        }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(\n        Array.from(element.querySelectorAll('input:not([type=file])')).map(input => ({\n            source: input.value,\n            options: {\n                type: input.dataset.type,\n            },\n        }))\n    );\n\n    // build plugin\n    const app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n        Array.from(element.files).forEach(file => {\n            app.addFile(file);\n        });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n};\n\n// if an element is passed, we create the instance at that element, if not, we just create an up object\nconst createApp$1 = (...args) =>\n    isNode(args[0]) ? createAppAtElement(...args) : createAppObject(...args);\n\nconst PRIVATE_METHODS = ['fire', '_read', '_write'];\n\nconst createAppAPI = app => {\n    const api = {};\n\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n    return api;\n};\n\n/**\n * Replaces placeholders in given string with replacements\n * @param string - \"Foo {bar}\"\"\n * @param replacements - { \"bar\": 10 }\n */\nconst replaceInString = (string, replacements) =>\n    string.replace(/(?:{([a-zA-Z]+)})/g, (match, group) => replacements[group]);\n\nconst createWorker = fn => {\n    const workerBlob = new Blob(['(', fn.toString(), ')()'], {\n        type: 'application/javascript',\n    });\n    const workerURL = URL.createObjectURL(workerBlob);\n    const worker = new Worker(workerURL);\n\n    return {\n        transfer: (message, cb) => {},\n        post: (message, cb, transferList) => {\n            const id = getUniqueId();\n\n            worker.onmessage = e => {\n                if (e.data.id === id) {\n                    cb(e.data.message);\n                }\n            };\n\n            worker.postMessage(\n                {\n                    id,\n                    message,\n                },\n                transferList\n            );\n        },\n        terminate: () => {\n            worker.terminate();\n            URL.revokeObjectURL(workerURL);\n        },\n    };\n};\n\nconst loadImage = url =>\n    new Promise((resolve, reject) => {\n        const img = new Image();\n        img.onload = () => {\n            resolve(img);\n        };\n        img.onerror = e => {\n            reject(e);\n        };\n        img.src = url;\n    });\n\nconst renameFile = (file, name) => {\n    const renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n};\n\nconst copyFile = file => renameFile(file, file.name);\n\n// already registered plugins (can't register twice)\nconst registeredPlugins = [];\n\n// pass utils to plugin\nconst createAppPlugin = plugin => {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n        return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    const pluginOutline = plugin({\n        addFilter,\n        utils: {\n            Type,\n            forin,\n            isString,\n            isFile,\n            toNaturalFileSize,\n            replaceInString,\n            getExtensionFromFilename,\n            getFilenameWithoutExtension,\n            guesstimateMimeType,\n            getFileFromBlob,\n            getFilenameFromURL,\n            createRoute,\n            createWorker,\n            createView,\n            createItemAPI,\n            loadImage,\n            copyFile,\n            renameFile,\n            createBlob,\n            applyFilterChain,\n            text,\n            getNumericAspectRatioFromString,\n        },\n        views: {\n            fileActionButton,\n        },\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n};\n\n// feature detection used by supported() method\nconst isOperaMini = () => Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\nconst hasPromises = () => 'Promise' in window;\nconst hasBlobSlice = () => 'slice' in Blob.prototype;\nconst hasCreateObjectURL = () => 'URL' in window && 'createObjectURL' in window.URL;\nconst hasVisibility = () => 'visibilityState' in document;\nconst hasTiming = () => 'performance' in window; // iOS 8.x\nconst hasCSSSupports = () => 'supports' in (window.CSS || {}); // use to detect Safari 9+\nconst isIE11 = () => /MSIE|Trident/.test(window.navigator.userAgent);\n\nconst supported = (() => {\n    // Runs immediately and then remembers result for subsequent calls\n    const isSupported =\n        // Has to be a browser\n        isBrowser() &&\n        // Can't run on Opera Mini due to lack of everything\n        !isOperaMini() &&\n        // Require these APIs to feature detect a modern browser\n        hasVisibility() &&\n        hasPromises() &&\n        hasBlobSlice() &&\n        hasCreateObjectURL() &&\n        hasTiming() &&\n        // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n        (hasCSSSupports() || isIE11());\n\n    return () => isSupported;\n})();\n\n/**\n * Plugin internal state (over all instances)\n */\nconst state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: [],\n};\n\n// plugin name\nconst name = 'filepond';\n\n/**\n * Public Plugin methods\n */\nconst fn = () => {};\nlet Status$1 = {};\nlet FileStatus = {};\nlet FileOrigin$1 = {};\nlet OptionTypes = {};\nlet create$f = fn;\nlet destroy = fn;\nlet parse = fn;\nlet find = fn;\nlet registerPlugin = fn;\nlet getOptions$1 = fn;\nlet setOptions$1 = fn;\n\n// if not supported, no API\nif (supported()) {\n    // start painter and fire load event\n    createPainter(\n        () => {\n            state.apps.forEach(app => app._read());\n        },\n        ts => {\n            state.apps.forEach(app => app._write(ts));\n        }\n    );\n\n    // fire loaded event so we know when FilePond is available\n    const dispatch = () => {\n        // let others know we have area ready\n        document.dispatchEvent(\n            new CustomEvent('FilePond:loaded', {\n                detail: {\n                    supported,\n                    create: create$f,\n                    destroy,\n                    parse,\n                    find,\n                    registerPlugin,\n                    setOptions: setOptions$1,\n                },\n            })\n        );\n\n        // clean up event\n        document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n        // move to back of execution queue, FilePond should have been exported by then\n        setTimeout(() => dispatch(), 0);\n    } else {\n        document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    const updateOptionTypes = () =>\n        forin(getOptions(), (key, value) => {\n            OptionTypes[key] = value[1];\n        });\n\n    Status$1 = { ...Status };\n    FileOrigin$1 = { ...FileOrigin };\n    FileStatus = { ...ItemStatus };\n\n    OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    create$f = (...args) => {\n        const app = createApp$1(...args);\n        app.on('destroy', destroy);\n        state.apps.push(app);\n        return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    destroy = hook => {\n        // returns true if the app was destroyed successfully\n        const indexToRemove = state.apps.findIndex(app => app.isAttachedTo(hook));\n        if (indexToRemove >= 0) {\n            // remove from apps\n            const app = state.apps.splice(indexToRemove, 1)[0];\n\n            // restore original dom element\n            app.restoreElement();\n\n            return true;\n        }\n\n        return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    parse = context => {\n        // get all possible hooks\n        const matchedHooks = Array.from(context.querySelectorAll(`.${name}`));\n\n        // filter out already active hooks\n        const newHooks = matchedHooks.filter(\n            newHook => !state.apps.find(app => app.isAttachedTo(newHook))\n        );\n\n        // create new instance for each hook\n        return newHooks.map(hook => create$f(hook));\n    };\n\n    // returns an app based on the given element hook\n    find = hook => {\n        const app = state.apps.find(app => app.isAttachedTo(hook));\n        if (!app) {\n            return null;\n        }\n        return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    registerPlugin = (...plugins) => {\n        // register plugins\n        plugins.forEach(createAppPlugin);\n\n        // update OptionTypes, each plugin might have extended the default options\n        updateOptionTypes();\n    };\n\n    getOptions$1 = () => {\n        const opts = {};\n        forin(getOptions(), (key, value) => {\n            opts[key] = value[0];\n        });\n        return opts;\n    };\n\n    setOptions$1 = opts => {\n        if (isObject(opts)) {\n            // update existing plugins\n            state.apps.forEach(app => {\n                app.setOptions(opts);\n            });\n\n            // override defaults\n            setOptions(opts);\n        }\n\n        // return new options\n        return getOptions$1();\n    };\n}\n\nexport {\n    FileOrigin$1 as FileOrigin,\n    FileStatus,\n    OptionTypes,\n    Status$1 as Status,\n    create$f as create,\n    destroy,\n    find,\n    getOptions$1 as getOptions,\n    parse,\n    registerPlugin,\n    setOptions$1 as setOptions,\n    supported,\n};\n","// Import all required original FilePond plugins\nimport FilePondPluginImageResize from 'filepond-plugin-image-resize';\nimport FilePondPluginImageTransform from 'filepond-plugin-image-transform';\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\nimport FilePondPluginImageEdit from 'filepond-plugin-image-edit';\nimport FilePondPluginFileValidateType from 'filepond-plugin-file-validate-type';\n\n// Load the FilePond core library\nimport * as FilePond from 'filepond/dist/filepond.esm.js';\n\n// Import the event dispatcher and listener provider classes.\n// We need these to dynamically discover and register our custom validators.\nimport {EventDispatcher} from './event_dispatcher.js';\nimport {ListenerProvider} from './listener_provider.js';\n\n// Create the central listener provider.\n// This object stores all registered listeners grouped by event name.\nconst listenerProvider = new ListenerProvider();\n\n// Create the event dispatcher.\n// It executes listeners SEQUENTIALLY based on their priority.\nconst eventDispatcher = new EventDispatcher(listenerProvider);\n\n// Dynamically import all custom FilePond plugin modules.\n// Each module in ./custom_filepond_plugins/*.js may export one or more listener classes.\n//\n// This mechanism allows you to simply drop a new validator file into the folder\n// (e.g. image resolution validator, max file size validator, MIME type validator)\n// and it will automatically be discovered and registered.\nconst modules = import.meta.webpackContext('./custom_validators', {\n    recursive: false,\n    regExp: /\\.js$/,\n});\n\n// Iterate over all discovered modules\nmodules.keys().forEach((key) => {\n    const mod = modules(key);\n\n    // Each module may export multiple classes.\n    // We check each export to see if it is a listener class.\n    for (const exported of Object.values(mod)) {\n\n        // A listener class is identified by:\n        // - being a function (constructor)\n        // - having a static \"tags\" array that defines which events it listens to\n        if (typeof exported === 'function' && Array.isArray(exported.tags)) {\n\n            // Instantiate the listener class\n            const instance = new exported();\n\n            // Register the listener for each declared tag.\n            // A tag defines:\n            // - event: the event name (e.g. 'contao_filepond:process_start')\n            // - priority: execution order (higher runs earlier)\n            //\n            // This is where validators such as:\n            // - image resolution validation\n            // - maximum file size validation\n            // - MIME type validation\n            // are added to the pipeline.\n            for (const tag of exported.tags) {\n                listenerProvider.register(tag.event, instance, tag.priority ?? 0);\n            }\n        }\n    }\n});\n\nexport default class ContaoFilepond {\n    wrapper = null;\n    widget = null;\n    name = null;\n    jsConfig = null;\n    #allowMultiple = false;\n    #pond = null;\n    #options = {\n        imageResizeTargetWidth: 1200,\n        imageResizeTargetHeight: 1200,\n    };\n    #plugins = [\n        FilePondPluginImageResize,\n        FilePondPluginImageTransform,\n        FilePondPluginImagePreview,\n        FilePondPluginImageExifOrientation,\n        FilePondPluginImageEdit,\n        FilePondPluginFileValidateType,\n\n        // We do not want to use the built-in plugins from FilePond,\n        // as these are executed before the images are resized.\n        // However, the file size and resolution of the images\n        // should be checked after the image has been resized.\n        //\n        //FilePondPluginImageValidateSize,\n        //FilePondPluginValidateImageResolution,\n    ];\n\n    /**\n     *\n     * @param widget file input element\n     * @param name\n     * @param jsConfig\n     */\n    constructor(widget, name, jsConfig) {\n        this.wrapper = widget.closest('.filepond-wrapper');\n        this.widget = widget;\n        this.name = name;\n        this.jsConfig = jsConfig;\n\n        this.#pond = FilePond;\n\n        this.#init();\n    }\n\n    #init() {\n\n        // Set the accept attribute on the filepond input field.\n        this.setAllowedExtensions(this.jsConfig.extensions);\n\n        // Add the name, the multiple and the data-max-files attribute on the filepond input field.\n        if (this.jsConfig.multiple) {\n            if (this.jsConfig.limit === 1) {\n                this.setAttribute('data-max-files', 1);\n                this.setAttribute('name', this.name);\n                this.#allowMultiple = false;\n            } else if (this.jsConfig.limit > 1) {\n                this.setAttribute('multiple', '');\n                this.setAttribute('data-max-files', this.jsConfig.limit);\n                this.setAttribute('name', this.name + '[]');\n                this.#allowMultiple = true;\n            } else {\n                // Infinite file uploads allowed\n                this.setAttribute('multiple', '');\n                this.setAttribute('name', this.name + '[]');\n                this.#allowMultiple = true;\n            }\n        } else {\n            this.setAttribute('data-max-files', 1);\n            this.setAttribute('name', this.name);\n            this.#allowMultiple = false;\n        }\n\n        // Set the data-min-file-size attribute on the filepond input field.\n        if (this.jsConfig.minFileSizeLimit) {\n            this.setAttribute('data-min-file-size', this.jsConfig.minFileSizeLimit);\n        }\n\n        // Set the data-max-file-size attribute on the filepond input field.\n        if (this.jsConfig.maxFileSizeLimit) {\n            this.setAttribute('data-max-file-size', this.jsConfig.maxFileSizeLimit);\n        }\n\n        this.#setDefaultOptions();\n\n        this.setPlugins(this.#plugins);\n    }\n\n    /**\n     * Get an attribute from the filepond input field\n     * @returns string\n     * @param property\n     */\n    getAttribute(property) {\n        return this.widget.getAttribute(property);\n    }\n\n    /**\n     * Set an attribute on the filepond input field\n     * @returns {ContaoFilepond}\n     * @param property\n     * @param value\n     */\n    setAttribute(property, value) {\n        this.widget.setAttribute(property, value);\n        return this;\n    }\n\n    /**\n     * Remove an attribute on the filepond input field\n     * @returns {ContaoFilepond}\n     * @param property\n     */\n    removeAttribute(property) {\n        this.widget.removeAttribute(property);\n        return this;\n    }\n\n    /**\n     * Set the \"accept\" attribute on the filepond input field.\n     * @param extensions\n     * @returns {ContaoFilepond}\n     */\n    setAllowedExtensions(extensions) {\n        this.widget.setAttribute('accept', extensions);\n        return this;\n    }\n\n    /**\n     * @returns {ContaoFilepond}\n     * @param plugins\n     */\n    setPlugins(plugins) {\n        this.#plugins = plugins;\n        this.#pond.registerPlugin(\n            ...this.#plugins,\n        );\n\n        return this;\n    }\n\n    /**\n     *\n     * @returns {FilePond}\n     */\n    getPond() {\n        return this.#pond;\n    }\n\n    /**\n     * @returns {{}}\n     */\n    getOptions() {\n        return this.#options;\n    }\n\n    /**\n     * @returns {ContaoFilepond}\n     * @param options\n     */\n    setOptions(options) {\n        this.#options = options;\n        return this;\n    }\n\n    run() {\n        this.#pond.create(this.widget, this.#options);\n    }\n\n    #setDefaultOptions() {\n        this.#options = {\n            // Add translations\n            ...this.jsConfig.translations,\n            maxParallelUploads: this.jsConfig.parallelUploads < 1 ? 1 : this.jsConfig.parallelUploads,\n            instantUpload: true,\n            allowMultiple: this.#allowMultiple,\n            allowFileTypeValidation: true,\n\n            // Do not allow upload reverts if direct upload is enabled\n            allowRevert: !this.jsConfig.directUpload,\n            allowRemove: !this.jsConfig.directUpload,\n\n            // Add callbacks\n            oninit: () => {\n                this.#oninit();\n            },\n            onaddfile: (err, item) => {\n                this.#onaddfile(err, item);\n            },\n            onaddfilestart: (file) => {\n                this.#onaddfilestart(file);\n            },\n            onprocessfile: (err, file) => {\n                this.#onprocessfile(err, file);\n            },\n\n            server: {\n                process: async (fieldName, file, metadata, load, error, progress, abort) => {\n\n                    const itemId = metadata.itemId;\n\n                    // Event object passed into the validation pipeline.\n                    // Each registered listener receives this object and performs its own validation logic.\n                    //\n                    // Typical validators include:\n                    // - image resolution validation (min/max width & height)\n                    // - maximum allowed file size validation\n                    // - MIME type validation\n                    // - any other custom validation rules\n                    //\n                    // All validators run SEQUENTIALLY and may throw an Error to stop the pipeline.\n                    const event = {\n                        itemId,\n                        fieldName,\n                        file,\n                        metadata,\n                        filepondOptions: this.#options,\n                        jsConfig: this.jsConfig,\n\n                        // These remain intentionally empty because success/failure\n                        // is handled entirely via the try/catch around dispatch().\n                        resolve() {\n                        },\n                        reject(err) {\n                        }\n                    };\n\n                    try {\n                        // ------------------------------------------------------------\n                        // 1) Execute the validation pipeline (event listeners)\n                        // ------------------------------------------------------------\n                        //\n                        // This triggers the event dispatcher.\n                        // All listeners for 'contao_filepond:process_start' are executed\n                        // SEQUENTIALLY in order of their priority.\n                        //\n                        // Each listener may:\n                        // - validate image resolution\n                        // - validate maximum file size\n                        // - validate MIME type\n                        // - perform any other checks\n                        //\n                        // If ANY listener throws an Error, the dispatcher stops immediately\n                        // and the thrown error is caught by the catch() block below. The upload aborts.\n                        //\n                        await eventDispatcher.dispatch('contao_filepond:process_start', event);\n\n                        // ------------------------------------------------------------\n                        // 2) Only executed if ALL listeners resolved successfully.\n                        //    If any listener threw an error, this line is skipped.\n                        // ------------------------------------------------------------\n                        await this.#contaoUpload(fieldName, file, metadata, load, error, progress, abort);\n\n                    } catch (err) {\n\n                        // ------------------------------------------------------------\n                        // 3) Centralized error handling for the entire validation pipeline.\n                        //\n                        // Any listener that throws an Error ends up here.\n                        // This ensures consistent error display for:\n                        // - invalid image resolution\n                        // - file too large\n                        // - invalid MIME type\n                        // - any other validation failure\n                        // ------------------------------------------------------------\n                        this.#displayError(itemId, err.message, error);\n                    }\n                },\n                revert: (transferKey, load, error) => {\n                    this.#revertUpload(transferKey, load, error)\n                },\n\n                // Not implemented yet\n                fetch: null,\n            },\n            fileValidateTypeDetectType: (source, _type) => {\n                return new Promise((resolve, _reject) => {\n                    const extension = `.${source.name.split(\".\").pop().toLowerCase()}`;\n\n                    resolve(extension);\n                })\n            },\n        }\n\n        // Allow file size validation\n        this.#options.allowFileSizeValidation = true;\n        this.#options.minFileSize = this.jsConfig.minFileSizeLimit;\n        this.#options.maxFileSize = this.jsConfig.maxFileSizeLimit;\n\n        // Allow client side image resizing\n        if (this.jsConfig.imgResize && this.jsConfig.imgResizeBrowser && this.jsConfig.imgResizeWidth > 0 && this.jsConfig.imgResizeHeight > 0) {\n            this.#options.allowImageResize = true;\n            this.#options.imageResizeTargetWidth = this.jsConfig.imgResizeWidth;\n            this.#options.imageResizeTargetHeight = this.jsConfig.imgResizeHeight;\n            this.#options.imageResizeMode = this.jsConfig.imgResizeModeBrowser;\n            this.#options.imageResizeUpscale = this.jsConfig.imgResizeUpscaleBrowser;\n        }\n    }\n\n    #oninit() {\n        // Add a class to the wrapper element when Filepond is initialized\n        this.wrapper.classList.add('filepond--is-ready');\n\n        // Hack: Remove the CSS marker class when the upload is done\n        setInterval(() => {\n            if (!this.wrapper.querySelector('.filepond--item[data-filepond-item-state=\"busy processing\"]')) {\n                this.wrapper.classList.remove('filepond--is-busy');\n            }\n        }, 1000);\n    }\n\n    #onaddfile(err, item) {\n        item.setMetadata('itemId', item.id);\n        item.setMetadata('options', this.getOptions());\n    }\n\n    #onaddfilestart(file) {\n        // Add the CSS marker class when the upload starts\n        this.wrapper.classList.add('filepond--is-busy');\n    }\n\n    #onprocessfile(err, file) {\n    }\n\n    /**\n     * @param itemId\n     * @param message\n     * @param error callback function\n     */\n    #displayError(itemId, message, error) {\n\n        error(message);\n\n        const fileStatusBox = document.querySelector(\n            `#filepond--item-${itemId} .filepond--file-status`\n        );\n\n        const fileStatusMainBox = fileStatusBox?.querySelector(\n            `.filepond--file-status-main`\n        );\n\n        fileStatusBox?.querySelector('.filepond--contao-error')?.remove();\n\n        if (fileStatusMainBox ?? false) {\n            const errorBoxContao = document.createElement('span');\n            errorBoxContao.className = 'filepond--contao-error';\n            errorBoxContao.style.fontSize = '0.75rem';\n            errorBoxContao.textContent = message;\n            fileStatusMainBox.after(errorBoxContao);\n        }\n    }\n\n    async #contaoUpload(fieldName, file, metadata, load, error, progress, abort) {\n        const itemId = metadata.itemId;\n\n        // Remove custom error boxes\n        const errBoxes = document.querySelectorAll('#filepond--item-' + itemId + ' .filepond--contao-error');\n\n        for (const errBox of errBoxes) {\n            errBox.remove();\n        }\n\n        const doChunkedUpload = true === this.jsConfig.chunkUploads && this.jsConfig.chunkSize > 0 && file.size > this.jsConfig.chunkSize;\n\n        // ---------------------------------------------------------\n        // CASE 1: Normal upload (file smaller than chunk size)\n        // ---------------------------------------------------------\n        if (!doChunkedUpload) {\n\n            const buffer = await file.arrayBuffer();\n            const fileChecksum = await this.#sha256(buffer);\n\n            const formData = new FormData();\n            formData.append(fieldName, file, file.name);\n            formData.append('REQUEST_TOKEN', this.jsConfig.csrfToken);\n            formData.append('filePondItemId', itemId);\n            formData.append('fileChecksum', fileChecksum);\n\n            // Fetch does not support progress events...\n            const request = new XMLHttpRequest();\n            request.open('POST', window.location.href);\n\n            request.setRequestHeader('Accept', 'application/json');\n            request.setRequestHeader('name', this.name);\n            request.setRequestHeader('action', 'filepond_upload');\n            request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n            request.setRequestHeader('filePondItemId', itemId);\n\n            request.upload.onprogress = (e) => {\n                progress(e.lengthComputable, e.loaded, e.total);\n            };\n\n            request.onload = () => {\n                if (request.status >= 200 && request.status < 300) {\n                    const json = JSON.parse(request.response);\n\n                    if (false === json.success ?? false) {\n                        this.#displayError(itemId, json.error ?? 'Upload failed with error code 1.', error);\n                    } else if (json.success === true) {\n                        load(json.transferKey);\n                    } else {\n                        this.#displayError(itemId, 'Upload failed with error code 2.', error);\n                    }\n                } else {\n                    this.#displayError(itemId, 'Upload failed with error code 3.', error);\n                }\n            };\n\n            request.send(formData);\n\n            return {\n                abort: () => {\n                    request.abort();\n                    abort();\n                }\n            };\n        }\n\n        // ---------------------------------------------------------\n        // CASE 2: Chunk upload (file larger than chunk size)\n        // ---------------------------------------------------------\n\n        let offset = 0;\n        let aborted = false;\n        let activeRequest = null;\n        const chunkSize = this.jsConfig.chunkSize;\n\n        const buffer = await file.arrayBuffer();\n        const fileChecksum = await this.#sha256(buffer);\n\n        const uploadFileInChunks = async () => {\n            if (aborted) {\n                return;\n            }\n\n            const chunk = file.slice(offset, offset + chunkSize);\n\n            const formData = new FormData();\n            formData.append('REQUEST_TOKEN', this.jsConfig.csrfToken);\n            formData.append(fieldName.replace(/\\[\\]$/, '') + '_chunk', chunk);\n            formData.append('fileChecksum', fileChecksum);\n            formData.append('fileName', file.name);\n            formData.append('offset', offset);\n            formData.append('totalSize', file.size);\n\n            // With fetch we use AbortController instead of XHR.abort()\n            const controller = new AbortController();\n            activeRequest = controller;\n\n            try {\n                const response = await fetch(window.location.href, {\n                    method: 'POST',\n                    headers: {\n                        'Accept': 'application/json',\n                        'name': this.name,\n                        'action': 'filepond_upload_chunk',\n                        'X-Requested-With': 'XMLHttpRequest',\n                        'filePondItemId': itemId\n                    },\n                    body: formData,\n                    signal: controller.signal\n                });\n\n                if (!response.ok) {\n                    error('Upload error');\n                    return;\n                }\n\n                const json = await response.json();\n\n                if (json.success === true) {\n                    // everything ok\n                } else if (json.success === false) {\n                    this.#displayError(\n                        itemId,\n                        json.error ?? 'Chunk upload failed with error code 1.',\n                        error\n                    );\n                    return;\n                } else {\n                    this.#displayError(\n                        itemId,\n                        'Chunk upload failed with error code 2.',\n                        error\n                    );\n                    return;\n                }\n\n                // Chunk successfully uploaded: advance offset\n                offset += chunk.size;\n\n                // Chunk-based progress (we don't have per-chunk streaming progress with fetch)\n                progress(true, offset, file.size);\n\n                if (offset < file.size) {\n                    // Upload next chunk\n                    await uploadFileInChunks();\n                } else {\n                    // All chunks uploaded\n                    if (json.directUpload === true) {\n                        // Prevent FilePond uploading the file twice\n                        load('');\n                    } else {\n                        load(json.transferKey);\n                    }\n                }\n\n            } catch (err) {\n                if (err.name === 'AbortError') {\n                    // aborted intentionally\n                    return;\n                }\n                error('Network error');\n            }\n        };\n\n        uploadFileInChunks();\n\n        return {\n            abort: () => {\n                aborted = true;\n                if (activeRequest) {\n                    activeRequest.abort();\n                }\n                abort();\n            }\n        };\n    }\n\n    async #revertUpload(transferKey, load, error) {\n        try {\n            const response = await fetch(window.location.href, {\n                method: 'DELETE',\n                headers: {\n                    'Content-Type': 'text/plain',\n                    'name': this.name,\n                    'action': 'filepond_upload_revert',\n                    'accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest',\n                },\n                body: transferKey\n            });\n\n            if (!response.ok) {\n                throw new Error('Revert failed');\n            }\n\n            // MUST be called with no arguments\n            load();\n\n        } catch (err) {\n            error('Could not revert file.');\n        }\n    }\n\n    async #sha256(buffer) {\n        const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);\n        return [...new Uint8Array(hashBuffer)]\n            .map(b => b.toString(16).padStart(2, '0'))\n            .join('');\n    }\n}\n","export class ListenerProvider {\n    constructor() {\n        this.listeners = new Map();\n    }\n\n    register(eventName, listener, priority = 0) {\n        if (!this.listeners.has(eventName)) {\n            this.listeners.set(eventName, []);\n        }\n\n        this.listeners.get(eventName).push({listener, priority});\n\n        // Sortieren wie in Symfony\n        this.listeners.get(eventName).sort((a, b) => b.priority - a.priority);\n    }\n\n    getListeners(eventName) {\n        return (this.listeners.get(eventName) || []).map(l => l.listener);\n    }\n}\n","export class EventDispatcher {\n    constructor(provider) {\n        this.provider = provider;\n    }\n\n    async dispatch(eventName, event) {\n        return new Promise(async (resolve, reject) => {\n\n            event.stopPropagation = false;\n\n            const originalResolve = event.resolve;\n            const originalReject = event.reject;\n\n            event.resolve = (...args) => {\n                if (originalResolve) originalResolve(...args);\n            };\n\n            event.reject = (...args) => {\n                event.stopPropagation = true;\n                if (originalReject) originalReject(...args);\n                reject(...args);\n            };\n\n            const listeners = this.provider.getListeners(eventName);\n\n            for (const listener of listeners) {\n\n                try {\n                    const result = listener.handle(event);\n\n                    if (result && typeof result.then === 'function') {\n                        await result;\n                    }\n\n                } catch (err) {\n                    event.reject(err);\n                    return;\n                }\n\n                if (event.stopPropagation) {\n                    return;\n                }\n            }\n\n            resolve();\n        });\n    }\n}\n","// Import core styles\nimport 'filepond/dist/filepond.min.css';\n\n// Import the plugin styles\nimport '../assets/contao_filepond_plugin.css';\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\nimport 'filepond-plugin-image-edit/dist/filepond-plugin-image-edit.css';\n\nimport ContaoFilepond from './contao_filepond.js';\n\nwindow.ContaoFilepond = ContaoFilepond;\n"],"names":["module","exports","isPreviewableImage","file","test","type","plugin","_","addFilter","utils","views","Type","createRoute","_utils$createItemAPI","createItemAPI","item","fileActionButton","shouldRemove","_ref","query","Promise","resolve","_ref2","dispatch","reject","origin","createEditorResponseHandler","userDidConfirm","editRequestQueue","shift","requestEdit","length","_editRequestQueue$","id","handleEditorResponse","queueEditRequest","_ref3","extend","editRequest","push","viewAPI","is","view","canShowImagePreview","editor","filepondCallbackBridge","outputData","outputFile","onconfirm","oncancel","openEditor","_ref4","root","props","action","cropAspectRatio","outputCanvasBackgroundColor","crop","getMetadata","cropDefault","center","x","y","flip","horizontal","vertical","zoom","rotation","aspectRatio","resize","filter","filters","colors","markup","imageParameters","size","upscale","mode","width","height","matrix","color","_ref5","data","colorMatrix","metadata","initialSize","targetSize","setMetadata","onclose","open","didLoadItem","_ref6","ref","handleEdit","e","stopPropagation","buttonView","createChildView","label","icon","opacity","element","classList","add","dataset","align","on","buttonEditItem","appendChildView","filenameElement","querySelector","editButton","document","createElement","className","innerHTML","addEventListener","appendChild","registerDestroyer","_ref7","off","removeEventListener","routes","EDIT_ITEM","DID_LOAD_ITEM","didPreviewUpdate","_ref8","DID_IMAGE_PREVIEW_SHOW","registerWriter","options","allowImageEdit","BOOLEAN","styleImageEditButtonEditItemPosition","STRING","imageEditInstantEdit","imageEditAllowEdit","imageEditIconEdit","imageEditEditor","OBJECT","window","dispatchEvent","CustomEvent","detail","factory","isImage","getFilenameWithoutExtension","name","substr","lastIndexOf","ExtensionMap","jpeg","renameFileToMatchMimeType","filename","mimeType","split","extension","concat","getValidOutputMimeType","isImage$1","MATRICES","getImageOrientationMatrix","orientation","createVector","vectorDot","a","b","vectorSubtract","vectorDistanceSquared","vectorDistance","Math","sqrt","getOffsetPointOnEdge","A","B","C","sinA","sin","sinB","sinC","cosC","cos","ratio","getRotatedRectSize","rect","w","h","hor","ver","tl","abs","tr","bl","getImageRectZoomFactor","imageRect","cropRect","arguments","undefined","cx","cy","imageWidth","imageHeight","rotatedCropSize","max","getCenteredCropRect","container","calculateCanvasSize","image","canvasAspectRatio","imageAspectRatio","canvasWidth","canvasHeight","imgWidth","imgHeight","scalar","canvasRelease","canvas","getContext","clearRect","isFlipped","getBitmap","naturalWidth","naturalHeight","swapped","ctx","transform","apply","drawImage","imageToImageData","imageElement","canvasMemoryLimit","_options$background","background","bitmap","imageSize","canvasSize","requiredMemory","floor","canvasCenter","stage","shouldLimit","scaleToFit","scale","round","imageOffset","fillStyle","fillRect","translate","rotate","imageData","getImageData","HTMLCanvasElement","prototype","toBlob","Object","defineProperty","value","callback","quality","dataURL","this","toDataURL","setTimeout","binStr","atob","len","arr","Uint8Array","i","charCodeAt","Blob","canvasToBlob","beforeCreateBlob","promisedImage","then","vectorMultiply","v","amount","createVector$1","vectorAdd","vectorNormalize","l","vectorRotate","radians","t","getMarkupValue","axis","parseFloat","min","getMarkupStyles","lineStyle","borderStyle","fill","backgroundColor","fontColor","stroke","borderColor","lineColor","strokeWidth","borderWidth","lineWidth","lineCap","lineJoin","map","join","isDefined","getMarkupRect","left","top","right","bottom","pointsToPathShape","points","point","index","setAttributes","attr","keys","forEach","key","setAttribute","ns","svg","tag","createElementNS","updateRect","assign","styles","updateEllipse","rx","ry","IMAGE_FIT_STYLE","contain","cover","updateImage","preserveAspectRatio","fit","TEXT_ANCHOR","updateText","fontSize","fontFamily","fontWeight","textAlign","text","textContent","updateLine","line","childNodes","begin","end","target","x1","y1","x2","y2","lineDecoration","style","display","indexOf","arrowBeginRotationPoint","arrowBeginCenter","arrowBeginA","arrowBeginB","d","arrowEndRotationPoint","arrowEndCenter","arrowEndA","arrowEndB","updatePath","createShape","node","createLine","shape","CREATE_TYPE_ROUTES","onload","setAttributeNS","src","ellipse","path","UPDATE_TYPE_ROUTES","createMarkupByType","updateMarkupByType","sortMarkupByZIndex","zIndex","cropSVG","blob","fr","FileReader","onloadend","result","original","cssText","originalNode","body","bBox","getBBox","parentNode","removeChild","titleNode","viewBoxAttribute","getAttribute","widthAttribute","heightAttribute","widthUnits","match","heightUnits","viewBoxList","viewBox","overflow","markupSVG","sort","reduce","prev","el","removeAttribute","outerHTML","replace","cropCenterX","cropCenterY","canvasZoomFactor","PI","cropTransforms","cropFlipHorizontal","cropFlipVertical","flipTransforms","transformed","readAsText","objectToImageData","obj","ImageData","createImageData","set","TransformWorker","TRANSFORMS","applyTransforms","transforms","cb","filterTransform","resizeTransform","self","onmessage","message","response","postMessage","buffer","br","bg","bb","applyFilterMatrix","m","ir","ig","ib","ia","mr","mg","mb","ma","or","og","ob","identityMatrix","JSON","stringify","isIdentityMatrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","r","g","_data$mode","_data$upscale","scalarWidth","scalarHeight","originWidth","originHeight","targetWidth","targetHeight","inputData","Uint8ClampedArray","ratioWidth","ratioHeight","ratioWidthHalf","ceil","ratioHeightHalf","j","weight","weights","weightsAlpha","centerY","yy","dy","centerX","w0","xx","dx","correctOrientation","offset","getUint32","intelByteAligned","getUint16","tags","setUint16","readData","DataView","marker","markerLength","orientationCorrected","byteLength","slice","getImageHead","reader","readAsArrayBuffer","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","BB","append","getBlob","getUniqueId","random","toString","createWorker","fn","workerBlob","workerURL","URL","createObjectURL","worker","Worker","trips","transfer","post","transferList","terminate","revokeObjectURL","loadImage","url","img","Image","onerror","chain","funcs","promise","func","Array","bind","canvasApplyMarkup","drawers","TYPE_DRAW_ROUTES","applyMarkupStyles","beginPath","setLineDash","strokeStyle","globalAlpha","drawMarkupStyles","kappa","ox","oy","xe","ye","xm","ym","moveTo","bezierCurveTo","done","location","href","crossOrigin","ar","_width","_height","_x","_y","font","fillText","lineTo","imageDataToCanvas","putImageData","transformImage","instructions","status","stripImageHead","afterCreateBlob","output","qualityAsPercentage","resolveWithBlob","promisedBlob","promisedCanvas","imageHead","catch","outputFormat","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","send","arg","request","next","resume","wrappedAwait","settle","err","_invoke","return","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","isArray","_arr","_n","_d","_e","_s","_i","Symbol","iterator","TypeError","asyncIterator","throw","MARKUP_RECT","toOptionalFraction","prepareMarkup","_markup","curr","getImageSize","measure","clearInterval","intervalId","setInterval","isBrowser","isIOS","navigator","userAgent","MSStream","forin","getFileFromBlob","isFile","TRANSFORM_LIST","createVariantCreator","updateMetadata","isDefaultCrop","shouldPrepareOutput","shouldTransformFile","archived","filterResult","handleRevert","success","failure","shouldTransform","variants","variantsDefinition","createVariant","qualityMode","clientTransforms","client","filteredMetadata","instruction","exif","willChangeType","canChangeQuality","willChangeQuality","out","variantPromises","create","all","files","allowImageTransform","imageTransformImageFilter","FUNCTION","imageTransformOutputMimeType","imageTransformOutputQuality","INT","imageTransformOutputStripImageHead","imageTransformClientTransforms","ARRAY","imageTransformOutputQualityMode","imageTransformVariants","imageTransformVariantsIncludeDefault","imageTransformVariantsDefaultName","imageTransformVariantsIncludeOriginal","imageTransformVariantsOriginalName","imageTransformBeforeCreateBlob","imageTransformAfterCreateBlob","imageTransformCanvasMemoryLimit","imageTransformCanvasBackgroundColor","formatFileSize","bytes","decimals","Number","isFinite","log","pow","toFixed","FilepondFileSizeValidator","static","event","priority","handle","filepondOptions","allowFileSizeValidation","minFileSize","maxFileSize","filesize","filesizeHuman","maxFileSizeHuman","minFileSizeHuman","labelMaxFileSizeError","Error","labelMinFileSizeError","createMarkupView","createView","ignoreRect","mixins","apis","write","dirty","viewWidth","viewHeight","cropWidth","cropHeight","_size","outputWidth","outputHeight","outputFit","outputUpscale","shouldUpscale","markupFilter","settings","getCurrentCropSize","widthFloat","heightFloat","IMAGE_SCALE_SPRING_PROPS","stiffness","damping","mass","createBitmapView","createImageCanvasWrapper","animations","originX","originY","scaleX","scaleY","translateX","translateY","rotateZ","createClipView","duration","didWriteView","createMarkup","destroyMarkup","removeChildView","transparencyIndicator","shouldOptimize","translation","stageZoomFactor","imageView","createImageView","clip","hidden","containerWidth","inner","containerHeight","fixedPreviewHeight","minPreviewHeight","maxPreviewHeight","panelAspectRatio","allowMultiple","clipHeight","clipWidth","SVG_MASK","SVGMaskUniqueId","createImageOverlayView","fpAPI","mask","hash","BitmapWorker","createImageBitmap","ColorMatrixWorker","fixImageOrientation","createPreviewImage","isBitmap","MAX_WIDTH","MAX_HEIGHT","calculateAverageColor","averageColor","c","cloneCanvas","cloneImageData","createImageWrapperView","OverlayView","ImageView","applyFilter","removeImageView","_destroy","shiftImage","images","imageViewBin","pushImage","childViews","didUpdateItemMetadata","change","_imageView","canCreateImageBitmap","isFirefox","firefoxVersion","parseInt","didCreatePreviewContainer","fileURL","drawPreview","loadPreviewFallback","previewImageLoaded","pixelDensityFactor","devicePixelRatio","scaleFactor","previewImageRatio","previewContainerWidth","previewContainerHeight","previewImage","close","overlayShadow","imageBitmap","didDrawPreview","restoreOverlay","_ref9","overlayError","overlaySuccess","didThrowError","_ref10","didCompleteProcessing","_ref11","_ref12","destroy","_ref13","_ref14","DID_IMAGE_PREVIEW_DRAW","DID_IMAGE_PREVIEW_CONTAINER_CREATE","DID_FINISH_CALCULATE_PREVIEWSIZE","DID_UPDATE_ITEM_METADATA","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_INVALID","DID_COMPLETE_ITEM_PROCESSING","DID_START_ITEM_PROCESSING","DID_REVERT_ITEM_PROCESSING","_ref15","viewsToRemove","imagePreviewView","supportsCreateImageBitmap","maxPreviewFileSize","imagePreview","queue","rescaleItem","itemPanelAspectRatio","fixedHeight","_root$ref","previewAspectRatio","previewHeightMax","itemWidth","previewHeight","didResizeView","shouldRescale","didCalculatePreviewSize","shouldDrawPreview","DID_RESIZE_ROOT","DID_STOP_RESIZE","DID_IMAGE_PREVIEW_CALCULATE_SIZE","requestAnimationFrame","allowImagePreview","imagePreviewFilterItem","imagePreviewHeight","imagePreviewMinHeight","imagePreviewMaxHeight","imagePreviewMaxFileSize","imagePreviewZoomFactor","imagePreviewUpscale","imagePreviewMaxInstantPreviewFileSize","imagePreviewTransparencyIndicator","imagePreviewCalculateAverageImageColor","imagePreviewMarkupShow","imagePreviewMarkupFilter","isString","replaceInString","guesstimateMimeType","getExtensionFromFilename","getFilenameFromURL","mimeTypeMatchesWildCard","wildcard","exec","pop","isValidMimeType","acceptedTypes","userInputType","some","acceptedType","getItemType","validateFile","acceptedFileTypes","typeDetector","detectedType","applyMimeTypeMap","acceptedFileType","accept","validationResult","handleRejection","acceptedFileTypesMapped","acceptedFileTypesMappedUnique","main","sub","allTypes","allButLastType","lastType","allowFileTypeValidation","labelFileTypeNotAllowed","fileValidateTypeLabelExpectedTypes","fileValidateTypeLabelExpectedTypesMap","fileValidateTypeDetectType","FilepondImageResolutionValidator","minImageWidth","jsConfig","minImageHeight","maxImageWidth","maxImageHeight","labelImageValidateSizeLabelFormatError","console","msg","labelMinImageResolutionValidationError","k","labelMaxImageResolutionValidationError","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","isJPEG","Marker","JPEG","APP1","EXIF","TIFF","Orientation","Unknown","little","getImageOrientation","IS_BROWSER","testSrc","shouldCorrect","testImage","shouldCorrectImageExifOrientation","allowImageExifOrientation","allowImageResize","imageResizeMode","imageResizeUpscale","imageResizeTargetWidth","imageResizeTargetHeight","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","call","n","getter","__esModule","definition","enumerable","get","prop","hasOwnProperty","toStringTag","createObject","property","hasAttribute","svgElements","isSVGElement","includes","attributes","parent","splice","getChildCount","children","getViewRect","elementRect","outer","childView","isRectIgnored","childViewRect","expandRect","calculateRectSize","marginBottom","marginRight","child","isNumber","easeInOutQuad","animator","spring","position","velocity","resting","api","interpolate","ts","skipToEndState","destination","errorMargin","thereYet","onupdate","oncomplete","tween","easing","delay","p","start","reverse","createAnimator","category","def","addGetSet","overwrite","setter","defaults","rotateX","rotateY","propsHaveChanged","currentProps","newProps","applyStyles","perspective","elementCurrentStyle","Mixins","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","initialProps","getRect","listeners","viewState","events","remove","removeEvent","findIndex","animation","layoutCalculated","paddingTop","marginTop","marginLeft","offsetLeft","offsetTop","offsetWidth","offsetHeight","scrollTop","offsetParent","read","filterFrameActionsForChild","actions","didCreateView","ignoreRectUpdate","store","getComputedStyle","frameRect","isResting","activeMixins","state","writers","readers","destroyers","getElement","getChildViews","sharedAPIDefinition","internalAPIDefinition","needle","insertBefore","linkView","unlinkView","writer","registerReader","destroyer","invalidateLayout","externalAPIDefinition","_read","internalAPI","_write","frameActions","timestamp","mixin","mixinAPIDefinition","mixinAPI","childCount","newNode","referenceNode","insertAfter","nextSibling","isEmpty","trim","str","isBoolean","toBoolean","toNumber","toInt","toFloat","isInt","toBytes","base","naturalFileSize","isFunction","methods","process","patch","revert","fetch","restore","load","createAction","outline","method","timeout","headers","withCredentials","ondata","parts","header","isObject","getType","isNull","isAPI","conversionTable","array","splitter","boolean","int","number","float","string","function","levels","level","toFunctionReference","serverapi","createServerAPI","object","parse","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","option","createOptions","optionDefinition","currentValue","createOption","fromCamels","separator","part","toLowerCase","createOptionAPI","getState","toUpperCase","createOptionActions","createOptionQueries","InteractionMethod","substring","arrayRemove","listener","fire","args","sync","run","fireSync","onOnce","copyObjectPropertiesToObject","excluded","getOwnPropertyNames","getOwnPropertyDescriptor","PRIVATE","ItemStatus","INIT","IDLE","PROCESSING_QUEUED","PROCESSING","PROCESSING_COMPLETE","PROCESSING_ERROR","PROCESSING_REVERT_ERROR","LOADING","LOAD_ERROR","FileOrigin","INPUT","LIMBO","LOCAL","getNonNumeric","getDecimalSeparator","toLocaleString","NUMBER","ACTION","SERVER_API","REGEX","applyFilterChain","matchingFilters","f","initialFilter","current","error","applyFilters","getOptions","defaultOptions","disabled","required","captureMethod","allowSyncAcceptAttribute","allowDrop","allowBrowse","allowPaste","allowReplace","allowRevert","allowRemove","allowProcess","allowReorder","allowDirectoriesOnly","storeAsFile","forceRevert","maxFiles","checkValidity","itemInsertLocationFreedom","itemInsertLocation","itemInsertInterval","dropOnPage","dropOnElement","dropValidation","ignoredFiles","instantUpload","maxParallelUploads","allowMinimumUploadDuration","chunkUploads","chunkForce","chunkSize","chunkRetryDelays","server","fileSizeBase","labelFileSizeBytes","labelFileSizeKilobytes","labelFileSizeMegabytes","labelFileSizeGigabytes","labelDecimalSeparator","labelThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","getThousandsSeparator","labelIdle","labelInvalidField","labelFileWaitingForSize","labelFileSizeNotAvailable","labelFileCountSingular","labelFileCountPlural","labelFileLoading","labelFileAdded","labelFileLoadError","labelFileRemoved","labelFileRemoveError","labelFileProcessing","labelFileProcessingComplete","labelFileProcessingAborted","labelFileProcessingError","labelFileProcessingRevertError","labelTapToCancel","labelTapToRetry","labelTapToUndo","labelButtonRemoveItem","labelButtonAbortItemLoad","labelButtonRetryItemLoad","labelButtonAbortItemProcessing","labelButtonUndoItemProcessing","labelButtonRetryItemProcessing","labelButtonProcessItem","iconRemove","iconProcess","iconRetry","iconUndo","iconDone","oninit","onwarning","onactivatefile","oninitfile","onaddfilestart","onaddfileprogress","onaddfile","onprocessfilestart","onprocessfileprogress","onprocessfileabort","onprocessfilerevert","onprocessfile","onprocessfiles","onremovefile","onpreparefile","onupdatefiles","onreorderfiles","beforeDropFile","beforeAddFile","beforeRemoveFile","beforePrepareFile","stylePanelLayout","stylePanelAspectRatio","styleItemPanelAspectRatio","styleButtonRemoveItemPosition","styleButtonProcessItemPosition","styleLoadIndicatorPosition","styleProgressIndicatorPosition","styleButtonRemoveItemAlign","credits","getItemByQuery","items","find","getNumericAspectRatioFromString","getActiveItems","Status","EMPTY","ERROR","BUSY","READY","res","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","isItemInBusyState","isItemInReadyState","isAsync","queries","GET_STATUS","GET_ITEM","GET_ACTIVE_ITEM","GET_ACTIVE_ITEMS","GET_ITEMS","GET_ITEM_NAME","GET_ITEM_SIZE","fileSize","GET_STYLES","GET_PANEL_ASPECT_RATIO","GET_ITEM_PANEL_ASPECT_RATIO","GET_ITEMS_BY_STATUS","GET_TOTAL_ITEMS","SHOULD_UPDATE_FILE_INPUT","dataTransfer","DataTransfer","File","canUpdateFileInput","IS_ASYNC","GET_FILE_SIZE_LABELS","labelBytes","labelKilobytes","labelMegabytes","labelGigabytes","limit","isBase64DataURI","leftPad","padding","getDateString","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","lastModifiedDate","_relativePath","subtype","guesstimateExtension","getMimeTypeFromBase64DataURI","dataURI","getBlobFromBase64DataURI","byteString","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","ab","ArrayBuffer","getBlobFromByteStringWithMimeType","getFileNameFromHeader","matches","decodeURI","getFileSizeFromHeader","getTranfserIdFromHeader","getFileInfoFromHeaders","info","source","rows","createFileLoader","fetchFn","complete","progress","loadURL","now","computable","total","fileinfo","setSource","getProgress","abort","isGet","sendRequest","onheaders","onprogress","ontimeout","onabort","aborted","xhr","headersReceived","encodeURI","encodeURIComponent","XMLHttpRequest","upload","lengthComputable","loaded","onreadystatechange","readyState","unescape","setRequestHeader","responseType","createResponse","createTimeoutResponse","getAllResponseHeaders","hasQS","buildURL","createFetchFunction","apiUrl","statusText","ChunkStatus","processFileChunked","chunks","chunkTransferId","chunkServer","serverId","fd","getResponseHeader","lastChunkIndex","retries","canProcessChunk","chunk","processChunk","every","requestUrl","processChunks","updateTotalProgress","retryProcessChunk","clearTimeout","totalBytesTransfered","totalSize","requestParams","requestTransferOffset","formData","FormData","requestTransferId","createProcessorFunction","params","canChunkUpload","shouldChunkUpload","willChunkUpload","createFileProcessorFunction","createRevertFunction","uniqueFileId","getRandomNumber","createFileProcessor","processFn","perceivedProgress","perceivedPerformanceUpdater","perceivedDuration","clear","getDuration","progressFn","completeFn","tickMin","tickMax","tick","runtime","createPerceivedPerformanceUpdater","transferId","reset","deepCloneObject","createItem","serverFileReference","frozen","released","processingAborted","activeLoader","activeProcessor","abortProcessingRequestComplete","setStatus","processor","onprocess","silent","last","filenameWithoutExtension","fileExtension","fileType","relativePath","handler","itemAPI","abortLoad","retryLoad","requestProcessing","abortProcessing","loader","createFileStub","meta","revertFileUpload","serverTransferId","freeze","release","archive","setFile","getItemById","itemId","getItemIndexByQuery","fetchBlob","getDomainFromURL","protocol","dynamicLabel","listUpdated","listUpdateTimeout","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","ABORT_ALL","DID_SET_FILES","activeItems","interactionMethod","itemUpdateTimeout","doUpload","MOVE_ITEM","currentIndex","SORT","ADD_ITEMS","insertLocation","totalItems","promises","ADD_ITEM","count","maxFileCount","hasRoomForItem","arrayInsert","insertItem","mainStatus","handleAdd","shouldAdd","loadComplete","isExternalURL","REQUEST_PREPARE_OUTPUT","COMPLETE_LOAD_ITEM","RETRY_ITEM_LOAD","REQUEST_ITEM_PREPARE","REQUEST_ITEM_PROCESSING","processNow","PROCESS_ITEM","processingQueue","processNext","queueEntry","itemReference","noop","RETRY_ITEM_PROCESSING","REQUEST_REMOVE_ITEM","RELEASE_ITEM","REMOVE_ITEM","removeFromView","ABORT_ITEM_LOAD","ABORT_ITEM_PROCESSING","REQUEST_REVERT_ITEM_PROCESSING","shouldRevert","requestRemoveResult","REVERT_ITEM_PROCESSING","isMockItem","SET_OPTIONS","optionKeys","prioritizedOptionKeys","PrioritizedOptions","createElement$1","tagName","textNode","nodeValue","createTextNode","polarToCartesian","radius","angleInDegrees","angleInRadians","percentageArc","from","to","arcSweep","startAngle","endAngle","describeArc","progressIndicator","spin","ringStrokeWidth","ringFrom","ringTo","coordinates","isDisabled","shouldDisable","toNaturalFileSize","KB","MB","GB","removeDecimalsWhenZero","decimalCount","updateFile","fileName","updateFileSizeOnError","fileInfo","DID_UPDATE_ITEM_META","toPercentage","didSetItemLoadProgress","title","fileStatus","DID_REQUEST_ITEM_PROCESSING","DID_ABORT_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_UPDATE_ITEM_LOAD_PROGRESS","DID_THROW_ITEM_PROCESSING_REVERT_ERROR","DID_THROW_ITEM_REMOVE_ERROR","Buttons","AbortItemLoad","RetryItemLoad","RemoveItem","ProcessItem","AbortItemProcessing","RetryItemProcessing","RevertItemProcessing","ButtonKeys","calculateFileInfoOffset","getRemoveIndicatorAligment","buttonRect","buttonRemoveItem","calculateButtonWidth","buttonAbortItemLoad","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","DefaultStyle","buttonRetryItemLoad","buttonProcessItem","buttonAbortItemProcessing","buttonRetryItemProcessing","buttonRevertItemProcessing","loadProgressIndicator","processProgressIndicator","processingCompleteIndicator","IdleStyle","ProcessingStyle","StyleMap","DID_START_ITEM_LOAD","DID_START_ITEM_REMOVE","DID_LOAD_LOCAL_ITEM","processingCompleteIndicatorView","route","DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING","DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD","DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL","buttonAbortItemRemoval","LocalButtons","alignRemoveItemButton","buttonFilter","enabledButtons","loadIndicatorView","progressIndicatorView","activeStyles","stylesToApply","defaultStyles","control","fileWrapper","PANEL_SPRING_PROPS","createSection","section","viewConstructor","panel","heightCurrent","scalable","topRect","bottomRect","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","StateMap","route$1","DID_UPDATE_PANEL_HEIGHT","write$4","DID_GRAB_ITEM","dragOrigin","DID_DRAG_ITEM","dragState","DID_DROP_ITEM","dragOffset","currentState","filepondItemState","handleClick","markedForRemoval","isPrimary","removedActivateListener","pageX","pageY","dragCenter","offsetX","offsetY","itemIds","prevIndex","setIndex","getIndex","getItemIndex","createDragHelper","drag","preventDefault","drop","cancel","getItemsPerRow","horizontalSpace","getItemIndexByPosition","positionInView","itemRect","itemHorizontalMargin","itemsPerRow","childMid","itemVerticalMargin","itemHeight","itemTop","itemRight","itemBottom","dropAreaDimensions","getHeight","setHeight","val","getWidth","setWidth","setDimensions","moveItem","vx","vy","spawnDate","introItemView","getItemHeight","route$2","DID_ADD_ITEM","addIndex","cooldown","dist","lastItemSpanwDate","DID_REMOVE_ITEM","numItems","oldIndex","dragPosition","dragHeight","dragWidth","cols","getGridIndex","getColIndex","visibleChildren","idx","childHeight","childBottom","childTop","list","dragCoordinates","dragIndex","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","visualHeight","prevX","prevY","visualIndex","indexX","indexY","vectorX","sign","vectorY","route$3","DID_DRAG","scopeLeft","scopeTop","DID_END_DRAG","listScroller","overflowing","newHeight","attrToggle","enabledValue","setAcceptedFileTypes","toggleAllowMultiple","toggleDirectoryFilter","toggleDisabled","doesAllowBrowse","disableField","toggleRequired","setCaptureMethod","updateRequiredStatus","hasInvalidField","setCustomValidity","browser","handleChange","webkitRelativePath","input","form","resetFileInput","DID_SET_DISABLED","DID_SET_ALLOW_BROWSE","DID_SET_ALLOW_DIRECTORIES_ONLY","DID_SET_ALLOW_MULTIPLE","DID_SET_ACCEPTED_FILE_TYPES","DID_SET_CAPTURE_METHOD","DID_SET_REQUIRED","Key","updateLabelValue","clickable","dropLabel","handleKeyDown","keyCode","click","contains","caption","DID_SET_LABEL_IDLE","route$4","addBlob","DID_DROP","drip","setInputFiles","getField","fields","syncFieldPositionsWithItems","didReorderItems","write$8","shouldUseFileInput","dataContainer","field","fileItem","DID_DEFINE_VALUE","DID_PREPARE_OUTPUT","DID_REORDER_ITEMS","DID_SORT_ITEMS","legend","text$1","zip","epub","requestDataTransferItems","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectory","kind","isDirectoryEntry","getFilesInDirectory","getAsFile","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","createReader","readBatch","entries","correctedFile","correctMissingFileType","fullPath","webkitGetAsEntry","getLinksFromTransferMetaData","getLinksFromTransferURLData","getData","dragNDropObservers","eventPosition","pageLeft","pageTop","layerX","layerY","getDragNDropObserver","observer","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","handlers","createHandler","addListener","isEventTarget","elementAtPosition","elementFromPoint","getRootNode","pageXOffset","pageYOffset","initialTarget","setDropEffect","effect","dropEffect","onenter","overDropTarget","filterElement","onexit","ondrag","allowdrop","allowsTransfer","ondrop","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","filterItems","scopeToObserve","createDragNDropClient","documentElement","lastState","filteredItems","ondragend","ondragstart","updateHopperState","hopperState","listening","listeners$1","handlePaste","activeEl","activeElement","nodeName","inScope","clipboardData","createPaster","listen","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","listModified","clear$1","isUsingFilePond","itemProcessedUndo","itemError","assistant","toCamels","RegExp","charAt","debounce","interval","immidiateOnly","prevent","calculateListItemMargin","calculateListHeight","visual","bounds","scrollList","itemList","newItem","removedItem","verticalItemCount","calculateRootBoundingBoxHeight","measureHeight","cappedHeight","maxHeight","exceedsMaxFiles","maxItems","totalBrowseItems","getDragIndex","toggleDrop","isAllowed","enabled","hopper","toggleBrowse","togglePaste","paster","route$5","DID_SET_ALLOW_DROP","DID_SET_ALLOW_PASTE","widthPrevious","widthUpdated","updateHistory","previousAspectRatio","canHover","matchMedia","hasPointerEvents","passive","frag","tabIndex","rel","isMultiItem","atMaxCapacity","addAction","listItemMargin","listHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","isCappedHeight","panelHeight","itemMargin","createApp","initialOptions","originalElement","initialState","actionQueue","dispatchQueue","isBlocking","actionHandlers","queryHandles","processActionQueue","processDispatchQueue","createStore","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","innerWidth","routeActionsToEvents","createEvent","eventRoutes","DID_DESTROY","DID_INIT","DID_THROW_MAX_FILES","DID_INIT_ITEM","DID_COMPLETE_ITEM_PROCESSING_ALL","DID_UPDATE_ITEMS","DID_ACTIVATE_ITEM","exposeEvent","pond","bubbles","cancelable","composed","filtered","prepareFile","removeFile","addFiles","sources","lastArgument","processFile","setOptions","addFile","getFile","moveFile","processFiles","removeFiles","q","prepareFiles","browse","appendTo","replaceElement","restoreElement","isAttachedTo","createAppObject","customOptions","mapObject","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","attribute","attributeName","createApp$1","HTMLElement","mergedOptions","attributeOptions","querySelectorAll","app","createAppAtElement","PRIVATE_METHODS","createAppAPI","replacements","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","pluginOutline","additionalOptions","supported","isSupported","operamini","CSS","apps","Status$1","FileStatus","FileOrigin$1","OptionTypes","create$f","registerPlugin","getOptions$1","setOptions$1","fps","painter","requestTick","cancelTick","setTimerType","performance","cancelAnimationFrame","delta","createPainter","updateOptionTypes","hook","indexToRemove","context","newHook","plugins","opts","listenerProvider","constructor","Map","register","eventName","has","getListeners","eventDispatcher","provider","async","originalResolve","originalReject","modules","import","mod","exported","values","instance","ContaoFilepond","wrapper","widget","FilePondPluginImageResize","FilePondPluginImageTransform","FilePondPluginImagePreview","FilePondPluginImageExifOrientation","FilePondPluginImageEdit","FilePondPluginFileValidateType","closest","FilePond","setAllowedExtensions","extensions","multiple","minFileSizeLimit","maxFileSizeLimit","setPlugins","getPond","translations","parallelUploads","directUpload","fieldName","transferKey","_type","_reject","imgResize","imgResizeBrowser","imgResizeWidth","imgResizeHeight","imgResizeModeBrowser","imgResizeUpscaleBrowser","fileStatusBox","fileStatusMainBox","errorBoxContao","after","errBoxes","errBox","fileChecksum","csrfToken","json","activeRequest","uploadFileInChunks","controller","AbortController","signal","ok","hashBuffer","crypto","subtle","digest","padStart"],"ignoreList":[],"sourceRoot":""}