/*! For license information please see filepond-plugin-image-resize.esm.9ea065aa.js.LICENSE.txt */
const isImage=e=>/^image/.test(e.type),getImageSize=(e,t)=>{let i=new Image;i.onload=()=>{const e=i.naturalWidth,n=i.naturalHeight;i=null,t({width:e,height:n})},i.onerror=()=>t(null),i.src=e},plugin=({addFilter:e,utils:t})=>{const{Type:i}=t;return e("DID_LOAD_ITEM",((e,{query:t})=>new Promise(((i,n)=>{const l=e.file;if(!isImage(l)||!t("GET_ALLOW_IMAGE_RESIZE"))return i(e);const r=t("GET_IMAGE_RESIZE_MODE"),a=t("GET_IMAGE_RESIZE_TARGET_WIDTH"),o=t("GET_IMAGE_RESIZE_TARGET_HEIGHT"),s=t("GET_IMAGE_RESIZE_UPSCALE");if(null===a&&null===o)return i(e);const E=null===a?o:a,u=null===o?E:o,d=URL.createObjectURL(l);getImageSize(d,(t=>{if(URL.revokeObjectURL(d),!t)return i(e);let{width:n,height:l}=t;const a=(e.getMetadata("exif")||{}).orientation||-1;if(a>=5&&a<=8&&([n,l]=[l,n]),n===E&&l===u)return i(e);if(!s)if("cover"===r){if(n<=E||l<=u)return i(e)}else if(n<=E&&l<=E)return i(e);e.setMetadata("resize",{mode:r,upscale:s,size:{width:E,height:u}}),i(e)}))})))),{options:{allowImageResize:[!0,i.BOOLEAN],imageResizeMode:["cover",i.STRING],imageResizeUpscale:[!0,i.BOOLEAN],imageResizeTargetWidth:[null,i.INT],imageResizeTargetHeight:[null,i.INT]}}},isBrowser="undefined"!=typeof window&&void 0!==window.document;isBrowser&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin}));export default plugin;